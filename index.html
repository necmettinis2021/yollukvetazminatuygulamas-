<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geli≈ümi≈ü Raporlama Asistanƒ± V13.0 - Final Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Playfair+Display:wght@700&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        /* --- 1Ô∏è‚É£ GLOBAL DESIGN SYSTEM (DYNAMIC THEMES) --- */
        :root {
            --shadow-sm: 0 2px 4px 0 rgba(0, 0, 0, 0.04);
            --shadow-md: 0 4px 8px -1px rgba(0, 0, 0, 0.06), 0 2px 6px -2px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 20px -3px rgba(0, 0, 0, 0.07), 0 4px 10px -4px rgba(0, 0, 0, 0.07);
            --radius-md: 12px;
            --radius-lg: 18px;
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* üå∏ SPRING THEME (Softer Colors) */
        body,
        body.theme-spring {
            --primary-hue: 175;
            --secondary-hue: 145;
            --primary-color: hsl(var(--primary-hue), 58%, 50%);
            --primary-color-light: hsl(var(--primary-hue), 58%, 65%);
            --primary-color-dark: hsl(var(--primary-hue), 58%, 40%);
            --primary-color-translucent: hsla(var(--primary-hue), 58%, 50%, 0.12);
            --accent-color: hsl(var(--secondary-hue), 62%, 54%);
            --accent-color-dark: hsl(var(--secondary-hue), 62%, 44%);
            --bg-start: #f0f9ff;
            --bg-end: #e0f2f1;
            --card-bg: rgba(255, 255, 255, 0.85);
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --input-border-color: #cbd5e1;
            --input-focus-ring: hsla(var(--primary-hue), 58%, 50%, 0.28);
        }

        /* üåû SUMMER THEME (Softer Colors) */
        body.theme-summer {
            --primary-hue: 35;
            --secondary-hue: 15;
            --primary-color: hsl(var(--primary-hue), 88%, 60%);
            --primary-color-light: hsl(var(--primary-hue), 88%, 72%);
            --primary-color-dark: hsl(var(--primary-hue), 88%, 50%);
            --primary-color-translucent: hsla(var(--primary-hue), 88%, 60%, 0.12);
            --accent-color: hsl(var(--secondary-hue), 90%, 66%);
            --accent-color-dark: hsl(var(--secondary-hue), 90%, 56%);
            --bg-start: #fff7e6;
            --bg-end: #fff0e0;
            --card-bg: rgba(255, 255, 255, 0.88);
            --text-primary: #442c22;
            --text-secondary: #8c6f62;
            --border-color: #fce1c2;
            --input-border-color: #f7d2a5;
            --input-focus-ring: hsla(var(--primary-hue), 88%, 60%, 0.28);
        }

        /* üçÅ AUTUMN THEME (Softer Colors) */
        body.theme-autumn {
            --primary-hue: 25;
            --secondary-hue: 39;
            --primary-color: hsl(var(--primary-hue), 80%, 56%);
            --primary-color-light: hsl(var(--primary-hue), 80%, 68%);
            --primary-color-dark: hsl(var(--primary-hue), 80%, 46%);
            --primary-color-translucent: hsla(var(--primary-hue), 80%, 56%, 0.12);
            --accent-color: hsl(var(--secondary-hue), 85%, 60%);
            --accent-color-dark: hsl(var(--secondary-hue), 85%, 50%);
            --bg-start: #fef9f3;
            --bg-end: #fdf2e9;
            --card-bg: rgba(255, 252, 249, 0.85);
            --text-primary: #5c4432;
            --text-secondary: #785a4a;
            --border-color: #e7d8c9;
            --input-border-color: #d1bfae;
            --input-focus-ring: hsla(var(--primary-hue), 80%, 56%, 0.28);
        }

        /* ‚ùÑÔ∏è WINTER THEME (Softer Colors) */
        body.theme-winter {
            --primary-hue: 210;
            --secondary-hue: 190;
            --primary-color: hsl(var(--primary-hue), 52%, 54%);
            --primary-color-light: hsl(var(--primary-hue), 52%, 68%);
            --primary-color-dark: hsl(var(--primary-hue), 52%, 44%);
            --primary-color-translucent: hsla(var(--primary-hue), 52%, 54%, 0.12);
            --accent-color: hsl(var(--secondary-hue), 68%, 60%);
            --accent-color-dark: hsl(var(--secondary-hue), 68%, 50%);
            --bg-start: #f8fafc;
            --bg-end: #f1f5f9;
            --card-bg: rgba(255, 255, 255, 0.92);
            --text-primary: #334155;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --input-border-color: #cbd5e1;
            --input-focus-ring: hsla(var(--primary-hue), 52%, 54%, 0.28);
        }

        /* üåô NIGHT THEME (Softer Colors) */
        body.theme-night {
            --primary-hue: 215;
            --secondary-hue: 45;
            --primary-color: hsl(var(--primary-hue), 62%, 66%);
            --primary-color-light: hsl(var(--primary-hue), 62%, 78%);
            --primary-color-dark: hsl(var(--primary-hue), 62%, 56%);
            --primary-color-translucent: hsla(var(--primary-hue), 62%, 66%, 0.15);
            --accent-color: hsl(var(--secondary-hue), 85%, 60%);
            --accent-color-dark: hsl(var(--secondary-hue), 85%, 50%);
            --bg-start: #0f172a;
            --bg-end: #1a1829;
            --card-bg: rgba(30, 41, 59, 0.65);
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --border-color: #334155;
            --input-border-color: #475569;
            --input-focus-ring: hsla(var(--primary-hue), 62%, 66%, 0.3);
        }

        /* üìú HISTORIC THEME */
        body.theme-historic {
            --primary-hue: 35;
            --secondary-hue: 40;
            --primary-color: #8c6f62;
            --primary-color-light: #a68b7e;
            --primary-color-dark: #73584c;
            --primary-color-translucent: rgba(115, 88, 76, 0.1);
            --accent-color: #b58963;
            --accent-color-dark: #9c734f;
            --bg-start: #fdf6e3;
            --bg-end: #faf3e0;
            --card-bg: rgba(245, 235, 214, 0.7);
            --text-primary: #5c4432;
            --text-secondary: #7a6a58;
            --border-color: #dcd0b8;
            --input-border-color: #c9bca4;
            --input-focus-ring: rgba(181, 137, 99, 0.25);
        }

        /* üå≤ FOREST THEME */
        body.theme-forest {
            --primary-hue: 120;
            --secondary-hue: 95;
            --primary-color: hsl(var(--primary-hue), 30%, 45%);
            --primary-color-light: hsl(var(--primary-hue), 30%, 55%);
            --primary-color-dark: hsl(var(--primary-hue), 30%, 35%);
            --primary-color-translucent: hsla(var(--primary-hue), 30%, 45%, 0.1);
            --accent-color: hsl(var(--secondary-hue), 40%, 58%);
            --accent-color-dark: hsl(var(--secondary-hue), 40%, 48%);
            --bg-start: #f0f5f0;
            --bg-end: #e6eae6;
            --card-bg: rgba(255, 255, 255, 0.85);
            --text-primary: #2f3d2f;
            --text-secondary: #5a6b5a;
            --border-color: #d8e0d8;
            --input-border-color: #c4cdc4;
            --input-focus-ring: hsla(var(--primary-hue), 30%, 45%, 0.25);
        }

        /* üåä OCEAN THEME */
        body.theme-ocean {
            --primary-hue: 205;
            --secondary-hue: 180;
            --primary-color: hsl(var(--primary-hue), 58%, 54%);
            --primary-color-light: hsl(var(--primary-hue), 58%, 66%);
            --primary-color-dark: hsl(var(--primary-hue), 58%, 44%);
            --primary-color-translucent: hsla(var(--primary-hue), 58%, 54%, 0.12);
            --accent-color: hsl(var(--secondary-hue), 65%, 48%);
            --accent-color-dark: hsl(var(--secondary-hue), 65%, 38%);
            --bg-start: #f0f7ff;
            --bg-end: #e6f3ff;
            --card-bg: rgba(255, 255, 255, 0.85);
            --text-primary: #1e3a5f;
            --text-secondary: #4a6a8a;
            --border-color: #d9e8f7;
            --input-border-color: #c2d7e8;
            --input-focus-ring: hsla(var(--primary-hue), 58%, 54%, 0.28);
        }

        /* üåÖ SUNRISE THEME */
        body.theme-sunrise {
            --primary-hue: 15;
            --secondary-hue: 330;
            --primary-color: hsl(var(--primary-hue), 90%, 63%);
            --primary-color-light: hsl(var(--primary-hue), 90%, 75%);
            --primary-color-dark: hsl(var(--primary-hue), 90%, 53%);
            --primary-color-translucent: hsla(var(--primary-hue), 90%, 63%, 0.12);
            --accent-color: hsl(var(--secondary-hue), 80%, 68%);
            --accent-color-dark: hsl(var(--secondary-hue), 80%, 58%);
            --bg-start: #fff5f0;
            --bg-end: #ffeae0;
            --card-bg: rgba(255, 255, 255, 0.88);
            --text-primary: #5c3a28;
            --text-secondary: #8c6a58;
            --border-color: #f7e2d6;
            --input-border-color: #f0d2c2;
            --input-focus-ring: hsla(var(--primary-hue), 90%, 63%, 0.28);
        }

        /* üíú LAVENDER THEME */
        body.theme-lavender {
            --primary-hue: 260;
            --secondary-hue: 280;
            --primary-color: hsl(var(--primary-hue), 48%, 58%);
            --primary-color-light: hsl(var(--primary-hue), 48%, 70%);
            --primary-color-dark: hsl(var(--primary-hue), 48%, 48%);
            --primary-color-translucent: hsla(var(--primary-hue), 48%, 58%, 0.12);
            --accent-color: hsl(var(--secondary-hue), 58%, 63%);
            --accent-color-dark: hsl(var(--secondary-hue), 58%, 53%);
            --bg-start: #f7f5ff;
            --bg-end: #f0ebff;
            --card-bg: rgba(255, 255, 255, 0.85);
            --text-primary: #4a4166;
            --text-secondary: #6e638c;
            --border-color: #e5e0f5;
            --input-border-color: #d1c9e8;
            --input-focus-ring: hsla(var(--primary-hue), 48%, 58%, 0.28);
        }

        /* ‚ö´Ô∏è GRAPHITE THEME */
        body.theme-graphite {
            --primary-hue: 210;
            --secondary-hue: 0;
            --primary-color: hsl(var(--primary-hue), 10%, 55%);
            --primary-color-light: hsl(var(--primary-hue), 10%, 65%);
            --primary-color-dark: hsl(var(--primary-hue), 10%, 45%);
            --primary-color-translucent: hsla(var(--primary-hue), 10%, 55%, 0.1);
            --accent-color: hsl(var(--secondary-hue), 0%, 80%);
            --accent-color-dark: hsl(var(--secondary-hue), 0%, 70%);
            --bg-start: #111827;
            --bg-end: #1f2937;
            --card-bg: rgba(55, 65, 81, 0.6);
            --text-primary: #f9fafb;
            --text-secondary: #9ca3af;
            --border-color: #374151;
            --input-border-color: #4b5563;
            --input-focus-ring: hsla(var(--primary-hue), 10%, 55%, 0.25);
        }

        * {
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-start);
            background-image: linear-gradient(180deg, var(--bg-start) 0%, var(--bg-end) 100%);
            margin: 0;
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 15px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        body.theme-historic {
            background-image: linear-gradient(180deg, var(--bg-start) 0%, var(--bg-end) 100%), url('data:image/svg+xml,%3Csvg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M-10 10c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10zm20 20c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10zm20 20c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10zm20 20c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10zm20 20c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10z" fill="%239C92AC" fill-opacity="0.04" fill-rule="evenodd"/%3E%3C/svg%3E');
        }

        .decorative-title {
            font-family: 'Playfair Display', serif;
            text-align: center;
            font-size: 3.2rem;
            font-weight: 700;
            padding: 3rem 1rem 0 1rem;
            margin-bottom: 56px;
            background: linear-gradient(135deg, var(--accent-color-dark), var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 1px 1px 25px hsla(var(--primary-hue), 50%, 50%, 0.1), 0 2px 5px rgba(0, 0, 0, 0.05);
            animation: fadeInDown 1s ease-out, titleShimmer 3s ease-in-out infinite;
            letter-spacing: -0.5px;
        }

        @keyframes titleShimmer {

            0%,
            100% {
                filter: brightness(1);
            }

            50% {
                filter: brightness(1.2);
            }
        }

        /* --- 2Ô∏è‚É£ HEADER & NAVIGATION BAR --- */
        .top-nav {
            position: sticky;
            top: 1rem;
            margin: 0 1rem;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1.5rem;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            border: 1px solid rgba(226, 232, 240, 0.5);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            animation: fadeInDown 0.5s 0.2s ease-out backwards;
        }

        body.theme-night .top-nav,
        body.theme-graphite .top-nav {
            background: rgba(30, 41, 59, 0.7);
            border-color: rgba(51, 65, 85, 0.6);
        }

        body.theme-historic .top-nav {
            background: rgba(245, 235, 214, 0.7);
            border-color: rgba(181, 137, 99, 0.4);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Yeni Animasyonlar */
        @keyframes slideInFromLeft {
            from {
                opacity: 0;
                transform: translate3d(-30px, 0, 0);
            }

            to {
                opacity: 1;
                transform: translate3d(0, 0, 0);
            }
        }

        @keyframes slideInFromBottom {
            from {
                opacity: 0;
                transform: translate3d(0, 30px, 0);
            }

            to {
                opacity: 1;
                transform: translate3d(0, 0, 0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes rotateIn {
            from {
                opacity: 0;
                transform: rotate(-5deg) scale(0.95);
            }

            to {
                opacity: 1;
                transform: rotate(0) scale(1);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }

            100% {
                background-position: 1000px 0;
            }
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-placeholder {
            height: 40px;
            width: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            cursor: pointer;
            position: relative;
        }

        .logo-placeholder img {
            height: 100%;
            width: 100%;
            object-fit: contain;
            border-radius: 8px;
        }

        .logo-hint {
            position: absolute;
            bottom: -22px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            padding: 6px 12px 6px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            pointer-events: none;
            z-index: 10000;
            backdrop-filter: blur(8px);
            animation: gentlePulse 2s ease-in-out infinite;
        }

        /* Logo eklendiƒüinde gizle */
        .logo-placeholder.has-logo .logo-hint {
            display: none;
        }

        .logo-hint::before {
            content: '‚Üí ';
            font-size: 12px;
            animation: arrowBounce 1.5s ease-in-out infinite;
        }

        @keyframes gentlePulse {

            0%,
            100% {
                opacity: 0.85;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            }

            50% {
                opacity: 1;
                box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
            }
        }

        @keyframes arrowBounce {

            0%,
            100% {
                transform: translateX(0);
            }

            50% {
                transform: translateX(-3px);
            }
        }

        /* Logo eklendiƒüinde gizle */
        .logo-placeholder.has-logo .logo-hint {
            display: none !important;
        }

        .app-title {
            font-size: 1.35rem;
            font-weight: 800;
            color: var(--text-primary);
            letter-spacing: -0.3px;
            font-family: 'Inter', sans-serif;
            line-height: 1.3;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .app-title span {
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 0.9em;
            letter-spacing: -0.2px;
            opacity: 0.9;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .profile-info {
            background-color: var(--primary-color-translucent);
            color: var(--primary-color);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: 600;
        }

        .icon-btn {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 99px;
            transition: var(--transition);
        }

        .icon-btn:hover {
            background: var(--primary-color-translucent);
            color: var(--primary-color);
            transform: scale(1.1);
        }

        .icon-btn[onclick="changeProfile()"] {
            position: relative;
            z-index: 2;
        }

        /* Native tooltip'i devre dƒ±≈üƒ± bƒ±rak */
        input[title],
        select[title],
        textarea[title] {
            position: relative;
        }

        /* Genel Tooltip Sistemi - Yumu≈üak ve ≈ûeffaf */
        input[title]:not([title=""]):hover::after,
        select[title]:not([title=""]):hover::after,
        textarea[title]:not([title=""]):hover::after {
            content: attr(title) !important;
            position: absolute !important;
            bottom: 110% !important;
            left: 50% !important;
            transform: translateX(-50%) translateY(10px) scale(0.95) !important;
            background: linear-gradient(135deg,
                    hsla(var(--primary-hue), 60%, 65%, 0.96),
                    hsla(var(--secondary-hue), 65%, 68%, 0.96)) !important;
            backdrop-filter: blur(20px) saturate(180%) !important;
            -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
            color: white !important;
            padding: 10px 18px !important;
            border-radius: 12px !important;
            font-size: 13px !important;
            font-weight: 600 !important;
            white-space: nowrap !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1),
                0 6px 15px rgba(0, 0, 0, 0.06),
                0 0 0 1px rgba(255, 255, 255, 0.2) inset,
                0 1px 3px rgba(255, 255, 255, 0.3) inset !important;
            opacity: 0 !important;
            pointer-events: none !important;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
            z-index: 10001 !important;
            text-align: center !important;
            line-height: 1.5 !important;
            letter-spacing: 0.4px !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
        }

        /* Logo Tooltip - Hover'da g√∂r√ºn√ºr */
        .logo-placeholder:not(.has-logo):hover::after {
            content: 'Logo ekleyip silebilirsiniz' !important;
            position: absolute !important;
            bottom: 110% !important;
            left: 50% !important;
            transform: translateX(-50%) translateY(0) scale(1) !important;
            background: linear-gradient(135deg,
                    hsla(var(--primary-hue), 60%, 65%, 0.96),
                    hsla(var(--secondary-hue), 65%, 68%, 0.96)) !important;
            backdrop-filter: blur(20px) saturate(180%) !important;
            -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
            color: white !important;
            padding: 10px 18px !important;
            border-radius: 12px !important;
            font-size: 13px !important;
            font-weight: 600 !important;
            white-space: nowrap !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1),
                0 6px 15px rgba(0, 0, 0, 0.06),
                0 0 0 1px rgba(255, 255, 255, 0.2) inset,
                0 1px 3px rgba(255, 255, 255, 0.3) inset !important;
            opacity: 1 !important;
            pointer-events: none !important;
            z-index: 10001 !important;
            text-align: center !important;
            line-height: 1.5 !important;
            letter-spacing: 0.4px !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
            animation: tooltipBounce 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
        }

        @keyframes tooltipBounce {
            0% {
                transform: translateX(-50%) translateY(10px) scale(0.95);
                opacity: 0;
            }

            100% {
                transform: translateX(-50%) translateY(0) scale(1);
                opacity: 1;
            }
        }

        input[title]:not([title=""]):hover::after,
        select[title]:not([title=""]):hover::after,
        textarea[title]:not([title=""]):hover::after {
            opacity: 1;
            transform: translateX(-50%) translateY(0) scale(1);
        }

        /* Karanlƒ±k temalarda tooltip - Daha parlak */
        body.theme-night .logo-placeholder::after,
        body.theme-graphite .logo-placeholder::after,
        body.theme-night input[title]:not([title=""]):hover::after,
        body.theme-night select[title]:not([title=""]):hover::after,
        body.theme-night textarea[title]:not([title=""]):hover::after,
        body.theme-graphite input[title]:not([title=""]):hover::after,
        body.theme-graphite select[title]:not([title=""]):hover::after,
        body.theme-graphite textarea[title]:not([title=""]):hover::after {
            background: linear-gradient(135deg,
                    hsla(var(--primary-hue), 60%, 78%, 0.96),
                    hsla(var(--secondary-hue), 75%, 75%, 0.96));
            color: #1a1a2e;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.2);
        }

        /* Historic tema i√ßin √∂zel tooltip */
        body.theme-historic .logo-placeholder::after,
        body.theme-historic input[title]:not([title=""]):hover::after,
        body.theme-historic select[title]:not([title=""]):hover::after,
        body.theme-historic textarea[title]:not([title=""]):hover::after {
            background: linear-gradient(135deg,
                    rgba(166, 139, 126, 0.96),
                    rgba(201, 167, 139, 0.96));
        }

        .logo-delete-btn {
            position: absolute;
            top: 0;
            right: 0;
            transform: translate(30%, -30%) scale(0.9);
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(226, 232, 240, 0.4);
            border-radius: 50%;
            color: var(--text-secondary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            opacity: 0;
            pointer-events: none;
            transition: all 260ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        .logo-placeholder:hover .logo-delete-btn {
            opacity: 1;
            pointer-events: auto;
            transform: translate(30%, -30%) scale(1);
        }

        .logo-delete-btn:hover {
            transform: translate(30%, -30%) scale(1.06);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
            color: var(--primary-color);
        }

        #theme-wrapper {
            position: relative;
            margin: 0 0.5rem;
        }

        #theme-trigger {
            font-size: 1.5rem;
            line-height: 1;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #theme-trigger i {
            width: 24px;
            height: 24px;
            stroke-width: 2;
            transition: all 0.3s ease;
        }

        #theme-trigger:hover {
            transform: scale(1.15);
        }

        #theme-trigger:hover i {
            color: var(--primary-color);
            transform: rotate(15deg) scale(1.1);
        }

        #theme-wrapper.wheel-is-open #theme-trigger {
            transform: rotate(90deg) scale(1.1);
        }

        #theme-wrapper.wheel-is-open #theme-trigger i {
            color: var(--primary-color);
            stroke-width: 2.5;
        }

        #theme-wheel-container {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 40px;
            height: 40px;
            opacity: 0;
            pointer-events: none;
            transform: translate(-50%, -50%) scale(0.5);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10;
        }

        #theme-wrapper.wheel-is-open #theme-wheel-container {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, 80px) scale(1.6);
        }

        .theme-wheel {
            list-style: none;
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            position: absolute;
            transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            border-radius: 50%;
        }

        .theme-option {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 40px;
            height: 40px;
            margin: -20px;
            transform: scale(0);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        #theme-wrapper.wheel-is-open .theme-option {
            transform: scale(1);
        }

        .theme-option:nth-child(1) {
            transition-delay: 0.02s;
        }

        .theme-option:nth-child(2) {
            transition-delay: 0.04s;
        }

        .theme-option:nth-child(3) {
            transition-delay: 0.06s;
        }

        .theme-option:nth-child(4) {
            transition-delay: 0.08s;
        }

        .theme-option:nth-child(5) {
            transition-delay: 0.1s;
        }

        .theme-option:nth-child(6) {
            transition-delay: 0.12s;
        }

        .theme-option:nth-child(7) {
            transition-delay: 0.14s;
        }

        .theme-option:nth-child(8) {
            transition-delay: 0.16s;
        }

        .theme-option:nth-child(9) {
            transition-delay: 0.18s;
        }

        .theme-option:nth-child(10) {
            transition-delay: 0.2s;
        }

        .theme-option:nth-child(11) {
            transition-delay: 0.22s;
        }

        /* DEƒûƒ∞≈ûƒ∞KLƒ∞K: Tema ikonlarƒ± son isteƒüe g√∂re g√ºncellendi */
        .theme-option button {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
            font-size: 1.4rem;
            line-height: 1;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .theme-option[data-theme="theme-spring"] button {
            background-image: linear-gradient(135deg, hsl(145, 55%, 82%), hsl(175, 50%, 78%));
        }

        .theme-option[data-theme="theme-summer"] button {
            background-image: linear-gradient(135deg, hsl(15, 85%, 88%), hsl(35, 80%, 82%));
        }

        .theme-option[data-theme="theme-autumn"] button {
            background-image: linear-gradient(135deg, hsl(39, 80%, 82%), hsl(25, 75%, 78%));
        }

        .theme-option[data-theme="theme-winter"] button {
            background-image: linear-gradient(135deg, hsl(190, 65%, 82%), hsl(210, 45%, 85%));
        }

        .theme-option[data-theme="theme-night"] button {
            background-image: linear-gradient(135deg, hsl(215, 55%, 38%), hsl(45, 80%, 32%));
        }

        .theme-option[data-theme="theme-historic"] button {
            background-image: linear-gradient(135deg, #d3c4b2, #e4d7c5);
        }

        .theme-option[data-theme="theme-forest"] button {
            background-image: linear-gradient(135deg, hsl(95, 40%, 78%), hsl(120, 30%, 75%));
        }

        .theme-option[data-theme="theme-ocean"] button {
            background-image: linear-gradient(135deg, hsl(180, 60%, 70%), hsl(205, 50%, 75%));
        }

        .theme-option[data-theme="theme-sunrise"] button {
            background-image: linear-gradient(135deg, hsl(330, 75%, 80%), hsl(15, 85%, 85%));
        }

        .theme-option[data-theme="theme-lavender"] button {
            background-image: linear-gradient(135deg, hsl(280, 50%, 85%), hsl(260, 40%, 80%));
        }

        .theme-option[data-theme="theme-graphite"] button {
            background-image: linear-gradient(135deg, hsl(210, 10%, 45%), hsl(0, 0%, 50%));
        }

        .theme-option button:hover {
            transform: scale(1.15);
            box-shadow: var(--shadow-md);
            filter: brightness(1.1);
        }

        .theme-option.active button {
            transform: scale(1.1);
            box-shadow: 0 0 15px hsla(var(--primary-hue), 85%, 60%, 0.8), 0 0 0 3px var(--primary-color);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1.5rem 2rem 2rem 2rem;
        }

        /* --- 6Ô∏è‚É£ PROFILE MANAGEMENT (MODERNIZED FULLSCREEN LAYOUT) --- */
        #profile-selection-screen {
            position: fixed;
            inset: 0;
            z-index: 10001;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-image: linear-gradient(180deg, var(--bg-start) 0%, var(--bg-end) 100%);
            text-align: center;
            padding: 2rem;
            animation: fadeIn 0.5s ease-out;
            min-height: 100vh;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .profile-modal {
            background: transparent;
            backdrop-filter: none;
            -webkit-backdrop-filter: none;
            border: none;
            box-shadow: none;
            padding: 2rem;
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        body.theme-night .profile-modal,
        body.theme-graphite .profile-modal {
            background: transparent;
        }

        body.theme-historic .profile-modal {
            background: transparent;
        }

        .profile-modal h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.75rem;
        }

        .profile-modal p {
            color: var(--text-secondary);
            margin-bottom: 3rem;
            max-width: 500px;
            font-size: 1.1rem;
        }

        .profile-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.5rem;
        }

        .profile-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            opacity: 0;
            animation: fadeInUp 0.5s ease-out forwards;
            flex-basis: 240px;
            min-height: 130px;
            box-shadow: var(--shadow-md);
        }

        .profile-container .profile-card:nth-child(1) {
            animation-delay: 0.1s;
        }

        .profile-container .profile-card:nth-child(2) {
            animation-delay: 0.15s;
        }

        .profile-container .profile-card:nth-child(3) {
            animation-delay: 0.2s;
        }

        .profile-container .profile-card:nth-child(4) {
            animation-delay: 0.25s;
        }

        .profile-container .profile-card:nth-child(5) {
            animation-delay: 0.3s;
        }

        .profile-container .profile-card:nth-child(6) {
            animation-delay: 0.35s;
        }

        .profile-container .profile-card:nth-child(7) {
            animation-delay: 0.4s;
        }

        .profile-container .profile-card:nth-child(8) {
            animation-delay: 0.45s;
        }

        .profile-container .profile-card:nth-child(9) {
            animation-delay: 0.5s;
        }

        .profile-container .profile-card:nth-child(10) {
            animation-delay: 0.55s;
        }

        .profile-container .profile-card:nth-child(11) {
            animation-delay: 0.6s;
        }

        .profile-container .profile-card:nth-child(12) {
            animation-delay: 0.65s;
        }

        .profile-container .profile-card:nth-child(13) {
            animation-delay: 0.7s;
        }

        .profile-container .profile-card:nth-child(14) {
            animation-delay: 0.75s;
        }

        .profile-container .profile-card:nth-child(15) {
            animation-delay: 0.8s;
        }

        .profile-container .profile-card:nth-child(16) {
            animation-delay: 0.85s;
        }

        .profile-container .profile-card:nth-child(17) {
            animation-delay: 0.9s;
        }

        .profile-card:hover {
            transform: translateY(-10px) scale(1.05) rotate(2deg);
            border-color: var(--primary-color);
            box-shadow: var(--shadow-lg), 0 0 40px var(--input-focus-ring);
            background-color: var(--primary-color-translucent);
        }

        .profile-card:hover .profile-icon {
            animation: bounce 0.6s ease-in-out;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .profile-card:focus-visible {
            outline: 2px solid var(--accent-color);
            outline-offset: 4px;
        }

        .profile-icon {
            color: var(--primary-color);
        }

        .profile-card h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }


        /* --- 3Ô∏è‚É£ INTERACTIVE LAYOUT --- */
        .tab-nav {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .tab-btn {
            background: transparent;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-md);
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            letter-spacing: -0.2px;
            animation: slideInFromLeft 0.5s ease-out backwards;
        }

        .tab-btn:nth-child(1) {
            animation-delay: 0.1s;
        }

        .tab-btn:nth-child(2) {
            animation-delay: 0.2s;
        }

        .tab-btn:nth-child(3) {
            animation-delay: 0.3s;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            transform: translateY(-2px);
            background: var(--primary-color-translucent);
        }

        .tab-btn:active {
            transform: translateY(-2px) scale(0.98);
        }

        .tab-btn.active {
            color: var(--primary-color);
            background: var(--primary-color-translucent);
        }

        .tab-btn::after {
            content: '';
            position: absolute;
            bottom: -17px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 3px;
            background-color: var(--primary-color);
            border-radius: 3px;
            transition: width 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .tab-btn.active::after {
            width: calc(100% - 2.5rem);
        }

        @keyframes jiggle {

            0%,
            100% {
                transform: rotate(0) scale(1);
            }

            25% {
                transform: rotate(-5deg) scale(1.1);
            }

            75% {
                transform: rotate(5deg) scale(1.1);
            }
        }

        .tab-btn.active i {
            animation: jiggle 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes confetti {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(-100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            z-index: 10000;
            pointer-events: none;
        }

        .content-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            padding: 2.5rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            animation: slideInFromBottom 0.6s ease-out;
            will-change: transform;
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
        }

        .content-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .content-card:hover {
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .content-card:hover::before {
            opacity: 1;
        }

        @keyframes pulse-glow {

            0%,
            100% {
                text-shadow: 0 0 8px transparent;
            }

            50% {
                text-shadow: 0 0 12px var(--primary-color-translucent);
            }
        }

        .content-card h4 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 0 0 1.75rem 0;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--primary-color);
            animation: pulse-glow 4s ease-in-out infinite;
            font-family: 'Inter', sans-serif;
            letter-spacing: -0.3px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            text-align: center;
        }

        .content-card h4 i {
            flex-shrink: 0;
        }

        .info-sub-group {
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            margin-top: 1rem;
            background-color: hsla(0, 0%, 99%, .5);
        }

        body.theme-night .info-sub-group,
        body.theme-graphite .info-sub-group {
            background-color: hsla(220, 26%, 12%, 0.5);
        }

        body.theme-historic .info-sub-group {
            background-color: hsla(39, 40%, 90%, 0.5);
        }

        .info-sub-group h5 {
            margin: -1.5rem -1.5rem 1rem -1.5rem;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            text-align: center;
            background-color: var(--primary-color-translucent);
            border-bottom: 1px solid var(--border-color);
            border-top-left-radius: var(--radius-md);
            border-top-right-radius: var(--radius-md);
        }

        /* Floating Info Kartƒ± */
        .floating-info-card {
            position: fixed;
            bottom: 6rem;
            right: 2rem;
            width: 320px;
            background: linear-gradient(135deg, var(--card-bg), var(--bg-start));
            border: 2px solid var(--primary-color);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.1);
            z-index: 998;
            backdrop-filter: blur(20px);
            animation: slideInFromRight 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 1s;
            animation-fill-mode: both;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .floating-info-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.2);
        }

        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(100px) scale(0.9);
            }

            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        .floating-info-card .info-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-bottom: 0.75rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        .floating-info-card h5 {
            margin: 0 0 0.5rem 0;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .floating-info-card p {
            margin: 0;
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .floating-info-card .close-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 50%;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .floating-info-card .close-btn:hover {
            background: var(--primary-color-translucent);
            color: var(--primary-color);
            transform: rotate(90deg);
        }

        @media (max-width: 768px) {
            .floating-info-card {
                width: calc(100% - 2rem);
                right: 1rem;
                left: 1rem;
                bottom: 5rem;
            }
        }

        /* --- 4Ô∏è‚É£ MODERN FORM DESIGN --- */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .input-group {
            position: relative;
            margin-bottom: 1rem;
        }

        .input-group:last-child {
            margin-bottom: 0;
        }

        .input-group label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 0.6rem;
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text-primary);
            text-align: center;
        }

        .input-group label i {
            color: var(--primary-color);
            width: 16px;
            height: 16px;
        }

        .input-group small {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.4rem;
            padding: 0;
            background: transparent;
            border-radius: 0;
            opacity: 0.5;
            transition: var(--transition);
            font-style: italic;
            line-height: 1.4;
        }

        .input-group small:hover {
            opacity: 0.8;
        }

        .input-group small i {
            color: var(--primary-color);
            flex-shrink: 0;
            width: 15px;
            height: 15px;
            opacity: 0.5;
            stroke-width: 2;
            position: relative;
            top: 1px;
        }

        /* T√ºm info ikonlarƒ± i√ßin genel stil */
        i[data-lucide="info"] {
            width: 15px !important;
            height: 15px !important;
            stroke-width: 2 !important;
            opacity: 0.5 !important;
            color: var(--primary-color) !important;
        }

        .input-group input,
        .input-group select,
        .input-group textarea,
        .transport-entry input,
        .transport-entry select {
            width: 100%;
            height: 46px;
            padding: 0 1rem;
            border-radius: 12px;
            border: 1px solid var(--input-border-color);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 15px;
            background: var(--bg-start);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
            text-align: center;
            font-weight: 500;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            letter-spacing: 0.2px;
        }

        .input-group input[type="date"],
        .input-group input[type="time"],
        .input-group input[type="number"] {
            height: 52px;
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
            letter-spacing: 0.5px;
            border-radius: 14px;
            border: 3px solid var(--border-color);
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        
        .input-group input[type="date"]:hover,
        .input-group input[type="time"]:hover,
        .input-group input[type="number"]:hover {
            border-color: var(--primary-color);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .input-group input[type="date"]:focus,
        .input-group input[type="time"]:focus,
        .input-group input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px var(--input-focus-ring), 0 6px 16px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
            background: #ffffff;
        }

        /* Input deƒüeri girildiƒüinde animasyon */
        .input-group input:not(:placeholder-shown),
        .input-group select:not([value=""]),
        .input-group textarea:not(:placeholder-shown) {
            font-weight: 600;
            color: var(--primary-color);
            border-color: var(--primary-color);
            background: linear-gradient(135deg, var(--bg-start), var(--primary-color-translucent));
            transform: scale(1.01);
            letter-spacing: 0.3px;
        }

        /* Text input'lar i√ßin placeholder ortalƒ± */
        .input-group input[type="text"]::placeholder,
        .input-group textarea::placeholder {
            text-align: center;
        }
        
        /* Wizard input placeholder'larƒ± daha soluk */
        .wizard-input-group input::placeholder,
        .wizard-input-group textarea::placeholder {
            color: #cbd5e1;
            opacity: 0.5;
            font-weight: 400;
        }

        /* Focus olduƒüunda sola hizala (yazarken rahat olsun) */
        .input-group input[type="text"]:focus,
        .input-group textarea:focus {
            text-align: left;
        }

        /* G√ºzergah ve G√∂rev Konusu i√ßin √∂zel stil */
        .travel-route,
        .travel-konu {
            font-weight: 500;
        }

        /* Autocomplete a√ßƒ±kken parent'ƒ±n z-index'ini artƒ±r */
        .input-group:has(.autocomplete-items[style*="display: block"]) {
            z-index: 10004 !important;
        }

        body.theme-night .input-group input,
        body.theme-night .input-group select,
        body.theme-night .input-group textarea,
        body.theme-night .transport-entry input,
        body.theme-night .transport-entry select,
        body.theme-graphite .input-group input,
        body.theme-graphite .input-group select,
        body.theme-graphite .input-group textarea,
        body.theme-graphite .transport-entry input,
        body.theme-graphite .transport-entry select {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }
        
        body.theme-night .input-group input[type="date"]:focus,
        body.theme-night .input-group input[type="time"]:focus,
        body.theme-night .input-group input[type="number"]:focus,
        body.theme-graphite .input-group input[type="date"]:focus,
        body.theme-graphite .input-group input[type="time"]:focus,
        body.theme-graphite .input-group input[type="number"]:focus {
            background: #1e293b;
        }

        /* Hƒ±zlƒ± Karanlƒ±k Mod Toggle */
        .quick-dark-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            border: none;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: var(--transition);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .quick-dark-toggle:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }

        /* Akan Bilgilendirme Bandƒ± - KALDIRILDI (Dikkat daƒüƒ±tƒ±cƒ±) */
        body.theme-historic .input-group input,
        body.theme-historic .input-group select,
        body.theme-historic .input-group textarea,
        body.theme-historic .transport-entry input,
        body.theme-historic .transport-entry select {
            background: #fdf6e3;
        }

        .input-group textarea {
            height: auto;
            min-height: 80px;
            padding: 0.875rem;
            line-height: 1.5;
        }

        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus,
        .transport-entry input:focus,
        .transport-entry select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px var(--input-focus-ring), 0 4px 12px rgba(0, 0, 0, 0.08);
            transform: translateY(-2px) scale(1.02);
            font-weight: 600;
            background: linear-gradient(135deg, white, var(--primary-color-translucent));
            letter-spacing: 0.3px;
        }

        .input-group select[multiple] {
            height: 160px;
            padding: 0.5rem;
            background-color: var(--card-bg);
            font-weight: 500;
        }

        .input-group select[multiple] option:checked {
            background-color: var(--primary-color-translucent);
            color: var(--primary-color);
            font-weight: 600;
        }

        /* Select option'larƒ± i√ßin hover */
        .input-group select option:hover {
            background-color: var(--primary-color-translucent);
        }

        .month-selector-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.75rem;
            margin-top: 0.5rem;
        }

        .month-btn {
            padding: 0.75rem 0.5rem;
            border: 2px solid var(--border-color);
            background: var(--bg-start);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .month-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--primary-color-translucent);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .month-btn:hover::before {
            width: 200%;
            height: 200%;
        }

        .month-btn:hover {
            border-color: var(--primary-color-light);
            background: var(--primary-color-translucent);
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--shadow-sm);
        }

        .month-btn:active {
            transform: translateY(-1px) scale(0.98);
        }

        .month-btn.selected {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: white;
            box-shadow: var(--shadow-md);
            transform: scale(1.05);
            animation: monthPulse 0.4s ease-out;
        }

        @keyframes monthPulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1.05);
            }
        }

        .month-btn.all-months {
            grid-column: span 4;
            background: var(--accent-color-dark);
            color: white;
            border-color: var(--accent-color-dark);
            font-size: 0.95rem;
        }

        .month-btn.all-months.selected {
            background: var(--accent-color);
            border-color: var(--accent-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .month-selector-info {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            background: transparent;
            border-radius: 0;
            opacity: 0.7;
            transition: var(--transition);
        }

        .month-selector-info:hover {
            opacity: 1;
        }

        .month-selector-info i {
            color: var(--primary-color);
            flex-shrink: 0;
            width: 14px;
            height: 14px;
            opacity: 0.8;
        }

        .period-selector-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-top: 0.5rem;
        }

        .period-btn {
            padding: 1rem;
            border: 2px solid var(--border-color);
            background: var(--bg-start);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .period-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--primary-color-translucent);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .period-btn:hover::before {
            width: 200%;
            height: 200%;
        }

        .period-btn:hover {
            border-color: var(--primary-color-light);
            background: var(--primary-color-translucent);
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--shadow-sm);
        }

        .period-btn.selected {
            border-color: var(--accent-color);
            background: var(--accent-color);
            color: white;
            box-shadow: var(--shadow-md);
            transform: scale(1.05);
            animation: periodPulse 0.4s ease-out;
        }

        @keyframes periodPulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1.05);
            }
        }

        .period-btn-label {
            display: block;
            font-size: 0.75rem;
            opacity: 0.8;
            margin-top: 0.25rem;
        }

        .input-group input:hover,
        .input-group select:hover,
        .input-group textarea:hover,
        .transport-entry input:hover,
        .transport-entry select:hover {
            border-color: var(--primary-color-light);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .input-group input:not(:placeholder-shown),
        .input-group select:not([value=""]),
        .input-group textarea:not(:placeholder-shown) {
            border-color: var(--primary-color);
        }

        /* --- 5Ô∏è‚É£ BUTTONS & ICONS --- */
        button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            background-image: linear-gradient(135deg, var(--primary-color-light), var(--primary-color));
            color: white;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        button:hover::before {
            width: 300px;
            height: 300px;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md), 0 0 20px hsla(var(--primary-hue), 50%, 60%, 0.4);
            filter: brightness(1.1);
        }

        button:active {
            transform: translateY(-1px) scale(0.98);
            filter: brightness(1.0);
        }

        button.add-btn {
            background-image: linear-gradient(135deg, var(--accent-color), var(--accent-color-dark));
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            }

            50% {
                box-shadow: 0 4px 16px hsla(var(--secondary-hue), 80%, 60%, 0.4);
            }
        }

        button.add-btn:hover {
            box-shadow: var(--shadow-md), 0 0 30px hsla(var(--secondary-hue), 80%, 60%, 0.6);
            animation: none;
            transform: translateY(-3px) scale(1.05);
        }

        button.remove-btn {
            background: #fee2e2;
            color: #dc2626;
            padding: 0.5rem 0.75rem;
            font-size: 0.8rem;
            font-weight: 600;
            background-image: none;
        }

        button.remove-btn:hover {
            background-color: #dc2626;
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .main-action-btn {
            width: 100%;
            padding: 1rem 1.25rem;
            font-size: 1.05rem;
            font-weight: 700;
            background-image: linear-gradient(90deg, var(--accent-color), var(--accent-color-dark));
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .main-action-btn::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }

        .main-action-btn:hover::after {
            transform: translateX(100%);
        }

        .main-action-btn:hover {
            transform: translateY(-4px) scale(1.03);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25), 0 0 30px hsla(var(--secondary-hue), 80%, 60%, 0.6);
            filter: brightness(1.15);
            animation: buttonShake 0.5s ease-in-out;
        }

        @keyframes buttonShake {

            0%,
            100% {
                transform: translateY(-3px) scale(1.02) rotate(0deg);
            }

            25% {
                transform: translateY(-3px) scale(1.02) rotate(-1deg);
            }

            75% {
                transform: translateY(-3px) scale(1.02) rotate(1deg);
            }
        }

        .save-and-close-btn {
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            font-weight: 700;
            background-image: linear-gradient(135deg, var(--primary-color), var(--primary-color-dark));
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        }

        .save-and-close-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--shadow-lg), 0 0 25px hsla(var(--primary-hue), 60%, 60%, 0.5);
            filter: brightness(1.1);
        }

        .report-generate-btn {
            position: relative;
            font-size: 1.05rem !important;
            font-weight: 800 !important;
            padding: 1.2rem 1.5rem !important;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25) !important;
            border: 2px solid rgba(255, 255, 255, 0.3);
            width: 100% !important;
            min-height: 68px !important;
            height: 68px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
            gap: 0.75rem !important;
            line-height: 1.4 !important;
            letter-spacing: 0.02em !important;
        }

        .report-generate-btn i {
            flex-shrink: 0 !important;
            width: 22px !important;
            height: 22px !important;
            stroke-width: 2.5 !important;
        }

        .report-generate-btn span {
            display: inline-block;
            text-align: center;
            flex: 1;
            max-width: 100%;
        }

        .report-generate-btn::after {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: var(--radius-md);
            padding: 2px;
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color), var(--accent-color-dark));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .report-generate-btn:hover::after {
            opacity: 0.6;
        }

        .report-generate-btn:hover {
            transform: translateY(-5px) scale(1.04) !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3), 0 0 40px hsla(var(--secondary-hue), 80%, 60%, 0.7) !important;
            filter: brightness(1.2) !important;
        }

        .toggle-switch-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            user-select: none;
            margin-top: 1rem;
            padding: 0.5rem;
            border-radius: var(--radius-md);
            background: var(--primary-color-translucent);
            justify-content: center;
        }

        .toggle-label {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-secondary);
            transition: var(--transition);
        }

        .toggle-switch-container.isleyis-active .toggle-label.right,
        .toggle-switch-container:not(.isleyis-active) .toggle-label.left {
            color: var(--primary-color);
            transform: scale(1.05);
            font-weight: 700;
        }

        .toggle-switch {
            width: 56px;
            height: 30px;
            background-color: var(--input-border-color);
            border-radius: 15px;
            position: relative;
            transition: var(--transition);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .toggle-handle {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 50%;
            box-shadow: var(--shadow-sm);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .toggle-switch-container.isleyis-active .toggle-switch {
            background-color: var(--accent-color);
        }

        .toggle-switch-container.isleyis-active .toggle-handle {
            transform: translateX(26px);
        }

        /* --- SEYAHAT KARTI (CARD) TASARIMI --- */
        @keyframes slideInFromBottom {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.98);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .travel-card.newly-added {
            animation: slideInFromBottom 0.5s ease-out;
        }

        #travel-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .travel-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
            position: relative;
        }

        .travel-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .travel-card:hover::before {
            left: 100%;
        }

        .travel-card:hover {
            border-color: var(--primary-color-light);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .travel-card-summary {
            padding: 1rem 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            user-select: none;
        }

        .travel-card-summary:active {
            transform: scale(0.99);
        }

        .travel-card.is-collapsed .travel-card-summary {
            display: flex;
        }

        .travel-card:not(.is-collapsed) .travel-card-summary {
            display: none;
        }

        .summary-info {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            flex-grow: 1;
            min-width: 0;
            flex-wrap: nowrap;
        }

        .summary-seq-no {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .summary-item {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex-shrink: 1;
        }

        .summary-item i {
            flex-shrink: 0;
        }

        .summary-item.summary-date-type {
            flex-shrink: 0;
            color: var(--text-primary);
        }

        .summary-item.summary-route {
            min-width: 100px;
            flex-basis: 25%;
            color: var(--text-secondary);
        }

        .summary-item.summary-subject {
            min-width: 120px;
            flex-basis: 40%;
            color: var(--text-secondary);
        }

        /* Uyarƒ± mesajlarƒ± i√ßin stil (G√ºzergah Yok, Konu Yok) */
        .summary-item span i {
            color: #f59e0b;
            font-style: italic;
            font-weight: 600;
            animation: gentlePulse 3s ease-in-out infinite;
        }

        @keyframes gentlePulse {

            0%,
            100% {
                opacity: 0.7;
                transform: scale(1);
            }

            50% {
                opacity: 1;
                transform: scale(1.02);
            }
        }

        .summary-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-shrink: 0;
        }

        .travel-card-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease-in-out, padding 0.5s;
        }

        .travel-card:not(.is-collapsed) .travel-card-content {
            padding: 1.25rem;
            max-height: 2000px;
            opacity: 1;
        }

        .travel-progress-bar {
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .travel-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            width: 0%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px var(--primary-color);
        }

        .travel-form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            padding-bottom: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .travel-form-step {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
            transition: var(--transition);
            position: relative;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: 1;
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
        }

        /* G√∂rev Detaylarƒ± b√∂l√ºm√º i√ßin √∂zel z-index (autocomplete i√ßin) */
        .travel-form-step:has(.travel-route),
        .travel-form-step:has(.travel-konu) {
            z-index: 100 !important;
        }

        .travel-form-step .input-group {
            margin-bottom: 0;
        }

        .travel-form-step::before {
            display: none;
        }

        .travel-form-step:hover {
            border-color: var(--primary-color);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            transform: translateY(-4px);
        }

        .travel-form-step label {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--primary-color);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-align: center;
        }

        .travel-form-step label i {
            width: 18px;
            height: 18px;
            opacity: 0.8;
        }

        .travel-form-step small {
            display: none !important;
        }

        .travel-form-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
        }

        .travel-form-row-2col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .form-column>.input-group {
            margin-bottom: 1rem;
        }

        .date-time-fields-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .date-time-fields-grid input[type="time"],
        .date-time-fields-grid input[type="number"],
        .date-time-fields-grid input[type="date"] {
            width: 100%;
            max-width: none;
            height: 50px;
            font-size: 1.05rem;
            font-weight: 600;
            padding: 0.75rem 1rem;
        }

        .date-time-fields-grid label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        
        .date-time-fields-grid label i {
            width: 16px;
            height: 16px;
            color: var(--primary-color);
        }
        
        /* Calendar picker icon stilleri - Seyahat kartlarƒ± i√ßin */
        .input-group input[type="date"]::-webkit-calendar-picker-indicator,
        .input-group input[type="time"]::-webkit-calendar-picker-indicator {
            cursor: pointer;
            width: 24px;
            height: 24px;
            padding: 0.2rem;
            border-radius: 6px;
            transition: all 0.2s ease;
            opacity: 0.6;
        }
        
        .input-group input[type="date"]::-webkit-calendar-picker-indicator:hover,
        .input-group input[type="time"]::-webkit-calendar-picker-indicator:hover {
            opacity: 1;
            background: var(--primary-color-translucent);
            border-radius: 8px;
            transform: scale(1.15);
        }

        .gorev-tipi-options {
            display: flex;
            gap: 0.5rem;
            background: var(--primary-color-translucent);
            border-radius: 12px;
            padding: 0.35rem;
            margin-top: 0.5rem;
        }

        body.theme-night .gorev-tipi-options,
        body.theme-graphite .gorev-tipi-options {
            background: rgba(255, 255, 255, 0.05);
        }

        .gorev-tipi-option {
            flex: 1;
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 0.85rem;
            cursor: pointer;
            text-align: center;
            transition: var(--transition);
            font-size: 0.9rem;
            font-weight: 500;
            user-select: none;
        }

        .gorev-tipi-option:hover {
            background-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
        }

        body.theme-night .gorev-tipi-option:hover,
        body.theme-graphite .gorev-tipi-option:hover {
            background-color: rgba(255, 255, 255, 0.08);
        }

        .gorev-tipi-option.active {
            border-color: var(--primary-color);
            background-color: white;
            font-weight: 700;
            color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: scale(1.02);
        }

        body.theme-night .gorev-tipi-option.active,
        body.theme-graphite .gorev-tipi-option.active {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .gorev-tipi-option input {
            display: none;
        }

        .transport-details {
            min-height: auto !important;
            padding: 1rem !important;
        }

        .transport-details-header {
            font-weight: 600;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.1rem;
            margin: 0.5rem 0 0.75rem 0;
        }

        .transport-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            width: 100%;
        }

        .transport-entry {
            display: grid;
            grid-template-columns: 1.5fr 3fr 1.5fr 1.5fr auto;
            gap: 0.75rem;
            align-items: center;
            box-sizing: border-box;
        }
        
        .transport-entry input,
        .transport-entry select {
            box-sizing: border-box;
            min-width: 0;
        }

        .add-transport-btn {
            background: transparent;
            border: 1px dashed var(--input-border-color);
            color: var(--text-secondary);
            font-weight: 500;
            width: 100%;
            margin-top: 1rem;
            background-image: none;
        }

        .add-transport-btn:hover {
            background: var(--primary-color-translucent);
            color: var(--primary-color);
            border-color: var(--primary-color);
            transform: translateY(0);
            box-shadow: none;
        }

        .travel-card-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }

        .report-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .report-group {
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            background: var(--bg-start);
        }

        body.theme-night .report-group,
        body.theme-graphite .report-group {
            background: #0f172a;
        }

        .report-group h4 {
            margin: -1.5rem -1.5rem 1.5rem -1.5rem;
            padding: 1.25rem 1.5rem;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--primary-color);
            background: linear-gradient(135deg, var(--primary-color-translucent), transparent);
            border-bottom: 2px solid var(--primary-color);
            border-top-left-radius: var(--radius-lg);
            border-top-right-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            letter-spacing: -0.02em;
        }

        .report-group h4 i {
            flex-shrink: 0;
        }

        .report-group .input-group label {
            text-align: center;
            font-weight: 700;
            font-size: 1rem;
            color: var(--primary-color);
            margin-bottom: 0.75rem;
        }

        #maxControlDays {
            width: 80px !important;
            margin: 0 auto;
            display: block;
            text-align: center;
            font-size: 1.5rem !important;
            font-weight: 700 !important;
            color: var(--primary-color) !important;
            padding: 0.75rem 0.5rem !important;
            border: 2px solid var(--primary-color) !important;
            border-radius: var(--radius-md) !important;
            background: linear-gradient(135deg, var(--primary-color-translucent), transparent) !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
        }

        #maxControlDays:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 0 20px var(--input-focus-ring) !important;
            border-color: var(--accent-color) !important;
        }

        #maxControlDays:focus {
            transform: scale(1.08);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2), 0 0 30px var(--input-focus-ring) !important;
            border-color: var(--accent-color) !important;
            background: linear-gradient(135deg, var(--accent-color-translucent), var(--primary-color-translucent)) !important;
            animation: numberPulse 0.6s ease-out;
        }

        @keyframes numberPulse {

            0%,
            100% {
                transform: scale(1.08);
            }

            50% {
                transform: scale(1.12);
            }
        }

        .advanced-settings-toggle {
            background: none;
            border: 1px solid var(--input-border-color);
            color: var(--text-secondary);
            font-size: 0.9rem;
            padding: 0.5rem 1rem;
            width: 100%;
            margin-bottom: 1rem;
        }

        .advanced-settings-toggle:hover {
            background: var(--primary-color-translucent);
            color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .advanced-settings-panel {
            display: none;
            background-color: var(--primary-color-translucent);
            padding: 1rem;
            border-radius: var(--radius-md);
            margin-top: -0.5rem;
            margin-bottom: 1.25rem;
        }


        .app-footer {
            text-align: center;
            margin-top: 4rem;
            padding: 2rem 1rem;
            border-top: 1px solid var(--border-color);
            font-size: 16px;
            color: var(--text-primary);
        }

        .app-footer p {
            margin: 0.25rem 0;
            line-height: 1.4;
        }

        .app-footer p:last-of-type {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .toggle-animation-btn {
            cursor: pointer;
            opacity: 0.7;
            transition: var(--transition);
        }

        .toggle-animation-btn:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .autocomplete-items {
            position: absolute;
            border: 1px solid var(--border-color);
            z-index: 10002 !important;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 200px;
            overflow-y: auto;
            background-color: var(--card-bg);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            margin-top: 4px;
            backdrop-filter: blur(10px);
        }

        .autocomplete-item {
            padding: 10px 12px;
            cursor: pointer;
            border-bottom: 1px solid var(--border-color);
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .autocomplete-item:hover {
            background-color: var(--primary-color-translucent);
            color: var(--primary-color);
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .error-highlight {
            border: 1px solid #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.25) !important;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {

            10%,
            90% {
                transform: translate3d(-1px, 0, 0);
            }

            20%,
            80% {
                transform: translate3d(2px, 0, 0);
            }

            30%,
            50%,
            70% {
                transform: translate3d(-4px, 0, 0);
            }

            40%,
            60% {
                transform: translate3d(4px, 0, 0);
            }
        }

        .toast-notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10000;
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(8px);
            color: white;
            padding: 12px 20px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: toastIn 0.5s cubic-bezier(0.215, 0.610, 0.355, 1) forwards;
        }

        @keyframes toastIn {
            from {
                opacity: 0;
                transform: translate(-50%, 20px);
            }

            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        @keyframes toastOut {
            from {
                opacity: 1;
                transform: translate(-50%, 0);
            }

            to {
                opacity: 0;
                transform: translate(-50%, 20px);
            }
        }

        .wizard-step,
        .wizard-header,
        .wizard-content {
            display: none;
        }

        /* --- YENƒ∞ EKLENEN STƒ∞LLER: G√úN Y√ñNETƒ∞Mƒ∞ MODALI --- */
        .day-manager-modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(8px);
            z-index: 10002;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }

        .day-manager-modal {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            width: 90%;
            max-width: 550px;
            display: flex;
            flex-direction: column;
            animation: fadeInUp 0.4s 0.1s ease-out backwards;
        }

        .day-manager-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .day-manager-header h3 {
            margin: 0;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--text-primary);
        }

        .day-manager-header p {
            margin: 0.25rem 0 0 0;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .day-manager-body {
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .day-manager-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .day-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: var(--bg-start);
            transition: all 0.2s ease-out;
        }

        body.theme-night .day-list-item,
        body.theme-graphite .day-list-item {
            background: #0f172a;
        }

        .day-list-item.excluded {
            background-color: var(--primary-color-translucent);
            border-color: var(--primary-color);
        }

        .day-info {
            font-weight: 500;
        }

        .day-info .day-of-week {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-left: 0.5rem;
        }

        .day-list-item.excluded .day-info .day-of-week {
            color: var(--primary-color);
        }

        .day-list-item .status-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--accent-color);
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.3s ease-out;
        }

        .day-list-item.excluded .status-label {
            opacity: 1;
            transform: translateX(0);
        }

        .toggle-switch-small {
            width: 44px;
            height: 24px;
            border-radius: 12px;
        }

        .toggle-switch-small .toggle-handle {
            width: 20px;
            height: 20px;
        }

        .toggle-switch-container.isleyis-active .toggle-switch-small .toggle-handle {
            transform: translateX(20px);
        }

        .day-manager-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border-color);
            text-align: right;
            background-color: var(--primary-color-translucent);
        }

        @media (max-width: 992px) {
            .travel-form-grid {
                grid-template-columns: 1fr;
            }

            .travel-form-row {
                grid-template-columns: 1fr;
            }

            .travel-form-row-2col {
                grid-template-columns: 1fr;
            }

            .month-selector-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .month-btn.all-months {
                grid-column: span 3;
            }
        }

        @media (max-width: 640px) {
            .month-selector-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .month-btn.all-months {
                grid-column: span 2;
            }

            .info-ticker {
                padding: 0.5rem 0;
            }

            .info-ticker-content {
                font-size: 0.8rem;
            }

            .quick-dark-toggle {
                bottom: 4rem;
            }
        }

        @media (max-width: 768px) {
            .decorative-title {
                font-size: 2rem;
                padding-top: 6rem;
            }

            .top-nav {
                top: 0.5rem;
                left: 0.5rem;
                right: 0.5rem;
                padding: 0.5rem 1rem;
                position: fixed;
                margin: 0;
            }

            .app-title {
                display: none;
            }

            .container {
                padding: 6rem 1rem 1rem 1rem;
            }

            .transport-entry {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .wizard-transport-item {
                grid-template-columns: 1fr;
                gap: 0.75rem;
                padding: 1rem 0.75rem;
            }
            
            .wizard-transport-skip-btn {
                font-size: 1rem;
                padding: 0.9rem 2rem;
            }

            .summary-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .profile-card {
                flex-basis: 100%;
                min-height: 110px;
            }

            .travel-form-row-2col {
                grid-template-columns: 1fr;
            }

            .date-time-fields-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .nav-right {
                gap: 0.2rem;
            }

            .profile-info {
                display: none;
            }

            .icon-btn {
                padding: 0.4rem;
            }

            .month-selector-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
/* --- Modern Geri Al (Undo) Bildirim Kutusu --- */
.undo-notification {
    position: fixed;
    bottom: 30px;
    right: 30px;
    transform: translateX(400px) scale(0.9);
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.98), rgba(51, 65, 85, 0.98));
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    color: white;
    padding: 18px 24px;
    border-radius: 16px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 99999;
    opacity: 0;
    transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    border: 1px solid rgba(255, 255, 255, 0.15);
    font-size: 14px;
    font-weight: 600;
    pointer-events: auto;
    min-width: 320px;
    max-width: 400px;
}

.undo-notification.show {
    transform: translateX(0) scale(1);
    opacity: 1;
}

.undo-notification.hiding {
    transform: translateX(400px) scale(0.9);
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.4, 0, 1, 1);
}

/* Hover'da kalƒ±cƒ± olsun */
.undo-notification:hover {
    transform: translateX(0) scale(1.02);
    box-shadow: 0 24px 60px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.2);
}

.undo-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.undo-title {
    font-size: 15px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 8px;
    color: #fff;
}

.undo-message {
    font-size: 13px;
    font-weight: 500;
    color: rgba(255, 255, 255, 0.7);
}

.undo-btn {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-color-dark));
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 12px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 700;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    white-space: nowrap;
    flex-shrink: 0;
}

.undo-btn:hover {
    transform: scale(1.05) translateY(-2px);
    background: linear-gradient(135deg, var(--primary-color-light), var(--primary-color));
    box-shadow: 0 6px 20px rgba(0,0,0,0.4);
}

.undo-btn:active {
    transform: scale(0.98);
}

/* Modern Progress Bar - ƒ∞nce ve zarif */
.undo-timer-line {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 0 0 16px 16px;
    overflow: hidden;
}

.undo-timer-progress {
    height: 100%;
    background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
    width: 100%;
    transition: width 8s linear;
    box-shadow: 0 0 10px var(--accent-color);
}

/* Kopyala Butonu - Kapalƒ± Kartta G√∂r√ºn√ºr */
.copy-task-btn {
    background: linear-gradient(135deg, var(--accent-color), var(--accent-color-dark));
    color: white;
    border: none;
    padding: 0.65rem 1.1rem;
    border-radius: var(--radius-md);
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 600;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    opacity: 0;
    transform: scale(0.7) translateX(-20px) rotate(-5deg);
    pointer-events: none;
    position: relative;
    overflow: hidden;
}

.copy-task-btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.copy-task-btn:hover::before {
    width: 300%;
    height: 300%;
}

.travel-card.is-collapsed:hover .copy-task-btn {
    opacity: 1;
    transform: scale(1) translateX(0) rotate(0);
    pointer-events: auto;
    animation: copyBtnBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes copyBtnBounce {
    0% {
        transform: scale(0.7) translateX(-20px) rotate(-5deg);
        opacity: 0;
    }
    50% {
        transform: scale(1.1) translateX(5px) rotate(2deg);
    }
    100% {
        transform: scale(1) translateX(0) rotate(0);
        opacity: 1;
    }
}

.copy-task-btn:hover {
    transform: scale(1.08) translateY(-3px) rotate(2deg);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    filter: brightness(1.15);
}

.copy-task-btn:active {
    transform: scale(0.95) translateY(0);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.copy-task-btn i {
    width: 16px;
    height: 16px;
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.copy-task-btn:hover i {
    transform: scale(1.2) rotate(10deg);
}

/* ==================== YENƒ∞ WIZARD MODAL STƒ∞LLERƒ∞ ==================== */
.travel-wizard-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    z-index: 100000;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    opacity: 0;
    animation: fadeIn 0.6s ease-out forwards;
}

@keyframes fadeIn {
    to { opacity: 1; }
}

.travel-wizard-modal {
    background: #ffffff;
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border-radius: 0;
    box-shadow: 0 32px 80px rgba(0, 0, 0, 0.35);
    border: none;
    width: 100vw;
    height: 100vh;
    max-width: 100vw;
    max-height: 100vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transform: scale(0.88) translateY(40px);
    animation: modalSlideIn 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

@keyframes modalSlideIn {
    to {
        transform: scale(1) translateY(0);
    }
}

.wizard-header {
    padding: 3rem 4.5rem 2.5rem;
    border-bottom: 3px solid var(--border-color);
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    position: relative;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
}

.wizard-title {
    font-size: 3rem;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin: 0 0 1rem 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1.2rem;
    animation: titleFloat 3.5s ease-in-out infinite;
    letter-spacing: -0.5px;
}

@keyframes titleFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
}

.wizard-subtitle {
    font-size: 1.2rem;
    color: var(--text-secondary);
    margin: 0;
    text-align: center;
    font-weight: 600;
    letter-spacing: 0.2px;
}

.wizard-progress {
    display: flex;
    align-items: center;
    gap: 0.9rem;
    margin-top: 2.5rem;
}

.wizard-progress-step {
    flex: 1;
    height: 12px;
    background: linear-gradient(135deg, #e2e8f0, #cbd5e1);
    border-radius: 16px;
    overflow: hidden;
    position: relative;
    transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
}

.wizard-progress-step.active {
    background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
    box-shadow: 0 0 30px var(--primary-color), 0 3px 14px rgba(0, 0, 0, 0.25);
    animation: progressPulse 3s ease-in-out infinite;
    position: relative;
    overflow: hidden;
    transform: scaleY(1.6);
}

.wizard-progress-step.active::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.7), transparent);
    animation: progressShine 2.5s ease-in-out infinite;
}

@keyframes progressPulse {
    0%, 100% {
        box-shadow: 0 0 24px var(--primary-color);
        transform: scaleY(1.4);
    }
    50% {
        box-shadow: 0 0 40px var(--primary-color), 0 0 56px var(--accent-color);
        transform: scaleY(1.8);
    }
}

@keyframes progressShine {
    0% { left: -100%; }
    100% { left: 200%; }
}

/* Confetti Celebration Effect */
.wizard-confetti {
    position: fixed;
    width: 10px;
    height: 10px;
    background: var(--primary-color);
    position: absolute;
    animation: confettiFall 3s ease-out forwards;
    z-index: 100001;
}

@keyframes confettiFall {
    0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
    }
}

/* Success Celebration */
.wizard-success-burst {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: radial-gradient(circle, var(--accent-color), transparent);
    transform: translate(-50%, -50%) scale(0);
    animation: successBurst 0.6s ease-out;
    pointer-events: none;
}

@keyframes successBurst {
    0% {
        transform: translate(-50%, -50%) scale(0);
        opacity: 1;
    }
    100% {
        transform: translate(-50%, -50%) scale(3);
        opacity: 0;
    }
}

.wizard-body {
    padding: 2rem 3rem;
    overflow-y: hidden;
    flex: 1;
    background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
    display: flex;
    align-items: center;
    justify-content: center;
}

.wizard-step {
    display: none !important;
    animation: stepFadeIn 0.6s ease-out;
    width: 100%;
    max-width: 1400px;
    height: 100%;
    flex-direction: column;
    justify-content: center;
    align-items: stretch;
    padding: 1rem 2rem;
}

.wizard-step.active {
    display: flex !important;
}

@keyframes stepFadeIn {
    from {
        opacity: 0;
        transform: translateX(30px) scale(0.98);
    }
    to {
        opacity: 1;
        transform: translateX(0) scale(1);
    }
}

.wizard-step.active {
    animation: stepFadeIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.wizard-step-title {
    font-size: 3rem;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin: 0 0 1.5rem 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1.5rem;
    animation: stepTitlePulse 2s ease-in-out infinite;
}

@keyframes stepTitlePulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.03); }
}

.wizard-step-description {
    font-size: 1.6rem;
    color: var(--text-secondary);
    margin: 0 0 4rem 0;
    text-align: center;
    font-weight: 500;
    opacity: 0.9;
    line-height: 1.6;
}

.wizard-option-grid {
    display: flex;
    gap: 3rem;
    max-width: 1200px;
    width: 100%;
    margin: 0 auto;
    justify-content: center;
}

.wizard-option-card {
    background: linear-gradient(135deg, 
        hsla(var(--primary-hue), 60%, 98%, 0.95), 
        hsla(var(--secondary-hue), 60%, 98%, 0.9));
    border: 5px solid var(--border-color);
    border-radius: 32px;
    padding: 3.5rem 5.5rem;
    cursor: pointer;
    transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    text-align: center;
    position: relative;
    overflow: hidden;
    min-width: 450px;
    min-height: 320px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    flex: 1;
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.08);
}

.wizard-option-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, 
        hsla(var(--primary-hue), 70%, 90%, 0.6), 
        hsla(var(--secondary-hue), 70%, 90%, 0.4));
    opacity: 0;
    transition: opacity 0.4s ease;
}

.wizard-option-card:hover {
    border-color: var(--primary-color);
    transform: translateY(-12px) scale(1.04);
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.15),
        0 0 0 5px var(--input-focus-ring);
}

.wizard-option-card:hover::before {
    opacity: 1;
}

.wizard-option-card.selected {
    border-color: var(--primary-color);
    background: linear-gradient(135deg, 
        hsla(var(--primary-hue), 70%, 92%, 1), 
        hsla(var(--secondary-hue), 70%, 92%, 1));
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
    transform: scale(1.05);
    animation: cardSelected 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes cardSelected {
    0% { transform: scale(1); }
    50% { transform: scale(1.1) rotate(2deg); }
    100% { transform: scale(1.05); }
}

.wizard-option-card.selected::after {
    content: '‚úì';
    position: absolute;
    top: 1rem;
    right: 1rem;
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.2rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    animation: checkmarkPop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes checkmarkPop {
    0% {
        transform: scale(0) rotate(-180deg);
    }
    100% {
        transform: scale(1) rotate(0);
    }
}

.wizard-option-icon {
    font-size: 9rem;
    margin-bottom: 2.5rem;
    position: relative;
    z-index: 1;
    animation: iconBounce 2s ease-in-out infinite;
    filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.15));
}

@keyframes iconBounce {
    0%, 100% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-12px) scale(1.1); }
}

.wizard-option-card:hover .wizard-option-icon {
    animation: iconSpin 0.6s ease-in-out;
}

@keyframes iconSpin {
    0% { transform: rotate(0deg) scale(1); }
    50% { transform: rotate(10deg) scale(1.25); }
    100% { transform: rotate(0deg) scale(1); }
}

.wizard-option-title {
    font-size: 2.4rem;
    font-weight: 800;
    color: var(--text-primary);
    margin: 0 0 1.2rem 0;
    position: relative;
    z-index: 1;
    letter-spacing: -0.3px;
}

.wizard-option-desc {
    font-size: 1.2rem;
    color: var(--text-secondary);
    margin: 0;
    position: relative;
    z-index: 1;
    font-weight: 500;
    line-height: 1.6;
}

.wizard-input-group {
    margin-bottom: 1.5rem;
}

.wizard-input-group label {
    display: flex;
    align-items: center;
    gap: 1.2rem;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 1.6rem;
    font-size: 1.8rem;
    justify-content: center;
    text-align: center;
    min-height: 40px;
    letter-spacing: -0.3px;
}

.wizard-input-group label i {
    color: var(--primary-color);
    filter: drop-shadow(0 3px 8px rgba(0, 0, 0, 0.15));
    width: 32px;
    height: 32px;
    flex-shrink: 0;
}

/* Wizard Date Grid - Tarih alanlarƒ± yan yana */
.wizard-date-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3.5rem;
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 2.5rem;
}

/* G√ºn√ºbirlik g√∂revde tek kolon */
.wizard-date-grid:has(.wizard-end-date-group[style*="display: none"]) {
    grid-template-columns: 1fr;
    max-width: 650px;
}

.wizard-date-grid .wizard-input-group {
    margin-bottom: 0;
    min-width: 0;
    display: flex;
    flex-direction: column;
}

.wizard-date-grid .wizard-input-group label {
    width: 100%;
    font-size: 1.5rem;
    margin-bottom: 1.4rem;
    font-weight: 800;
}

.wizard-date-grid input[type="date"] {
    width: 100%;
    min-width: 0;
}

/* Wizard Duration Grid - S√ºre alanlarƒ± yan yana */
.wizard-duration-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3.5rem;
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 2.5rem;
}

.wizard-duration-grid .wizard-input-group {
    margin-bottom: 0;
    min-width: 0;
    display: flex;
    flex-direction: column;
}

.wizard-duration-grid .wizard-input-group label {
    width: 100%;
    font-size: 1.5rem;
    margin-bottom: 1.4rem;
    font-weight: 800;
}

.wizard-duration-grid input[type="number"] {
    width: 100%;
    min-width: 0;
}

/* Responsive - Mobilde alt alta */
@media (max-width: 768px) {
    .wizard-date-grid,
    .wizard-duration-grid {
        grid-template-columns: 1fr;
        gap: 2.5rem;
        padding: 0 1.5rem;
    }
    
    .wizard-step-title {
        font-size: 2.8rem !important;
        gap: 1.4rem !important;
    }
    
    .wizard-step-description {
        font-size: 1.4rem !important;
    }
    
    .wizard-option-card {
        min-width: 320px !important;
        min-height: 260px !important;
        padding: 3rem 4.5rem !important;
    }
    
    .wizard-option-icon {
        font-size: 5rem !important;
    }
    
    .wizard-option-title {
        font-size: 1.7rem !important;
    }
    
    .wizard-input-group input[type="date"],
    .wizard-input-group input[type="time"],
    .wizard-input-group input[type="number"] {
        font-size: 1.7rem !important;
        padding: 1.6rem 1.8rem !important;
        min-height: 70px;
    }
}

.wizard-input-group input,
.wizard-input-group select,
.wizard-input-group textarea {
    width: 100%;
    padding: 1.5rem 1.9rem;
    border: 4px solid #e2e8f0;
    border-radius: 20px;
    font-size: 1.4rem;
    font-weight: 600;
    transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    color: var(--text-primary);
    position: relative;
    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.08);
}

.wizard-input-group input:hover,
.wizard-input-group select:hover,
.wizard-input-group textarea:hover {
    border-color: var(--primary-color-light);
    transform: translateY(-3px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.14);
}

.wizard-input-group input:focus,
.wizard-input-group select:focus,
.wizard-input-group textarea:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 8px var(--input-focus-ring), 
                0 12px 32px rgba(0, 0, 0, 0.18);
    transform: translateY(-5px) scale(1.02);
    background: white;
}

.wizard-input-group input:not(:placeholder-shown),
.wizard-input-group select:not([value=""]) {
    animation: inputSuccess 0.7s cubic-bezier(0.16, 1, 0.3, 1);
    border-color: var(--accent-color);
}

@keyframes inputSuccess {
    0% { transform: scale(1); }
    50% { transform: scale(1.06); box-shadow: 0 0 28px var(--accent-color); }
    100% { transform: scale(1); }
}

/* Tarih inputlarƒ± i√ßin √∂zel stil - Modern ve ≈ûƒ±k */
.wizard-input-group input[type="date"],
.wizard-input-group input[type="time"],
.wizard-input-group input[type="number"] {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif !important;
    font-size: 2.5rem !important;
    font-weight: 700 !important;
    padding: 2rem 2.5rem !important;
    letter-spacing: 0.3px !important;
    border-radius: 22px !important;
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
    box-shadow: 
        0 8px 20px rgba(0, 0, 0, 0.12),
        0 4px 12px rgba(0, 0, 0, 0.08),
        inset 0 2px 4px rgba(255, 255, 255, 0.95) !important;
    border: 5px solid var(--primary-color) !important;
    transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1) !important;
    text-align: center;
    color: var(--primary-color) !important;
    cursor: pointer;
    min-height: 100px;
}

.wizard-input-group input[type="date"]:focus,
.wizard-input-group input[type="time"]:focus,
.wizard-input-group input[type="number"]:focus {
    outline: none !important;
    border-color: var(--primary-color) !important;
    box-shadow: 
        0 0 0 8px var(--input-focus-ring),
        0 16px 40px rgba(0, 0, 0, 0.22),
        inset 0 4px 8px rgba(255, 255, 255, 1) !important;
    transform: translateY(-8px) scale(1.05) !important;
    background: #ffffff !important;
}

.wizard-input-group input[type="date"]:hover,
.wizard-input-group input[type="time"]:hover,
.wizard-input-group input[type="number"]:hover {
    border-color: var(--primary-color);
    box-shadow: 
        0 12px 28px rgba(0, 0, 0, 0.16),
        0 6px 14px rgba(0, 0, 0, 0.12),
        0 0 0 4px var(--input-focus-ring),
        inset 0 2px 4px rgba(255, 255, 255, 1);
    transform: translateY(-5px) scale(1.02);
}

/* Deƒüer girildiƒüinde √∂zel animasyon */
.wizard-input-group input[type="date"]:valid,
.wizard-input-group input[type="time"]:valid,
.wizard-input-group input[type="number"]:valid {
    background: linear-gradient(135deg, 
        hsla(var(--primary-hue), 70%, 95%, 1), 
        hsla(var(--secondary-hue), 70%, 95%, 1)) !important;
    border-color: var(--accent-color) !important;
    color: var(--primary-color) !important;
    box-shadow: 
        0 8px 20px rgba(0, 0, 0, 0.12),
        0 0 0 5px var(--input-focus-ring),
        inset 0 2px 4px rgba(255, 255, 255, 1) !important;
    animation: inputValueGlow 3s ease-in-out infinite;
}

@keyframes inputValueGlow {
    0%, 100% {
        box-shadow: 
            0 8px 20px rgba(0, 0, 0, 0.12),
            0 0 0 5px var(--input-focus-ring),
            inset 0 2px 4px rgba(255, 255, 255, 1);
    }
    50% {
        box-shadow: 
            0 12px 32px rgba(0, 0, 0, 0.18),
            0 0 0 8px var(--input-focus-ring),
            inset 0 4px 8px rgba(255, 255, 255, 1);
    }
}

.wizard-input-group input[type="date"]::-webkit-calendar-picker-indicator,
.wizard-input-group input[type="time"]::-webkit-calendar-picker-indicator {
    cursor: pointer;
    font-size: 3.5rem;
    width: 64px;
    height: 64px;
    padding: 0.7rem;
    border-radius: 16px;
    transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    opacity: 0.75;
}

.wizard-input-group input[type="date"]::-webkit-calendar-picker-indicator:hover,
.wizard-input-group input[type="time"]::-webkit-calendar-picker-indicator:hover {
    opacity: 1;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    border-radius: 18px;
    transform: scale(1.35) rotate(-8deg);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
}

/* √ñzel Tarih/Saat Se√ßici Paneli */
.custom-picker-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(8px);
    z-index: 100002;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease-out;
}

.custom-picker-panel {
    background: #ffffff;
    border-radius: 20px;
    padding: 2rem;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
    border: 1px solid #e2e8f0;
    min-width: 500px;
    max-width: 90vw;
    max-height: 80vh;
    overflow-y: auto;
    animation: pickerSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes pickerSlideIn {
    from {
        opacity: 0;
        transform: scale(0.8) translateY(30px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.custom-picker-title {
    font-size: 1.5rem;
    font-weight: 800;
    text-align: center;
    margin-bottom: 1.5rem;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.custom-picker-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
    gap: 0.75rem;
    max-height: 450px;
    overflow-y: auto;
    padding: 0.5rem;
}

.custom-picker-item {
    padding: 1rem;
    border-radius: 12px;
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
    font-size: 1.1rem;
    font-weight: 600;
    color: #334155;
}

.custom-picker-item:hover {
    background: #f1f5f9;
    border-color: var(--primary-color);
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.custom-picker-item.selected {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    border-color: var(--primary-color);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.custom-picker-close {
    margin-top: 1.5rem;
    width: 100%;
    padding: 0.875rem;
    border-radius: 12px;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    border: none;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.custom-picker-close:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.wizard-input-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    max-width: 800px;
    margin: 0 auto;
}

.wizard-footer {
    padding: 3rem 5.5rem;
    border-top: 3px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
    box-shadow: 0 -8px 24px rgba(0, 0, 0, 0.1);
}

.wizard-btn {
    padding: 1.6rem 4rem;
    border: none;
    border-radius: 20px;
    font-size: 1.4rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    display: flex;
    align-items: center;
    gap: 1rem;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    letter-spacing: 0.3px;
}

.wizard-btn-secondary {
    background: transparent;
    color: var(--text-secondary);
    border: 4px solid var(--border-color);
    box-shadow: none;
}

.wizard-btn-secondary:hover {
    background: var(--primary-color-translucent);
    border-color: var(--primary-color);
    color: var(--primary-color);
    transform: translateY(-4px) scale(1.08);
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.18);
}

.wizard-btn-primary {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    box-shadow: 0 12px 36px rgba(0, 0, 0, 0.3);
    position: relative;
    overflow: hidden;
    font-size: 1.4rem;
    padding: 1.6rem 4rem;
}

.wizard-btn-primary::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.4);
    transform: translate(-50%, -50%);
    transition: width 0.8s, height 0.8s;
}

.wizard-btn-primary:hover::before {
    width: 400px;
    height: 400px;
}

.wizard-btn-primary:hover {
    transform: translateY(-6px) scale(1.12);
    box-shadow: 0 20px 56px rgba(0, 0, 0, 0.4);
}

.wizard-btn-primary:active {
    transform: translateY(-2px) scale(1.04);
}

.wizard-btn-primary:not(:disabled) {
    animation: buttonPulse 2.5s ease-in-out infinite;
}

@keyframes buttonPulse {
    0%, 100% {
        box-shadow: 0 10px 28px rgba(0, 0, 0, 0.3);
    }
    50% {
        box-shadow: 0 16px 44px rgba(0, 0, 0, 0.4);
    }
}

.wizard-btn-primary:active,
.wizard-btn-secondary:active {
    transform: translateY(0);
}

.wizard-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    transform: none !important;
    animation: none !important;
}

.wizard-close-btn {
    position: absolute;
    top: 2.5rem;
    right: 2.5rem;
    width: 70px;
    height: 70px;
    border: 4px solid var(--border-color);
    background: linear-gradient(135deg, #ffffff, #f8fafc);
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    color: #64748b;
    z-index: 10000;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    font-size: 3.2rem;
    font-weight: 300;
    line-height: 1;
    padding: 0;
}

.wizard-close-btn:hover {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    border-color: #ef4444;
    color: white;
    transform: rotate(90deg) scale(1.3);
    box-shadow: 0 16px 44px rgba(239, 68, 68, 0.6);
}

/* Transport section in wizard - Simple & Clean Design */
.wizard-transport-section {
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px dashed var(--border-color);
    width: 100%;
    max-width: 100%;
}

/* Wizard Transport Skip Button Container */
.wizard-transport-skip-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 2rem 0 3rem 0;
}

.wizard-transport-skip-btn {
    background: linear-gradient(135deg, var(--primary-color-translucent), rgba(255, 255, 255, 0.5));
    border: 2px dashed var(--primary-color);
    color: var(--primary-color);
    font-size: 1.1rem;
    font-weight: 600;
    padding: 1rem 2.5rem;
    border-radius: 16px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.wizard-transport-skip-btn:hover {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    border-color: var(--primary-color);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

.wizard-transport-skip-btn i {
    width: 20px;
    height: 20px;
}

/* Wizard Transport List */
.wizard-transport-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-bottom: 1.5rem;
    width: 100%;
    max-width: 100%;
}

.wizard-transport-item {
    display: grid;
    grid-template-columns: 1.5fr 3fr 1.5fr 1.5fr auto;
    gap: 0.75rem;
    align-items: center;
    padding: 1rem;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.9));
    border: 1px solid var(--border-color);
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    transition: all 0.3s ease;
}

.wizard-transport-item:hover {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    transform: translateY(-2px);
}

.wizard-transport-item input,
.wizard-transport-item select {
    width: 100%;
    height: 44px;
    padding: 0.65rem 0.9rem;
    font-size: 0.95rem;
    border: 1.5px solid var(--input-border-color);
    border-radius: 10px;
    background: white;
    transition: all 0.2s ease;
    box-sizing: border-box;
}

.wizard-transport-item input:focus,
.wizard-transport-item select:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px var(--input-focus-ring);
}

.wizard-transport-item input:hover,
.wizard-transport-item select:hover {
    border-color: var(--primary-color-light);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

.wizard-transport-item button {
    width: 36px;
    height: 36px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    background: rgba(239, 68, 68, 0.1);
    border: none;
    cursor: pointer;
    transition: all 0.2s ease;
}

.wizard-transport-item button:hover {
    background: #ef4444;
    color: white;
    transform: scale(1.1);
}



/* Modern Transport Type Selector */
.transport-type-selector {
    margin-bottom: 1.5rem;
}

.transport-type-label {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 1rem;
}

.transport-type-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 1rem;
}

@media (max-width: 1200px) {
    .transport-type-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

.transport-type-option {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    border: 2px solid #e2e8f0;
    border-radius: 16px;
    padding: 1.75rem 1rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    text-align: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.transport-type-option:hover {
    background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);
    border-color: var(--primary-color);
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
}

.transport-type-option.selected {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    border-color: var(--primary-color);
    color: white;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
    transform: scale(1.05);
}

.transport-icon {
    font-size: 3rem;
    margin-bottom: 0.75rem;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
}

.transport-name {
    font-size: 1rem;
    font-weight: 700;
    letter-spacing: 0.3px;
}

.transport-type-option.selected .transport-name {
    color: white;
}

/* .transport-details {
    padding-top: 1rem;
    border-top: 2px dashed #e2e8f0;
    margin-top: 1rem;
}

.transport-details > div {
    display: grid;
    grid-template-columns: 1fr 2fr 1fr;
    gap: 1rem;
}

.transport-details .wizard-input-group {
    margin-bottom: 0;
} */

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.wizard-add-transport-btn {
    width: 100%;
    padding: 1.1rem 1.5rem;
    border: 2px dashed var(--primary-color);
    background: linear-gradient(135deg, var(--primary-color-translucent), rgba(255, 255, 255, 0.3));
    color: var(--primary-color);
    font-weight: 600;
    font-size: 1rem;
    margin-top: 1rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.7rem;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.wizard-add-transport-btn:hover {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    border-color: var(--primary-color);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
}

.wizard-add-transport-btn i {
    width: 20px;
    height: 20px;
}

/* Dark Theme Support for Transport Items */
body.theme-night .wizard-transport-item,
body.theme-graphite .wizard-transport-item {
    background: linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.9));
    border-color: var(--border-color);
}

body.theme-night .wizard-transport-item input,
body.theme-night .wizard-transport-item select,
body.theme-graphite .wizard-transport-item input,
body.theme-graphite .wizard-transport-item select {
    background: rgba(15, 23, 42, 0.8);
    border-color: var(--input-border-color);
    color: var(--text-primary);
}

body.theme-night .wizard-transport-skip-btn,
body.theme-graphite .wizard-transport-skip-btn {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(30, 41, 59, 0.5));
}

/* Historic Theme Support */
body.theme-historic .wizard-transport-item {
    background: linear-gradient(135deg, rgba(253, 246, 227, 0.9), rgba(250, 243, 224, 0.9));
}

body.theme-historic .wizard-transport-item input,
body.theme-historic .wizard-transport-item select {
    background: #fdf6e3;
    border-color: var(--input-border-color);
}

body.theme-historic .wizard-transport-skip-btn {
    background: linear-gradient(135deg, rgba(140, 111, 98, 0.15), rgba(245, 235, 214, 0.5));
}

/* Wizard Type Toggle Buttons */
.wizard-type-toggle {
    padding: 0.75rem 1.5rem;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    font-weight: 600;
    font-size: 0.95rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.wizard-type-toggle:hover {
    background: var(--primary-color-translucent);
    color: var(--primary-color);
}

.wizard-type-toggle.active {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Wizard i√ßindeki autocomplete i√ßin √∂zel stil */
.wizard-input-group .autocomplete-items {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    z-index: 100001;
    background: var(--card-bg);
    border: 2px solid var(--primary-color);
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    max-height: 200px;
    overflow-y: auto;
    margin-top: 0.5rem;
}

.wizard-input-group .autocomplete-items div {
    padding: 0.75rem 1rem;
    cursor: pointer;
    transition: all 0.2s ease;
    border-bottom: 1px solid var(--border-color);
}

.wizard-input-group .autocomplete-items div:last-child {
    border-bottom: none;
}

.wizard-input-group .autocomplete-items div:hover {
    background: var(--primary-color-translucent);
    color: var(--primary-color);
}

/* Responsive */
@media (max-width: 768px) {
    .wizard-option-grid {
        grid-template-columns: 1fr;
    }
    
    .wizard-input-row {
        grid-template-columns: 1fr;
    }
    
    .wizard-transport-item {
        grid-template-columns: 1fr;
        gap: 0.5rem;
    }
    
    .travel-wizard-modal {
        max-width: 100%;
        margin: 1rem;
    }
    
    .wizard-body {
        padding: 1.5rem;
    }
    
    .wizard-header {
        padding: 1.5rem;
    }
}

/* --- YENƒ∞ SEYAHAT EKLE BUTONU √ñZEL TASARIMI --- */
button.add-btn {
    padding: 1.2rem 3rem !important;
    font-size: 1.15rem !important;
    font-weight: 800 !important;
    border-radius: 50px !important;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    background-image: linear-gradient(45deg, var(--accent-color), #f59e0b, var(--primary-color), var(--accent-color)) !important;
    background-size: 300% 300%;
    border: 2px solid rgba(255,255,255,0.3) !important;
    color: white !important;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2) !important;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    animation: gradientFlow 4s ease infinite, softPulse 2s infinite;
    position: relative;
    overflow: hidden;
    z-index: 1;
}

button.add-btn i {
    width: 24px !important;
    height: 24px !important;
    margin-right: 10px !important;
    transition: transform 0.5s ease !important;
}

button.add-btn:hover {
    transform: translateY(-6px) scale(1.05) !important;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3), 0 0 30px var(--accent-color) !important;
    background-position: 100% 50% !important;
}

button.add-btn:hover i {
    transform: rotate(180deg) scale(1.3);
}

button.add-btn:active {
    transform: translateY(-2px) scale(0.98) !important;
}

@keyframes gradientFlow {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes softPulse {
    0% { box-shadow: 0 0 0 0 rgba(var(--primary-color), 0.4); }
    70% { box-shadow: 0 0 0 15px rgba(255, 255, 255, 0); }
    100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
}

/* --- Sƒ∞Hƒ∞RBAZ ALT KISIM (FOOTER) TEMƒ∞ZLƒ∞ƒûƒ∞ --- */
.wizard-footer {
    background: transparent !important;  /* Arka plan rengini sil */
    box-shadow: none !important;         /* G√∂lgeyi kaldƒ±r */
    border-top: none !important;         /* √ústteki √ßizgiyi kaldƒ±r */
    padding-top: 1rem !important;        /* Bo≈üluƒüu biraz azalt */
}

/* --- ARKA PLAN RENK FARKI D√úZELTMESƒ∞ --- */

/* ƒ∞√ßerik kƒ±smƒ±nƒ±n kendi rengini siliyoruz */
.wizard-body {
    background: transparent !important; 
}

/* Rengi ana pencerenin tamamƒ±na veriyoruz (B√∂ylece kesinti olmaz) */
.travel-wizard-modal {
    background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%) !important;
}

/* --- BUTONLARI ORTALAMA VE GRUPLAMA --- */

.wizard-footer {
    justify-content: center !important; /* Hepsini merkeze √ßek */
    gap: 20px !important;               /* Butonlar arasƒ±na ≈üƒ±k bir bo≈üluk koy */
}

/* Aradaki bo≈üluƒüu yaratan g√∂r√ºnmez kutuyu yok et */
.wizard-footer > div {
    display: none !important;
}

/* Butonlarƒ±n geni≈üliklerini e≈üitleyip daha d√ºzenli durmasƒ±nƒ± saƒüla */
.wizard-footer button {
    min-width: 140px !important; /* Hepsi en az bu geni≈ülikte olsun */
}

/* --- MODERN "PANEL" SEKME TASARIMI (BOYDAN BOYA & ≈ûIK) --- */

.tab-nav {
    display: flex !important;
    width: 100% !important;
    
    /* DEƒûƒ∞≈ûTƒ∞RDƒ∞ƒûƒ∞Mƒ∞Z KISIM: Her ≈üeyi temizledik */
    background: transparent !important;
    backdrop-filter: none !important;
    border: none !important;
    box-shadow: none !important;
    border-radius: 0 !important;
    
    padding: 6px !important;
    gap: 8px !important;
    margin-bottom: 2rem !important;
}

.tab-btn {
    flex: 1 !important; /* Hepsi e≈üit yayƒ±lsƒ±n */
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    
    /* Tƒ∞POGRAFƒ∞ */
    font-family: 'Inter', sans-serif !important;
    font-weight: 600 !important;
    font-size: 1rem !important;
    
    /* G√ñR√úN√úM */
    background: transparent !important;
    border: none !important;
    border-radius: 12px !important; /* ƒ∞√ß buton k√∂≈üeleri */
    padding: 1rem !important;
    color: var(--text-secondary) !important;
    
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1) !important;
    position: relative !important;
}

/* Eski √ßizgileri temizle */
.tab-btn::after { display: none !important; }

/* HOVER (√úzerine Gelince) */
.tab-btn:hover {
    background: rgba(255, 255, 255, 0.5) !important;
    color: var(--primary-color) !important;
}

/* ACTIVE (Se√ßili Olan) - EN √ñNEMLƒ∞ KISIM */
.tab-btn.active {
    /* Canlƒ± ve Dolgun Renk */
    background: var(--primary-color) !important;
    /* Hafif degrade vererek derinlik katalƒ±m */
    background-image: linear-gradient(135deg, var(--primary-color), var(--primary-color-dark)) !important;
    
    color: #ffffff !important; /* Beyaz yazƒ± */
    font-weight: 700 !important;
    
    /* ≈ûƒ±k G√∂lge (Shadow) */
    box-shadow: 0 4px 12px var(--primary-color-translucent), 
                0 2px 4px rgba(0,0,0,0.1) !important;
    
    transform: scale(1.02); /* √áok hafif b√ºy√ºt */
}

/* ƒ∞kon Ayarƒ± */
.tab-btn i {
    margin-right: 10px !important;
    width: 20px !important;
    height: 20px !important;
    opacity: 0.8;
}

.tab-btn.active i {
    opacity: 1;
    color: white !important;
}

/* --- √áER√áEVE G√úZELLE≈ûTƒ∞RME VE E≈ûƒ∞TLEME --- */

/* 1. T√ºm kutucuklarƒ± (Yazƒ±, Sayƒ±, Tarih) aynƒ± ve ince yapƒ±yoruz */
.input-group input,
.input-group select,
.input-group textarea,
.input-group input[type="number"],
.input-group input[type="date"],
.input-group input[type="time"] {
    border: 1px solid rgba(0, 0, 0, 0.15) !important; /* √áer√ßeve: √áok ince ve hafif gri */
    background: rgba(255, 255, 255, 0.7) !important; /* Zemin: Hafif ≈üeffaf beyaz */
    box-shadow: none !important;                     /* Eski g√∂lgeleri sildik */
    border-radius: 10px !important;                  /* K√∂≈üeleri hafif yuvarladƒ±k */
    height: 42px !important;                         /* Y√ºkseklikleri e≈üitledik */
}

/* 2. Sadece √ºzerine tƒ±klayƒ±nca (yazarken) renkli olsun */
.input-group input:focus,
.input-group select:focus,
.input-group textarea:focus {
    border-color: var(--primary-color) !important;   /* Tƒ±klayƒ±nca ana rengini al */
    background: #ffffff !important;                  /* Tƒ±klayƒ±nca tam beyaz olsun */
    box-shadow: 0 0 0 3px var(--input-focus-ring) !important; /* Hafif bir parlama ekle */
    transform: none !important;                      /* Zƒ±plama efektini durdur */
}

/* 3. Fareyle √ºzerine gelince (Hover) */
.input-group input:hover,
.input-group select:hover {
    border-color: var(--primary-color) !important;   /* √áer√ßeve hafif√ße renklensin */
    background: #ffffff !important;
}

/* --- MUHTE≈ûEM BA≈ûLIK TASARIMI (Final) --- */

.decorative-title {
    text-align: center;
    margin: 4rem 0 5rem 0 !important; /* Bo≈üluklarƒ± artƒ±rdƒ±k */
    padding: 0 1rem;
    position: relative;
    z-index: 10;
    background: none !important; /* Eski arka planlarƒ± temizle */
    -webkit-text-fill-color: initial; /* Eski renkleri sƒ±fƒ±rla */
    animation: none !important; /* Eski animasyonu durdur */
}

/* √úST SATIR: Dev, G√º√ßl√º ve Parlak */
.decorative-title .main-line {
    font-family: 'Inter', sans-serif; 
    font-weight: 900;                 
    font-size: clamp(2.5rem, 5vw, 4.5rem); /* Ekrana g√∂re b√ºy√ºy√ºp k√º√ß√ºlen dev font */
    line-height: 1;
    text-transform: uppercase;        
    letter-spacing: -0.02em;          
    
    /* Temaya g√∂re deƒüi≈üen canlƒ± gradyan */
    background-image: linear-gradient(
        135deg,
        var(--primary-color-dark) 0%,
        var(--primary-color) 20%,
        var(--accent-color) 50%,     
        var(--primary-color) 80%,
        var(--primary-color-dark) 100%
    );
    background-size: 200% auto;       
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    
    /* I≈üƒ±k akƒ±≈üƒ± animasyonu */
    animation: shineFlow 4s linear infinite, fadeInUp 0.8s ease-out;
    
    /* Derinlik g√∂lgesi */
    filter: drop-shadow(0 4px 10px rgba(0,0,0,0.1));
}

/* ALT SATIR: Geni≈ü, Zarif ve Sinematik */
.decorative-title .sub-line {
    font-family: 'Playfair Display', serif; 
    font-size: clamp(0.9rem, 1.5vw, 1.4rem);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.6em; /* Harfleri iyice a√ßtƒ±k */
    margin-top: 1.2rem;
    color: var(--text-secondary);
    opacity: 0.8;
    
    /* Yan √ßizgilerle hizalama */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1.5rem;
    animation: fadeIn 1.5s ease-out;
}

/* Alt satƒ±rƒ±n yanƒ±ndaki √ßizgiler */
.decorative-title .sub-line::before,
.decorative-title .sub-line::after {
    content: '';
    height: 1px;
    width: 40px; 
    background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
}

/* Animasyonlar */
@keyframes shineFlow {
    to { background-position: 200% center; }
}

@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* --- HEYBETLƒ∞ VE MODERN SEKME (TAB) BUTONLARI --- */

.tab-btn {
    /* Yazƒ± Stili: Ba≈ülƒ±k gibi g√º√ßl√º */
    text-transform: uppercase !important;       /* HEPSƒ∞ B√úY√úK HARF */
    font-weight: 800 !important;                /* Kalƒ±n ve tok yazƒ± */
    font-family: 'Inter', sans-serif !important;
    font-size: 0.9rem !important;               /* Boyut dengeli */
    letter-spacing: 0.05em !important;          /* Harf aralƒ±ƒüƒ±nƒ± hafif a√ßtƒ±k */
    
    /* Hizalama ve Bo≈üluklar */
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 10px !important;
    padding: 1rem 1.2rem !important;
    border-radius: 12px !important;
    
    /* Renk ve Ge√ßi≈üler */
    color: var(--text-secondary) !important;
    background: transparent !important;
    border: 1px solid transparent !important;
    transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1) !important;
}

/* ƒ∞kon Ayarƒ±: Yazƒ±yla uyumlu olsun */
.tab-btn i {
    width: 20px !important;
    height: 20px !important;
    stroke-width: 2.5 !important; /* ƒ∞konlarƒ± biraz kalƒ±nla≈ütƒ±rdƒ±k */
    margin: 0 !important;         /* Gap kullandƒ±ƒüƒ±mƒ±z i√ßin margin'i sildik */
    opacity: 0.7;
    transition: all 0.3s ease;
}

/* Hover (√úzerine Gelince) */
.tab-btn:hover {
    background: var(--primary-color-translucent) !important;
    color: var(--primary-color) !important;
    transform: translateY(-2px);
    letter-spacing: 0.08em !important; /* √úzerine gelince harfler hafif√ße a√ßƒ±lsƒ±n */
}

/* AKTƒ∞F (SE√áƒ∞Lƒ∞) DURUM: Burasƒ± ba≈ülƒ±k gibi parlayacak */
.tab-btn.active {
    /* Canlƒ± Gradyan Arka Plan */
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color)) !important;
    
    color: white !important;
    border: 1px solid rgba(255,255,255,0.2) !important;
    
    /* G√∂lge ve Derinlik */
    box-shadow: 0 8px 20px -4px var(--primary-color-translucent), 
                0 0 0 1px rgba(255,255,255,0.1) inset !important;
                
    transform: translateY(-3px) scale(1.02) !important;
}

.tab-btn.active i {
    opacity: 1;
    color: white !important;
    transform: scale(1.1);
}

/* Saya√ß (Parantez i√ßindeki sayƒ±) */
#travel-counter {
    background: rgba(255,255,255,0.2);
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 0.8em;
}

/* --- Fƒ∞NAL SAYA√á: KOCAMAN, TAM ORTALI VE HAREKETLƒ∞ --- */

#travel-counter {
    /* 1. G√∂r√ºn√ºm: Temanƒ±n rengini al */
    background: var(--accent-color) !important;
    background-image: linear-gradient(135deg, var(--accent-color), var(--primary-color)) !important;
    
    color: white !important;
    
    /* 2. BOYUT AYARLARI (Daha ƒ∞ri) */
    font-size: 1.4rem !important;        /* Bayaƒüƒ± b√ºy√ºtt√ºk */
    font-weight: 900 !important;         /* Kalƒ±nlƒ±k maksimum */
    line-height: 1 !important;           /* Satƒ±r y√ºksekliƒüini sƒ±fƒ±rladƒ±k (Kaymayƒ± √∂nler) */
    
    /* 3. Hƒ∞ZALAMA (ƒ∞≈üte burasƒ± sayƒ±yƒ± tam g√∂beƒüe oturtur) */
    display: inline-flex !important;     /* Esnek kutu yaptƒ±k */
    align-items: center !important;      /* Dikeyde tam orta */
    justify-content: center !important;  /* Yatayda tam orta */
    
    /* 4. KUTU ≈ûEKLƒ∞ (Tam Yuvarlak) */
    min-width: 34px !important;          /* En az bu kadar geni≈ü olsun (tek sayƒ±da b√ºz√º≈ümesin) */
    height: 34px !important;             /* Y√ºkseklik geni≈üliƒüe e≈üit */
    border-radius: 50% !important;       /* Tam daire */
    padding: 0 6px !important;           /* ƒ∞ki basamaklƒ± olursa (12 gibi) yanlardan ta≈ümasƒ±n */
    
    /* 5. Konumlandƒ±rma */
    margin: 0 6px !important;            /* Yazƒ±ya ve paranteze yapƒ±≈ümasƒ±n */
    position: relative !important;       
    top: -2px !important;                /* Satƒ±rda √ßok hafif yukarƒ± kaldƒ±rdƒ±k, dengeli dursun */
    
    /* G√∂lge ve Hareket */
    box-shadow: 0 6px 15px var(--primary-color-translucent) !important;
    animation: happyWiggle 3s infinite ease-in-out !important;
}

/* Animasyon aynƒ± kalƒ±yor */
@keyframes happyWiggle {
    0%, 85% { transform: rotate(0deg) scale(1); }
    87% { transform: rotate(-15deg) scale(1.2); }
    89% { transform: rotate(15deg) scale(1.2); }
    91% { transform: rotate(-15deg) scale(1.2); }
    93% { transform: rotate(15deg) scale(1.2); }
    95% { transform: rotate(0deg) scale(1); }
    100% { transform: rotate(0deg) scale(1); }
}

/* --- BA≈ûLANGI√á: Lƒ∞STE D√úZENLEME VE Hƒ∞ZALAMA KODLARI --- */

/* 1. Kutular arasƒ± bo≈üluƒüu azaltma */
#travel-list {
    gap: 0.6rem !important; /* Eskiden 1.5rem idi, iyice yakla≈ütƒ±rdƒ±k */
    padding-left: 10px; /* Yamulunca kenara √ßarpmasƒ±n diye hafif pay */
}

/* 2. Kutuyu Saƒüa Yatƒ±rma ve K√∂≈üeleri Sivrile≈ütirme */
.travel-card {
    transform: skewX(-12deg) !important; /* Kutuyu sola doƒüru yatƒ±r */
    border-radius: 6px !important;       /* K√∂≈üeleri daha sivri yap (Eskiden yuvarlaktƒ±) */
    margin-right: 10px;                  /* Saƒüdan biraz bo≈üluk bƒ±rak */
    transition: all 0.3s ease !important;
}

/* Hover (√úzerine gelince) yine yukarƒ± kalksƒ±n ama eƒüikliƒüi bozulmasƒ±n */
.travel-card:hover {
    transform: skewX(-12deg) translateY(-4px) !important;
    box-shadow: 5px 5px 15px rgba(0,0,0,0.1) !important;
}

/* 3. ƒ∞√ßindeki Yazƒ±larƒ± D√ºzeltme (Yoksa yazƒ±lar da yamuk durur) */
.travel-card-summary {
    transform: skewX(12deg) !important; /* Kutunun tam tersine yatƒ±rarak d√ºzeltiyoruz */
    padding: 0.8rem 1.5rem !important;  /* ƒ∞√ß bo≈üluƒüu biraz daraltalƒ±m, daha kibar dursun */
}

/* 4. ƒ∞√ßerikleri Asker Gibi Hizaya Sokma */
/* √ñnce kapsayƒ±cƒ±yƒ± d√ºzenleyelim */
.summary-info {
    display: flex !important;
    align-items: center !important;
    width: 100%;
    gap: 10px !important; /* √ñƒüeler arasƒ± bo≈üluk */
}

/* Sƒ±ra Numarasƒ± */
.summary-seq-no {
    width: 30px !important;      /* Sabit geni≈ülik */
    text-align: center;
    flex-shrink: 0;              /* Asla k√º√ß√ºlmesin */
}

/* Tarih Kƒ±smƒ± */
.summary-item.summary-date-type {
    width: 280px !important;     /* Tarih kƒ±smƒ±na sabit yer ayƒ±r */
    flex-shrink: 0;              /* Daralmasƒ±n */
    border-right: 1px solid #eee; /* Araya ince √ßizgi (isteƒüe baƒülƒ± ≈üƒ±klƒ±k katar) */
    margin-right: 10px;
}

/* G√ºzergah (Yer) Kƒ±smƒ± */
.summary-item.summary-route {
    width: 200px !important;     /* ≈ûehir ismine sabit yer */
    flex-shrink: 0;              /* Daralmasƒ±n */
    white-space: nowrap;         /* Alt satƒ±ra ge√ßmesin */
    overflow: hidden;            /* Ta≈üarsa gizle */
    text-overflow: ellipsis;     /* Ta≈üarsa ... koy */
}

/* G√∂rev Konusu Kƒ±smƒ± */
.summary-item.summary-subject {
    flex-grow: 1;                /* Geri kalan t√ºm bo≈üluƒüu bu doldursun */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Saƒüdaki Butonlar (Sil/Kopyala) */
.summary-actions {
    transform: skewX(12deg) !important; /* Butonlarƒ± da d√ºzeltelim */
    margin-left: auto; /* En saƒüa itelim */
}

/* --- Bƒ∞Tƒ∞≈û: Lƒ∞STE D√úZENLEME KODLARI --- */

<style>
    /* ... Burasƒ± dosyanƒ±n kendi orijinal kodlarƒ± ... */

    /* --- 1. AZ √ñNCE YAPI≈ûTIRDIƒûIN KODLAR BURADA DURACAK (Sƒ∞LME) --- */
    #travel-list {
        gap: 0.6rem !important;
        padding-left: 10px;
    }
    .travel-card {
        transform: skewX(-12deg) !important;
        /* ... diƒüer kodlar ... */
    }

    /* ------------------------------------------------------- */
    /* --- 2. YENƒ∞ KODU BURAYA (EN ALTA) YAPI≈ûTIR --- */
    /* ------------------------------------------------------- */

    /* Kart A√áIKKEN (D√ºzenleme Modu): Dik Dursun */
    .travel-card:not(.is-collapsed) {
        transform: skewX(0deg) !important; /* Yamukluƒüu sƒ±fƒ±rla */
        margin: 20px 0 !important;
        z-index: 100;
        box-shadow: 0 15px 40px rgba(0,0,0,0.15) !important;
        border: 2px solid var(--primary-color) !important;
        background-color: #ffffff !important;
    }

    /* A√ßƒ±k kartƒ±n ba≈ülƒ±ƒüƒ±nƒ± da d√ºzelt */
    .travel-card:not(.is-collapsed) .travel-card-summary {
        transform: skewX(0deg) !important;
        border-bottom: 1px solid #f0f0f0;
        background-color: #fafafa;
    }

    /* ƒ∞√ßerideki Kutucuklarƒ± D√ºzenle */
    .travel-form-step {
        background: #fff !important;
        border: 1px solid #e2e8f0 !important;
        box-shadow: 0 4px 6px rgba(0,0,0,0.02) !important;
        border-radius: 10px !important;
        margin-bottom: 15px !important;
        transform: none !important;
    }

    /* Input Alanlarƒ±nƒ± ƒ∞kili S√ºtun Yap */
    .travel-form-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
    }

    @media (max-width: 768px) {
        .travel-form-grid {
            grid-template-columns: 1fr;
        }
    }

    /* Butonlarƒ±n olduƒüu alt kƒ±smƒ± toparla */
.travel-card-actions {
    background-color: transparent !important; /* Arka plan ≈üeffaf yapƒ±ldƒ± */
    border-top: none !important;              /* √ústteki √ßizgi kaldƒ±rƒ±ldƒ± */
    box-shadow: none !important;              /* Varsa g√∂lge kaldƒ±rƒ±ldƒ± */
    padding: 15px 0 !important;               /* Yan bo≈üluklar sƒ±fƒ±rlandƒ± */
    margin-top: 10px !important;
    border-radius: 0 !important;
}

<style>
/* =================================================================== */
/* === Fƒ∞NAL TASARIM: 5x4 GRID, TAM ORTALI, JELƒ∞BON BUTONLAR === */
/* =================================================================== */

/* 1. EKRAN YAPISI (Kƒ∞Lƒ∞TLƒ∞ VE ORTALI) */
#profile-selection-screen {
    position: fixed !important;
    inset: 0 !important;
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%) !important;
    z-index: 99999 !important;
    overflow: hidden !important; /* Kaydƒ±rma engellendi */
    padding: 20px !important;
}

/* 2. ƒ∞√áERƒ∞K KAPSAYICISI */
.profile-modal {
    width: 100% !important;
    max-width: 1400px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    margin: 0 !important;
    padding: 0 !important;
    /* Laptoplar i√ßin √∂l√ßekleme */
    transform-origin: center center !important;
}

/* 3. BA≈ûLIK */
.profile-modal h1.decorative-title {
    font-family: 'Inter', sans-serif !important;
    font-size: 2.8rem !important;
    font-weight: 900 !important;
    color: #1e293b !important;
    text-transform: uppercase !important;
    letter-spacing: -1px !important;
    margin: 0 0 30px 0 !important;
    padding: 0 !important;
    background: none !important;
    -webkit-text-fill-color: initial !important;
    text-shadow: none !important;
    animation: none !important;
}

/* Ba≈ülƒ±k Altƒ± √áizgi */
.profile-modal h1.decorative-title::after {
    content: '';
    display: block;
    width: 60px;
    height: 6px;
    background: #3b82f6;
    margin: 10px auto 0 auto;
    border-radius: 10px;
}

/* Gereksiz yazƒ±yƒ± gizle */
.profile-modal p {
    display: none !important;
}

/* 4. PROFƒ∞L IZGARASI (5 S√úTUN x 4 SATIR = 20 KART) */
.profile-container {
    display: grid !important;
    grid-template-columns: repeat(5, 1fr) !important; /* Yan yana 5 tane */
    gap: 15px !important;
    width: 100% !important;
    justify-content: center !important;
    padding: 10px !important;
}

/* 5. JELƒ∞BON KART TASARIMI */
.profile-card {
    margin: 0 !important;
    height: 125px !important; /* Kart y√ºksekliƒüi */
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    background: #ffffff !important;
    border-radius: 20px !important;
    border: 1px solid rgba(255,255,255,0.5) !important;
    box-shadow: 0 8px 20px rgba(0,0,0,0.05), 
                inset 0 0 0 1px rgba(255,255,255,0.5) !important;
    cursor: pointer !important;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1) !important;
    position: relative !important;
    overflow: hidden !important;
}

/* Kartƒ±n ƒ∞√ßi */
.profile-card i {
    width: 36px !important;
    height: 36px !important;
    color: #64748b !important;
    margin-bottom: 8px !important;
    transition: all 0.3s ease !important;
}

.profile-card h3 {
    font-size: 0.95rem !important;
    font-weight: 700 !important;
    color: #334155 !important;
    margin: 0 !important;
    text-align: center !important;
}

/* HOVER (√úZERƒ∞NE GELƒ∞NCE) */
.profile-card:hover {
    transform: translateY(-6px) scale(1.03) !important;
    box-shadow: 0 15px 30px rgba(59, 130, 246, 0.25) !important;
    background: #ffffff !important;
}

.profile-card:hover i {
    color: #3b82f6 !important;
    transform: scale(1.15) rotate(-5deg) !important;
}

.profile-card:hover h3 {
    color: #1e293b !important;
}

/* Hover Parlama Efekti */
.profile-card::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
    transform: skewX(-20deg);
    transition: none;
}

.profile-card:hover::before {
    left: 100%;
    transition: 0.5s ease;
}

/* RESPONSIVE K√ú√á√úLTME */
@media (max-height: 800px) {
    .profile-modal { transform: scale(0.85) !important; }
}

/* --- ADIM 1: DAHA KOMPAKT VE KISA TASARIM --- */

/* 1. A√ßƒ±lan kartƒ±n i√ßindeki genel bo≈üluklarƒ± azaltƒ±yoruz */
.travel-card:not(.is-collapsed) .travel-card-content {
    padding: 1rem !important; /* Kenar bo≈üluƒüunu azalttƒ±k */
}

/* 2. Beyaz kutucuklarƒ±n (form adƒ±mlarƒ±) i√ßindeki ≈üi≈ükinliƒüi alƒ±yoruz */
.travel-form-step {
    padding: 0.8rem 1rem !important; /* ƒ∞√ß bo≈üluƒüu daralttƒ±k */
    margin-bottom: 0.8rem !important; /* Altƒ±ndaki bo≈üluƒüu azalttƒ±k */
    min-height: auto !important;
}

/* 3. Yazƒ± yazdƒ±ƒüƒ±mƒ±z kutularƒ±n (Input) boyunu kƒ±saltƒ±yoruz */
.input-group input,
.input-group select,
.input-group textarea,
.transport-entry input,
.transport-entry select {
    height: 38px !important; /* Y√ºksekliƒüi 46px'den 38px'e indirdik */
    font-size: 0.9rem !important; /* Yazƒ±yƒ± hafif k√º√ß√ºltt√ºk ki sƒ±ƒüsƒ±n */
    padding: 0 0.5rem !important;
}

/* Tarih ve Saat kutularƒ± normalde √ßok b√ºy√ºk, onlarƒ± da k√º√ß√ºltelim */
.input-group input[type="date"],
.input-group input[type="time"],
.input-group input[type="number"] {
    height: 40px !important; /* Dev gibi olan tarih kutularƒ±nƒ± kƒ±salttƒ±k */
    font-size: 1rem !important;
    padding: 0.2rem !important;
}

/* 4. Etiketlerin (Ba≈ülƒ±klarƒ±n) altƒ±ndaki bo≈üluƒüu kƒ±stƒ±k */
.input-group label {
    margin-bottom: 0.25rem !important;
    font-size: 0.85rem !important;
}

/* 5. Satƒ±r aralarƒ±ndaki bo≈üluklarƒ± sƒ±kƒ±la≈ütƒ±rdƒ±k */
.travel-form-grid, 
.travel-form-row,
.travel-form-row-2col {
    gap: 0.8rem !important; /* Aralarƒ± yakla≈ütƒ±rdƒ±k */
}

/* 6. En alttaki buton kƒ±smƒ±nƒ± biraz incelttik */
.travel-card-actions {
    padding: 10px 15px !important;
    margin-top: 10px !important;
}

/* Kutucuklarƒ± Zangƒ±r Zangƒ±r Titreten Animasyon */
@keyframes shakeHard {
    0%, 100% { transform: translateX(0); }
    10%, 30%, 50%, 70%, 90% { transform: translateX(-6px) rotate(-2deg); border-color: #ef4444; box-shadow: 0 0 10px rgba(239, 68, 68, 0.4); }
    20%, 40%, 60%, 80% { transform: translateX(6px) rotate(2deg); }
}

.shake-hard {
    animation: shakeHard 0.5s cubic-bezier(.36,.07,.19,.97) both;
    background-color: #fff1f2 !important; /* Arka planƒ± hafif kƒ±rmƒ±zƒ± yap */
}

/* Hata mesajƒ± i√ßindeki koyu yazƒ± stili */
.toast-notification b {
    color: #fca5a5;
    text-decoration: underline;
    margin: 0 4px;
}


    </style>
</head>

<body>

    <!-- ================== Splash Screen (Temaya Uygun & ƒ∞z Bƒ±rakmayan) ================== -->
<div id="splash-screen" style="
    position: fixed;
    inset: 0;
    z-index: 100000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    /* Rengi el ile vermiyoruz, sistemin o anki temasƒ±ndan √ßekiyoruz */
    background: linear-gradient(135deg, var(--bg-start), var(--bg-end)); 
    overflow: hidden;
    font-family: 'Playfair Display', serif;
    transition: opacity 0.4s ease-out;
">
    <style>
        /* 1. YUMU≈ûAK Gƒ∞Rƒ∞≈û */
        @keyframes softEntry {
            from { opacity: 0; transform: translateY(15px) scale(0.98); filter: blur(4px); }
            to { opacity: 1; transform: translateY(0) scale(1); filter: blur(0px); }
        }

        /* 2. KALP ATI≈ûI (Temanƒ±n ana rengiyle atar) */
        @keyframes themeHeartbeat {
            0%, 100% { 
                transform: scale(1); 
                color: var(--primary-color); 
            }
            50% { 
                transform: scale(1.15); 
                color: var(--accent-color); /* Vurgu rengine d√∂ner */
                text-shadow: 0 0 20px var(--primary-color-translucent); 
            }
        }

        /* 3. PATLAYARAK √áIKI≈û */
        @keyframes themeExplode {
            0% { opacity: 1; transform: scale(1); }
            100% { 
                opacity: 0; 
                transform: scale(3); /* ƒ∞yice b√ºy√ºyerek yok olur */
                filter: blur(15px); 
                letter-spacing: 1rem;
            }
        }

        .splash-text {
            font-size: 2.6rem;
            color: var(--text-primary); /* Temanƒ±n yazƒ± rengi */
            font-weight: 500;
            text-align: center;
            animation: softEntry 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .love-word {
            display: inline-block;
            font-weight: 800;
            color: var(--primary-color); /* Temanƒ±n ana rengi */
            padding: 0 5px;
            animation: themeHeartbeat 1.8s ease-in-out infinite;
            animation-delay: 0.3s;
        }

        /* JS ile eklenecek √ßƒ±kƒ±≈ü sƒ±nƒ±fƒ± */
        .finish-animation {
            animation: themeExplode 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards !important;
        }
    </style>

    <!-- Temayƒ± anƒ±nda y√ºklemek i√ßin mini script (Beyaz ekran parlamasƒ±nƒ± √∂nler) -->
    <script>
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'theme-spring';
            document.body.className = savedTheme; // Temayƒ± hemen uygula
        })();
    </script>

    <div id="splash-content" class="splash-text">
        T√ºm meseleler ancak <span class="love-word">"Sevgi"</span> ile hallolur.
    </div>
</div>

<script>
    (function () {
        const screen = document.getElementById('splash-screen');
        const content = document.getElementById('splash-content');

        // 2.2 saniye bekle
        setTimeout(() => {
            // 1. Patlama efektini ba≈ülat
            content.classList.add('finish-animation');
            
            // 2. Arka planƒ± hƒ±zla soldur
            screen.style.transition = "opacity 0.6s ease";
            screen.style.opacity = '0';
            
            // 3. Tƒ±klamayƒ± serbest bƒ±rak (kullanƒ±cƒ± beklemek zorunda kalmasƒ±n)
            screen.style.pointerEvents = 'none';

        }, 2200);

        // Efekt biter bitmez (2200 + 600 = 2800ms) DOM'dan tamamen sil
        setTimeout(() => {
            if(screen) screen.remove();
        }, 2800);
    })();
</script>
<!-- ================== Splash Screen Biti≈ü ================== -->
    <div id="profile-selection-screen">
        <div class="profile-modal">
            <h1 class="decorative-title" style="font-size: 2.2rem; padding:0; animation:none; margin-bottom: 0.75rem;">
                G√∂rev Profilini Se√ßiniz</h1>
            <p>Uygulamaya devam etmek i√ßin mevcut √ßalƒ±≈üma profilinizi se√ßin.</p>
            <div id="profile-container" class="profile-container">
                <!-- Profile cards will be dynamically inserted here by JavaScript -->
            </div>
        </div>
    </div>


    <!-- ================== Ana Uygulama ================== -->
    <div id="main-app" style="display: none;">

        <div class="container">
            <!-- Header & Navigation Bar -->
            <nav class="top-nav">
                <div class="nav-left">
                    <div class="logo-placeholder" id="left-logo">
                        <i data-lucide="image" style="width: 32px; height: 32px; color: var(--primary-color);"></i>
                        <span class="logo-hint">Logo y√ºkleyebilirsiniz</span>
                    </div>
                    <div class="app-title">Raporlama Asistanƒ± <span id="app-title-suffix">/ Sinop 10. B√∂lge
                            M√ºd√ºrl√ºƒü√º</span></div>
                </div>
                <div class="nav-right">
                    <div id="profile-info" class="profile-info"></div>
                    <button class="icon-btn" onclick="changeProfile()" title="Profili Deƒüi≈ütir"><i
                            data-lucide="users"></i></button>

                    <div id="theme-wrapper">
                        <button id="theme-trigger" class="icon-btn" title="Temayƒ± Deƒüi≈ütir"><i
                                data-lucide="palette"></i></button>
                        <div id="theme-wheel-container">
                            <ul class="theme-wheel">
                                <!-- DEƒûƒ∞≈ûƒ∞KLƒ∞K: Tema butonlarƒ±na ikonlar eklendi -->
                                <li class="theme-option" data-theme="theme-spring"
                                    style="transform: rotate(0deg) translate(65px) rotate(0deg);"><button>üåø</button>
                                </li>
                                <li class="theme-option" data-theme="theme-summer"
                                    style="transform: rotate(32.7deg) translate(65px) rotate(-32.7deg);">
                                    <button>üåû</button>
                                </li>
                                <li class="theme-option" data-theme="theme-autumn"
                                    style="transform: rotate(65.4deg) translate(65px) rotate(-65.4deg);">
                                    <button>üçÇ</button>
                                </li>
                                <li class="theme-option" data-theme="theme-winter"
                                    style="transform: rotate(98.1deg) translate(65px) rotate(-98.1deg);">
                                    <button>‚õÑ</button>
                                </li>
                                <li class="theme-option" data-theme="theme-night"
                                    style="transform: rotate(130.8deg) translate(65px) rotate(-130.8deg);">
                                    <button>üåô</button>
                                </li>
                                <li class="theme-option" data-theme="theme-historic"
                                    style="transform: rotate(163.5deg) translate(65px) rotate(-163.5deg);">
                                    <button>üìú</button>
                                </li>
                                <li class="theme-option" data-theme="theme-forest"
                                    style="transform: rotate(196.2deg) translate(65px) rotate(-196.2deg);">
                                    <button>üå≤</button>
                                </li>
                                <li class="theme-option" data-theme="theme-ocean"
                                    style="transform: rotate(228.9deg) translate(65px) rotate(-228.9deg);">
                                    <button>üåä</button>
                                </li>
                                <li class="theme-option" data-theme="theme-sunrise"
                                    style="transform: rotate(261.6deg) translate(65px) rotate(-261.6deg);">
                                    <button>üåÖ</button>
                                </li>
                                <li class="theme-option" data-theme="theme-lavender"
                                    style="transform: rotate(294.3deg) translate(65px) rotate(-294.3deg);">
                                    <button>ü¶ã</button>
                                </li>
                                <li class="theme-option" data-theme="theme-graphite"
                                    style="transform: rotate(327deg) translate(65px) rotate(-327deg);">
                                    <button>‚ö´</button>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="logo-placeholder" id="right-logo">
                        <i data-lucide="image" style="width: 32px; height: 32px; color: var(--accent-color);"></i>
                        <span class="logo-hint">Logo y√ºkleyebilirsiniz</span>
                    </div>
                </div>
                <input type="file" id="logo-uploader" accept="image/*" style="display: none;">
            </nav>

            <h1 class="decorative-title">
    <div class="main-line">YOLLUK VE TAZMƒ∞NAT</div>
    <div class="sub-line">HAZIRLAMA UYGULAMASI</div>
</h1>

            <!-- Interactive Layout (Tabs) -->
            <div class="tab-nav">
                <button class="tab-btn active" data-tab="centralInfoSection"><i data-lucide="user-cog"></i> Merkezi
                    Bilgiler</button>
                <button class="tab-btn" data-tab="travelListSection"><i data-lucide="plane-takeoff"></i> Seyahat Listesi
                    (<span id="travel-counter">0</span>)</button>
                <button class="tab-btn" data-tab="reportSection"><i data-lucide="file-text"></i> Rapor Olu≈ütur</button>
            </div>

            <!-- Panel 1: Merkezi Bilgiler -->
            <div id="centralInfoSection" class="tab-panel active">
                <div class="content-card">
                    <div class="grid-container" style="gap: 2.5rem;">
                        <div>
                            <h4 style="text-align: center;"><i data-lucide="user-circle"
                                    style="width:22px; height:22px;"></i>Personel ve √ñdeme Bilgileri</h4>
                            <div class="input-group"><label>Adƒ± Soyadƒ±</label><input type="text" id="fullName"
                                    placeholder="√∂rn: Ad Soyad" title="Personelin tam adƒ± ve soyadƒ±"></div>
                            <div class="input-group"><label>Unvanƒ±</label><input type="text" id="title"
                                    placeholder="√∂rn: M√ºhendis" title="Personelin g√∂rev unvanƒ±"><small>Profil se√ßim
                                    ekranƒ±ndan da otomatik doldurabilirsiniz.</small></div>
                            <div class="input-group"><label>Kadro Derecesi</label><input type="text" id="degree"
                                    placeholder="√∂rn: 3/3-2800" title="Personelin kadro derece ve kademesi"></div>
                            <div class="input-group"><label>G√ºndeliƒüi (TL)</label><input type="number" id="dailyRate"
                                    value="610" title="G√ºnl√ºk yolluk √ºcreti (TL)"></div>
                            <div class="input-group"><label>Konaklama Katsayƒ±sƒ±</label><input type="number"
                                    id="accommodationRate" value="1.6" step="0.1"
                                    title="Konaklama √ºcreti √ßarpanƒ± (genellikle 1.6)"></div>
                        </div>
                        <div>
                            <h4 style="text-align: center;"><i data-lucide="building-2"
                                    style="width:22px; height:22px;"></i>Kurumsal Bilgiler</h4>
                            <div class="input-group"><label>M√ºd√ºrl√ºƒü√º</label><input type="text" id="department"
                                    value="Sinop 10. B√∂lge M√ºd√ºrl√ºƒü√º" title="Baƒülƒ± olduƒüunuz m√ºd√ºrl√ºk"></div>
                            <div class="input-group"><label>Birimi</label><input type="text" id="birim"
                                    value="Avcƒ±lƒ±k ve Yaban Hayatƒ± ≈ûube M√ºd√ºrl√ºƒü√º" title="√áalƒ±≈ütƒ±ƒüƒ±nƒ±z birim/≈üube">
                            </div>
                            <div class="input-group"><label>G√∂rev Yeri</label><input type="text" id="g√∂revYeri"
                                    value="Sinop" title="Ana g√∂rev yeriniz (≈üehir)"></div>
                            <div class="input-group"><label>B√ºt√ße Yƒ±lƒ±</label><input type="number" id="budgetYear"
                                    value="2025" title="Raporlarƒ±n ait olduƒüu yƒ±l"></div>
                        </div>
                        <div>
                            <h4 style="text-align: center;"><i data-lucide="pen-square"
                                    style="width:22px; height:22px;"></i>ƒ∞mza Yetkilileri</h4>
                            <div class="info-sub-group">
                                <h5><i data-lucide="user-check"></i> Varsayƒ±lan Yetkili</h5>
                                <div class="input-group"><label>Adƒ± Soyadƒ±</label><input type="text" id="amirAdi"
                                        placeholder="√∂rn: Mehmet YILDIZ" title="Varsayƒ±lan onaylayƒ±cƒ±nƒ±n adƒ± soyadƒ±">
                                </div>
                                <div class="input-group"><label>Unvanƒ±</label><input type="text" id="amirUnvani"
                                        placeholder="√∂rn: ≈ûube M√ºd√ºr√º" title="Varsayƒ±lan onaylayƒ±cƒ±nƒ±n unvanƒ±"></div>
                                <div class="month-selector-info" style="margin-top: 0.75rem;">
                                    <i data-lucide="info"></i>
                                    <span>T√ºm raporlarda varsayƒ±lan olarak kullanƒ±lƒ±r.</span>
                                </div>
                            </div>
                            <div class="info-sub-group">
                                <h5><i data-lucide="users"></i> √ñzel Rapor Yetkilileri</h5>
                                <div class="month-selector-info" style="margin-bottom: 1rem;">
                                    <i data-lucide="info"></i>
                                    <span>Belirli raporlar i√ßin farklƒ± yetkili kullanmak isterseniz doldurun. Bo≈ü
                                        bƒ±rakƒ±lƒ±rsa varsayƒ±lan yetkili kullanƒ±lƒ±r.</span>
                                </div>
                                <div class="input-group"><label>G√∂revlendirme Olur'u Yetkilisi Adƒ±</label><input
                                        type="text" id="olurYetkilisi"
                                        title="Bo≈ü bƒ±rakƒ±lƒ±rsa varsayƒ±lan yetkili kullanƒ±lƒ±r"></div>
                                <div class="input-group"><label>G√∂revlendirme Olur'u Yetkilisi Unvanƒ±</label><input
                                        type="text" id="olurUnvan"
                                        title="Bo≈ü bƒ±rakƒ±lƒ±rsa varsayƒ±lan yetkili kullanƒ±lƒ±r"></div>
                                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 1.5rem 0;">
                                <div class="input-group"><label>3 Aylƒ±k Tazminat Onaycƒ±sƒ± Adƒ±</label><input type="text"
                                        id="araziAmirAdi" title="Bo≈ü bƒ±rakƒ±lƒ±rsa varsayƒ±lan yetkili kullanƒ±lƒ±r"></div>
                                <div class="input-group"><label>3 Aylƒ±k Tazminat Onaycƒ±sƒ± Unvanƒ±</label><input
                                        type="text" id="araziAmirUnvani"
                                        title="Bo≈ü bƒ±rakƒ±lƒ±rsa varsayƒ±lan yetkili kullanƒ±lƒ±r"></div>
                                <hr style="border: none; border-top: 1px solid var(--border-color); margin: 1.5rem 0;">
                                <div class="input-group"><label>Kontrol Tazminatƒ± Onaycƒ±sƒ± Adƒ±</label><input type="text"
                                        id="kontrolAmirAdi" title="Bo≈ü bƒ±rakƒ±lƒ±rsa varsayƒ±lan yetkili kullanƒ±lƒ±r"></div>
                                <div class="input-group"><label>Kontrol Tazminatƒ± Onaycƒ±sƒ± Unvanƒ±</label><input
                                        type="text" id="kontrolAmirUnvani"
                                        title="Bo≈ü bƒ±rakƒ±lƒ±rsa varsayƒ±lan yetkili kullanƒ±lƒ±r"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Panel 2: Seyahat Listesi -->
            <div id="travelListSection" class="tab-panel">
                <div id="travel-list"></div>
                <div style="margin-top: 1.5rem; text-align: center;">
                    <button class="add-btn" onclick="openTravelWizard()"><i data-lucide="plus-circle"></i> Yeni Seyahat
                        Ekle</button>
                </div>
            </div>

            <!-- Panel 3: Rapor Olu≈ütur -->
            <div id="reportSection" class="tab-panel">
                <div class="content-card">
                    <div class="report-actions-grid">
                        <div class="report-group">
                            <h4 style="text-align: center;"><i data-lucide="route"
                                    style="width:20px; height:20px; margin-right: 8px;"></i> Yolluk / Harcƒ±rah Raporlarƒ±
                            </h4>
                            <div class="input-group">
                                <label for="yollukMonthFilter">Rapor Aylarƒ±</label>
                                <select id="yollukMonthFilter" multiple
                                    title="Rapor olu≈üturmak istediƒüiniz aylarƒ± se√ßin">:)
                                    <option value="0">T√ºm Aylar</option>
                                    <option value="1">Ocak</option>
                                    <option value="2">≈ûubat</option>
                                    <option value="3">Mart</option>
                                    <option value="4">Nisan</option>
                                    <option value="5">Mayƒ±s</option>
                                    <option value="6">Haziran</option>
                                    <option value="7">Temmuz</option>
                                    <option value="8">Aƒüustos</option>
                                    <option value="9">Eyl√ºl</option>
                                    <option value="10">Ekim</option>
                                    <option value="11">Kasƒ±m</option>
                                    <option value="12">Aralƒ±k</option>
                                </select>
                            </div>
                            <div class="input-group"><button class="main-action-btn report-generate-btn"
                                    onclick="generateYollukReportPage()"><i data-lucide="receipt"></i><span>Yolluk
                                        Bildirimi Olu≈ütur</span></button></div>
                            <div class="input-group"><button class="main-action-btn report-generate-btn"
                                    onclick="generateGorevEmriReportPage()"><i
                                        data-lucide="file-signature"></i><span>G√∂revlendirme Olur'u
                                        Olu≈ütur</span></button></div>
                        </div>
                        <div class="report-group">
                            <h4 style="text-align: center;"><i data-lucide="mountain"
                                    style="width:20px; height:20px; margin-right: 8px;"></i> 3 Aylƒ±k √ñzel Hizmet
                                Tazminatƒ±</h4>
                            <div class="input-group"><label for="araziDonem">Tazminat D√∂nemi</label><select
                                    id="araziDonem" title="Rapor olu≈üturmak istediƒüiniz 3 aylƒ±k d√∂nemi se√ßin">
                                    <option value="1">Ocak - Mart</option>
                                    <option value="2" selected>Nisan - Haziran</option>
                                    <option value="3">Temmuz - Eyl√ºl</option>
                                    <option value="4">Ekim - Aralƒ±k</option>
                                </select></div>
                            <div class="input-group">
                                <button class="main-action-btn report-generate-btn"
                                    style="background-image: linear-gradient(90deg, var(--primary-color), var(--primary-color-dark));"
                                    onclick="openAraziDayManager()">
                                    <i data-lucide="calendar-cog"></i><span>Arazi G√ºnlerini Y√∂net</span>
                                </button>
                                <small><i data-lucide="info" style="width:14px;height:14px;"></i>Arazi tazminatƒ±ndan
                                    √ßƒ±karƒ±p kontrol tazminatƒ±na eklemek istediƒüiniz g√ºnleri y√∂netin.</small>
                            </div>
                            <div class="input-group"><button class="main-action-btn report-generate-btn"
                                    onclick="generateAraziIfaPage()"><i data-lucide="list-checks"></i><span>3 Aylƒ±k
                                        Arazi Cetveli Olu≈ütur</span></button></div>
                            <div class="input-group"><button class="main-action-btn report-generate-btn"
                                    onclick="generateAraziPuantajPage()"><i data-lucide="calendar-days"></i><span>3
                                        Aylƒ±k Puantaj √áetveli Olu≈ütur</span></button></div>
                        </div>
                        <div class="report-group">
                            <h4 style="text-align: center;"><i data-lucide="check-square"
                                    style="width:20px; height:20px; margin-right: 8px;"></i> Kontrol Tazminatƒ±</h4>
                            <div class="input-group"><label for="kontrolMonthFilter">Rapor Aylarƒ±</label><select
                                    id="kontrolMonthFilter" multiple title="Rapor olu≈üturmak istediƒüiniz aylarƒ± se√ßin">
                                    <option value="1">Ocak</option>
                                    <option value="2">≈ûubat</option>
                                    <option value="3">Mart</option>
                                    <option value="4">Nisan</option>
                                    <option value="5">Mayƒ±s</option>
                                    <option value="6">Haziran</option>
                                    <option value="7">Temmuz</option>
                                    <option value="8">Aƒüustos</option>
                                    <option value="9">Eyl√ºl</option>
                                    <option value="10">Ekim</option>
                                    <option value="11">Kasƒ±m</option>
                                    <option value="12">Aralƒ±k</option>
                                </select></div>
                            <div class="input-group">
                                <label for="excludedDates">Hari√ß Tutulacak G√ºnler</label>
                                <input type="text" id="excludedDates" placeholder="√ñr: 23.04, 01.05-03.05"
                                    style="text-align: center; font-size: 0.95rem;"
                                    title="Resmi tatil ve √∂zel g√ºnleri girin (√∂rn: 23.04, 01.05-07.05)">
                                <small style="display: block; text-align: center; margin-top: 0.5rem;"><i
                                        data-lucide="info"></i>Resm√Æ izin ve varsa din√Æ bayram tatilleri ‚Äî √∂rnek giri≈ü:
                                    23.04, 01.05-07.05 gibi</small>
                            </div>
                            <button class="advanced-settings-toggle"
                                onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'block' ? 'none' : 'block'"><i
                                    data-lucide="settings-2" style="width:16px;"></i> Geli≈ümi≈ü Ayarlar</button>
                            <div class="advanced-settings-panel">
                                <h5
                                    style="text-align: center; color: var(--primary-color); font-size: 1.1rem; margin-bottom: 1rem; font-weight: 700;">
                                    <i data-lucide="calendar-cog"
                                        style="width:18px; height:18px; margin-right: 6px;"></i>G√ºn Y√∂netimi ve
                                    √ñzelle≈ütirme
                                </h5>
                                <div class="input-group">
                                    <label for="extraHolidayDates" style="margin-bottom: 0.25rem;">Ek Tatil Mesai
                                        G√ºnleri</label>
                                    <small
                                        style="display: block; text-align: center; margin-bottom: 0.25rem; opacity: 0.7; font-size: 0.9em;">(Tatilde
                                        √ßalƒ±≈ümƒ±≈üsanƒ±z tazminat alabilmek i√ßin l√ºtfen belirtin)</small>
                                    <input type="text" id="extraHolidayDates" placeholder="√ñr: 01.01, 23.04, 19.05"
                                        style="text-align: center; font-size: 0.95rem; padding: 0.4rem;"
                                        title="Resmi tatil veya hafta sonunda √ßalƒ±≈üƒ±lan g√ºnleri girin">
                                    <small
                                        style="display: block; text-align: center; margin-top: 0.5rem; opacity: 0.8;">
                                        <i data-lucide="info" style="width:14px;height:14px;"></i>
                                        Resmi tatil veya hafta sonunda yapƒ±lan mesai g√ºnlerini ekleyebilirsiniz (√∂rn:
                                        01.01, 23.04)
                                    </small>
                                </div>
                                <hr
                                    style="border: none; border-top: 1px solid var(--border-color); margin: 1.25rem 0; opacity: 0.3;">
                                <div class="input-group">
                                    <label for="maxControlDays">Aylƒ±k Maksimum Kontrol G√ºn√º</label>
                                    <input type="number" id="maxControlDays" min="0" max="31" value="16"
                                        title="Her ay i√ßin maksimum ka√ß g√ºn kontrol yapƒ±lacaƒüƒ±nƒ± belirtin (0 = sƒ±nƒ±rsƒ±z)">
                                    <small style="display: block; text-align: center; margin-top: 0.5rem;"><i
                                            data-lucide="info"></i>0 veya bo≈ü ise sƒ±nƒ±rlama olmaz.</small>
                                </div>
                                <hr
                                    style="border: none; border-top: 2px solid var(--border-color); margin: 2rem 0; opacity: 0.5;">
                                <h5
                                    style="text-align: center; color: var(--primary-color); font-size: 1.1rem; margin-bottom: 1rem; font-weight: 700;">
                                    <i data-lucide="file-edit"
                                        style="width:18px; height:18px; margin-right: 6px;"></i>Rapor ƒ∞√ßeriƒüini
                                    √ñzelle≈ütir
                                </h5>
                                <div class="input-group"><label>Kontrol T√ºr√º</label><input type="text" id="kontrolTuru"
                                        value="Belge Kontrol√º" title="Yapƒ±lan kontrol t√ºr√ºn√º belirtin"></div>
                                <div class="input-group"><label>Dayandƒ±ƒüƒ± Mevzuat</label><input type="text"
                                        id="kontrolMevzuat" value="4915"
                                        title="Kontrol√ºn dayandƒ±ƒüƒ± kanun veya y√∂netmelik numarasƒ±"></div>
                                <div class="input-group"><label>Ba≈ülangƒ±√ß Saati</label><input type="time"
                                        id="kontrolBaslangic" value="09:00"
                                        title="Kontrol √ßalƒ±≈ümasƒ±nƒ±n ba≈ülangƒ±√ß saati"></div>
                                <div class="input-group"><label>Biti≈ü Saati</label><input type="time" id="kontrolBitis"
                                        value="16:00" title="Kontrol √ßalƒ±≈ümasƒ±nƒ±n biti≈ü saati"></div>
                                <div class="input-group"><label>A√ßƒ±klama</label><textarea id="kontrolAciklama" rows="3"
                                        title="Kontrol √ßalƒ±≈ümasƒ±nƒ±n detaylƒ± a√ßƒ±klamasƒ±">Avcƒ±lƒ±k Hizmetleri, Av Turizmi, Doƒüaya Yerle≈ütirme, Av Koruma Kontrol, Yaban Hayatƒ± Geli≈ütirme Sahalarƒ± ile ilgili belgeler ve Avbis, YABƒ∞S gibi entegre sistemlerin kontrol√º ile 4915 Sayƒ±lƒ± Kanun Kapsamƒ±ndaki vb. Belge Kontrolleri</textarea>
                                </div>
                            </div>
                            <div class="input-group" style="margin-top:1rem;"><button
                                    class="main-action-btn report-generate-btn"
                                    onclick="generateKontrolPuantajPage()"><i data-lucide="table"></i><span>Kontrol
                                        Cetveli Olu≈ütur</span></button></div>
                            <div class="input-group"><button class="main-action-btn report-generate-btn"
                                    onclick="generateKontrolCizelgePage()"><i
                                        data-lucide="calendar-check"></i><span>Kontrol Puantaj √áizelgesi
                                        Olu≈ütur</span></button></div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="app-footer modern-footer">
    <div class="footer-content-wrapper">
        <div class="footer-links">
            <span>T.C. Tarƒ±m ve Orman Bakanlƒ±ƒüƒ±</span>
            <span class="separator">‚Ä¢</span>
            <span>Doƒüa Koruma ve Milli Parklar Genel M√ºd√ºrl√ºƒü√º</span>
            <span class="separator">‚Ä¢</span>
            <span>10. B√∂lge M√ºd√ºrl√ºƒü√º</span>
        </div>
        <hr class="footer-divider">
        <p class="footer-legal-text">
    ¬© 2025 ‚Äî Bu program, Sinop 10. B√∂lge M√ºd√ºrl√ºƒü√º Av ve Yaban Hayatƒ± ≈ûube M√ºd√ºrl√ºƒü√ºnde g√∂rev yapan personel tarafƒ±ndan √ßalƒ±≈üma kolaylƒ±ƒüƒ± saƒülamak amacƒ±yla hazƒ±rlanmƒ±≈ü olup h√¢len geli≈ütirme a≈üamasƒ±ndadƒ±r. Resm√Æ bir yazƒ±lƒ±m niteliƒüi ta≈üƒ±mamakta, personelin kendi tazminat ve harcƒ±rah i≈ülemlerinde s√ºre√ß takibini kolayla≈ütƒ±rmak i√ßin kullanƒ±lmaktadƒ±r. T√ºm haklarƒ± saklƒ±dƒ±r. Programda hata veya aksaklƒ±k tespit edilmesi halinde, gerekli d√ºzenlemeler i√ßin 10. B√∂lge M√ºd√ºrl√ºƒü√ºn√ºn ilgili birimiyle ileti≈üime ge√ßilebilir.
    <span class="last-update" id="auto-update-date" style="font-weight: 600; opacity: 0.9; margin-left: 8px;"></span>
    <script>
        (function() {
            var lastMod = new Date(document.lastModified);
            var dateStr = lastMod.toLocaleDateString('tr-TR', {day: '2-digit', month: '2-digit', year: 'numeric'});
            document.getElementById('auto-update-date').innerHTML = 
                `<i data-lucide="history" style="width:14px; height:14px; position:relative; top:2px; margin-right:4px; opacity:0.8;"></i> Son G√ºncelleme: ${dateStr}`;
            if(typeof lucide !== 'undefined') lucide.createIcons();
        })();
    </script>
</p>
    </div>
</footer>
        </div>
    </div>

    <div id="day-manager-modal-container" style="display: none;">
        <div class="day-manager-modal-overlay" onclick="closeAraziDayManager()">
            <div class="day-manager-modal" onclick="event.stopPropagation()">
                <div class="day-manager-header">
                    <h3><i data-lucide="calendar-cog"></i> Arazi G√ºn√º Y√∂netimi</h3>
                    <p id="day-manager-subtitle">D√∂nem i√ßin arazi g√ºnlerini y√∂netin.</p>
                </div>
                <div class="day-manager-body">
                    <div id="day-manager-list" class="day-manager-list">
                        <!-- Dinamik olarak doldurulacak -->
                    </div>
                </div>
                <div class="day-manager-footer">
                    <button class="main-action-btn"
                        style="background-image: linear-gradient(90deg, var(--accent-color), var(--accent-color-dark)); margin-bottom: 0.75rem;"
                        onclick="transferAllToKontrol()"><i data-lucide="arrow-right-circle"></i> T√ºm√ºn√º Kontrole
                        Aktar</button>
                    <button class="save-and-close-btn" onclick="closeAraziDayManager()"><i data-lucide="check"></i>
                        Tamam</button>
                </div>
            </div>
        </div>
    </div>


    <script>
        // --- 1Ô∏è‚É£ SECURITY ENHANCEMENTS (UNCHANGED) ---
        const INTEGRITY_CHECKSUM = '761181e138a0db3659a5934524c5220c328172828b0304a5725350913f380155';
        function encodeData(str) { try { return btoa(encodeURIComponent(str)); } catch (e) { return str; } }
        function decodeData(str) { try { return decodeURIComponent(atob(str)); } catch (e) { return str; } }
        async function verifyScriptIntegrity() {
            const scriptContent = document.querySelector('script').textContent;
            try {
                const textAsBuffer = new TextEncoder().encode(scriptContent);
                const hashBuffer = await crypto.subtle.digest('SHA-256', textAsBuffer);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                if (hashHex !== INTEGRITY_CHECKSUM) {
                    console.warn('Script integrity check failed. Expected:', INTEGRITY_CHECKSUM, 'Got:', hashHex);
                }
            } catch (error) { console.error('Integrity check could not be performed:', error); }
        }
        document.addEventListener('contextmenu', event => {
        });

        // --- UNCHANGED CORE LOGIC ---
        let travelIdCounter = 0;
        let currentProfile = null;
        let calculationMode = 'MEVZUAT';
        let araziDaysMovedToKontrol = new Set();
        const turkceGunler = ["Pazar", "Pazartesi", "Salƒ±", "√áar≈üamba", "Per≈üembe", "Cuma", "Cumartesi"];
        const turkceAylar = ["OCAK", "≈ûUBAT", "MART", "Nƒ∞SAN", "MAYIS", "HAZƒ∞RAN", "TEMMUZ", "AƒûUSTOS", "EYL√úL", "EKƒ∞M", "KASIM", "ARALIK"];
        const popularLocations = ["Bartƒ±n", "Karab√ºk", "Kastamonu", "Sinop", "Zonguldak", "Antalya", "Ankara", "Hamsilos", "Sarƒ±kum", "Ayancƒ±k", "Gerze", "T√ºrkeli", "Abana", "Cide", "Amasra", "ƒ∞nebolu", "D√ºzce", "Bolu", "ƒ∞stanbul", "Samsun", "Ordu", "Giresun", "Trabzon"];
        const popularTopics = ["Av ve Yaban Hayatƒ± ile ƒ∞lgili Saha ƒ∞≈üleri", "Saha √áalƒ±≈ümasƒ±", "Fidanlƒ±k Kontrol√º", "Yaban Hayvanƒ± Yerle≈ütirme Alanƒ± Tespiti", "B√∂lge Toplantƒ±sƒ±", "Hizmeti√ßi Eƒüitim Semineri", "Av Koruma ve Kontrol Faaliyetleri", "Yaban Hayatƒ± G√∂zlemi ve Envanter √áalƒ±≈ümasƒ±", "Biyolojik √áe≈üitlilik Tespiti", "Ka√ßak Avcƒ±lƒ±kla M√ºcadele", "YABƒ∞S Veri Giri≈üi ve Kontrol√º"];
        let dynamicLocations = [];
        let dynamicTopics = [];

/* --- Sƒ∞Lƒ∞NEN YERE YAPI≈ûTIRILACAK TAM PROFƒ∞L Lƒ∞STESƒ∞ --- */
    const profiles = {
        engineer: { name: 'M√ºhendis', icon: 'hard-hat', defaults: { title: 'M√ºhendis', degree: '3/3-2800' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        veteriner: { name: 'Veteriner Hekim', icon: 'syringe', defaults: { title: 'Veteriner Hekim', degree: '3/3-2800' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        biyolog: { name: 'Biyolog', icon: 'flask-conical', defaults: { title: 'Biyolog', degree: '3/3-2800' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        orman_muhafaza: { name: 'Orman Muhafaza', icon: 'shield', defaults: { title: 'Orman Muhafaza Memuru', degree: '5/1-1900' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        tekniker: { name: 'Tekniker', icon: 'sliders', defaults: { title: 'Tekniker', degree: '5/1-1900' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        sef: { name: '≈ûef', icon: 'star', defaults: { title: '≈ûef', degree: '5/1-1900' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        officer: { name: 'Memur', icon: 'file-text', defaults: { title: 'Memur', degree: '5/1-1900' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        buro: { name: 'B√ºro Personeli', icon: 'clipboard', defaults: { title: 'B√ºro Personeli', degree: '5/1-1900' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        vhki: { name: 'VHKƒ∞', icon: 'database', defaults: { title: 'V.H.K.ƒ∞.', degree: '5/1-1900' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        avukat: { name: 'Avukat', icon: 'scale', defaults: { title: 'Avukat', degree: '1/4-3600' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        branch_manager: { name: '≈ûube M√ºd√ºr√º', icon: 'briefcase', defaults: { title: '≈ûube M√ºd√ºr√º', degree: '1/4-3600' }, signers: { amirAdi: 'ƒ∞sminiz', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        dkmp_director: { name: 'DKMP M√ºd√ºr√º', icon: 'shield-check', defaults: { title: 'DKMP M√ºd√ºr√º', degree: '1/4-3600' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        mp_director: { name: 'MP M√ºd√ºr√º', icon: 'trees', defaults: { title: 'MP M√ºd√ºr√º', degree: '1/4-3600' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        deputy_regional_director: { name: 'B√∂lge Md. Yrd.', icon: 'user-check', defaults: { title: 'B√∂lge M√ºd√ºr Yard.', degree: '1/4-4800' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'ƒ∞sminiz', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        regional_director: { name: 'B√∂lge M√ºd√ºr√º', icon: 'user-cog', defaults: { title: 'B√∂lge M√ºd√ºr√º', degree: '1/4-6400' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'ƒ∞sminiz', olurUnvan: 'B√∂lge M√ºd√ºr√º' } },
        worker: { name: 'ƒ∞≈ü√ßi', icon: 'wrench', defaults: { title: 'ƒ∞≈ü√ßi', degree: 'N/A' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        uzman: { name: 'Uzman', icon: 'award', defaults: { title: 'Uzman', degree: '1/4-3600' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        uzman_yrd: { name: 'Uzman Yrd.', icon: 'book-open', defaults: { title: 'Uzman Yardƒ±mcƒ±sƒ±', degree: '7/1-1600' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        arastirmaci: { name: 'Ara≈ütƒ±rmacƒ±', icon: 'microscope', defaults: { title: 'Ara≈ütƒ±rmacƒ±', degree: '1/4-3600' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } },
        sofor: { name: '≈ûof√∂r', icon: 'car', defaults: { title: '≈ûof√∂r', degree: '5/1-1900' }, signers: { amirAdi: 'Mehmet YILDIZ', amirUnvani: '≈ûube M√ºd√ºr√º', olurYetkilisi: 'Ahmet YILMAZ', olurUnvan: 'B√∂lge M√ºd√ºr√º Yard.' } }
    };

        function renderProfileSelection() {
            const container = document.getElementById('profile-container'); container.innerHTML = '';
            for (const key in profiles) {
                const profile = profiles[key];
                const cardHTML = `<div class="profile-card" onclick="selectProfile('${key}')" tabindex="0"><i data-lucide="${profile.icon}" class="profile-icon" style="width: 36px; height: 36px;"></i><h3>${profile.name}</h3></div>`;
                container.innerHTML += cardHTML;
            }
            lucide.createIcons();
        }

        function selectProfile(profileKey) {
            currentProfile = profileKey;
            localStorage.setItem('currentProfile', encodeData(profileKey));

            const profileDefaults = profiles[currentProfile].defaults;
            const profileSigners = profiles[currentProfile].signers;

            Object.keys(profileDefaults).forEach(id => {
                const el = document.getElementById(id);
                if (el) el.value = profileDefaults[id];
            });

            const savedData = localStorage.getItem('reportingAppData_' + currentProfile);
            const data = savedData ? JSON.parse(decodeData(savedData)) : null;
            if (!data || !data.centralInfo || !data.centralInfo.amirAdi) {
                Object.keys(profileSigners).forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.value = profileSigners[id];
                });
            }

            document.getElementById('profile-selection-screen').style.display = 'none';
            document.getElementById('main-app').style.display = 'block';
            document.getElementById('profile-info').innerHTML = `<strong>${profiles[currentProfile].name}</strong>`;

            loadData();
        }

        function changeProfile() {
            currentProfile = null; localStorage.removeItem('currentProfile');
            document.getElementById('main-app').style.display = 'none';
            document.getElementById('profile-selection-screen').style.display = 'flex';
            renderProfileSelection();
        }

        function initApp() {
            const savedLocations = JSON.parse(decodeData(localStorage.getItem('autocomplete_locations') || '[]'));
            const savedTopics = JSON.parse(decodeData(localStorage.getItem('autocomplete_topics') || '[]'));
            const districtLocations = [
                "Ayancƒ±k", "Boyabat", "Dikmen", "Duraƒüan", "Erfelek", "Gerze", "Sarayd√ºz√º", "T√ºrkeli",
                "Abana", "Aƒülƒ±", "Ara√ß", "Azdavay", "Bozkurt", "Cide", "√áatalzeytin", "Daday", "Devrekani", "Doƒüanyurt", "Han√∂n√º", "ƒ∞hsangazi", "ƒ∞nebolu", "K√ºre", "Pƒ±narba≈üƒ±", "Seydiler", "≈ûenpazar", "Ta≈ük√∂pr√º", "Tosya",
                "Amasra", "Kuruca≈üile", "Ulus",
                "Alaplƒ±", "√áaycuma", "Devrek", "Ereƒüli", "G√∂k√ßebey", "Kilimli", "Kozlu",
                "Eflani", "Eskipazar", "Ovacƒ±k", "Safranbolu", "Yenice"
            ];
            dynamicLocations = [...new Set([...savedLocations, ...popularLocations, ...districtLocations])];
            dynamicTopics = [...new Set([...savedTopics, ...popularTopics])];
            const savedProfile = decodeData(localStorage.getItem('currentProfile'));
            if (savedProfile && profiles[savedProfile]) {
                selectProfile(savedProfile);
            } else {
                renderProfileSelection();
            }
            setupTheme();
            setupLogoUploads();
        }

        // Ses efektleri i√ßin AudioContext kullanƒ±mƒ±
        let audioContext = null;
        function initAudioContext() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            return audioContext;
        }

        function playSound(type = 'success') {
            try {
                const ctx = initAudioContext();
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(ctx.destination);

                // Daha tok sesler i√ßin d√º≈ü√ºk frekanslar
                if (type === 'success') {
                    oscillator.frequency.setValueAtTime(350, ctx.currentTime); // Daha tok
                    oscillator.frequency.exponentialRampToValueAtTime(450, ctx.currentTime + 0.1);
                } else if (type === 'error') {
                    oscillator.frequency.setValueAtTime(180, ctx.currentTime); // Daha tok
                    oscillator.frequency.exponentialRampToValueAtTime(150, ctx.currentTime + 0.15);
                } else if (type === 'click') {
                    oscillator.frequency.setValueAtTime(280, ctx.currentTime); // Daha tok
                } else if (type === 'save') {
                    oscillator.frequency.setValueAtTime(400, ctx.currentTime); // Daha tok
                    oscillator.frequency.exponentialRampToValueAtTime(500, ctx.currentTime + 0.08);
                    oscillator.frequency.exponentialRampToValueAtTime(600, ctx.currentTime + 0.15);
                }

                oscillator.type = 'sine';
                gainNode.gain.setValueAtTime(0.15, ctx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);

                oscillator.start(ctx.currentTime);
                oscillator.stop(ctx.currentTime + 0.2);
            } catch (e) {
                // Ses √ßalƒ±namazsa sessizce devam et
            }
        }

        let toastTimeout;
        function showToast(message, type = 'info') {
            const existingToast = document.querySelector('.toast-notification');
            if (existingToast) {
                existingToast.remove();
                clearTimeout(toastTimeout);
            }
            const toast = document.createElement('div');
            toast.className = `toast-notification`;
            toast.innerHTML = `${message}`;
            document.body.appendChild(toast);

            // Bildirim tipine g√∂re ses √ßal
            if (type === 'success') playSound('success');
            else if (type === 'error') playSound('error');

            toastTimeout = setTimeout(() => {
                toast.style.animation = 'toastOut 0.5s cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards';
                setTimeout(() => toast.remove(), 500);
            }, 3000);
        }

        function triggerBrowserPrint(title, htmlContent, customStyles = '', pageOrientation = 'portrait') {
            return new Promise((resolve) => {
                const printFrame = document.createElement('iframe');
                printFrame.style.position = 'absolute';
                printFrame.style.width = '0';
                printFrame.style.height = '0';
                printFrame.style.border = '0';
                document.body.appendChild(printFrame);

                const frameDoc = printFrame.contentDocument || printFrame.contentWindow.document;
                const printOnlyStyles = `
                @page {
                    size: A4 ${pageOrientation};
                    margin: 0;
                }
                body { margin: 0; padding: 0; }
                * { box-sizing: border-box; -webkit-print-color-adjust: exact !important; color-adjust: exact !important; }
                .report-sheet-wrapper { display: block !important; page-break-after: always; margin: 0; width: 100%; height: 100%; page-break-inside: avoid !important; }
                .report-sheet-wrapper:last-child { page-break-after: auto; }
                .report-sheet { box-shadow: none !important; border: none !important; margin: 0 !important; padding: 0 !important; width: 100% !important; height: 100% !important; page-break-inside: avoid !important; overflow: hidden; }
                .report-sheet-A4-portrait { width: 210mm; min-height: 297mm; }
                .report-sheet-A4-landscape { width: 297mm; min-height: 210mm; }
                .report-content { padding: 10mm !important; }
                ${customStyles}
            `;

                frameDoc.open();
                frameDoc.write(`
                <html>
                    <head>
                        <title>${title.replace(/[/\\?%*:|"<>]/g, '-')}</title>
                        <style>${printOnlyStyles}</style>
                    </head>
                    <body>${htmlContent}</body>
                </html>
            `);
                frameDoc.close();

                printFrame.contentWindow.onafterprint = () => {
                    document.body.removeChild(printFrame);
                    resolve();
                };

                printFrame.contentWindow.focus();
                printFrame.contentWindow.print();
            });
        }

        function openReportInNewPage(title, htmlContent, customStyles = '', pageOrientation = 'portrait') {
            playSound('save');
            const existingModal = document.getElementById('in-app-report-modal');
            if (existingModal) { existingModal.remove(); }
            const viewStyles = `
            #in-app-report-modal { position: fixed; inset: 0; z-index: 10002; background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(4px); display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s ease-out; }
            @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
            .toolbar { padding: 15px; background: #1e293b; text-align: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; gap: 1rem; }
            .toolbar button { background: #334155; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600; transition: all 0.2s ease; display: inline-flex; align-items: center; gap: 8px; }
            .toolbar button:hover { background: #475569; }
            .page-container { width: 95%; height: 95%; background-color: #f1f5f9; border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; }
            .report-content-wrapper { padding: 2rem; overflow-y: auto; flex-grow: 1; display: flex; flex-direction: column; align-items: center; }
            * { box-sizing: border-box; }
            .report-sheet { background: white !important; border: 1px solid #e2e8f0; padding: 0; color: black !important; box-shadow: 0 4px 20px rgba(0,0,0,0.1); position: relative; z-index: 1; overflow: hidden; margin: 0 auto 2rem auto; }
            .report-sheet, .report-sheet * { color: black !important; }
            .report-sheet table, .report-sheet th, .report-sheet td { color: black !important; background-color: white !important; }
            .report-sheet h1, .report-sheet h2, .report-sheet h3, .report-sheet h4, .report-sheet h5, .report-sheet h6 { color: black !important; }
            .report-sheet p, .report-sheet span, .report-sheet div, .report-sheet b, .report-sheet strong { color: black !important; }
            .report-sheet-A4-portrait { width: 210mm; height: 296.8mm; }
            .report-sheet-A4-landscape { width: 297mm; height: 209.8mm; }
            .report-content { padding: 15mm; height: 100%; }
            [contenteditable="true"] { outline: 2px solid transparent; transition: outline 0.2s ease; }
            [contenteditable="true"]:focus { outline-color: var(--primary-color); background-color: #f0f9ff; }
            ${customStyles}
        `;
            const modal = document.createElement('div');
            modal.id = 'in-app-report-modal';
            modal.innerHTML = `
            <style>${viewStyles}</style>
            <div class="page-container">
                <div class="toolbar">
                    <button id="print-report-btn">üñ®Ô∏è Yazdƒ±r</button>
                    <button id="pdf-report-btn">üìÑ PDF Olarak ƒ∞ndir</button>
                    <button id="close-report-btn" style="background: #ef4444;">‚ùå Kapat</button>
                </div>
                <div class="report-content-wrapper" id="report-print-area">${htmlContent}</div>
            </div>
        `;
            document.body.appendChild(modal);
            lucide.createIcons();
            document.getElementById('close-report-btn').addEventListener('click', () => { modal.remove(); });

            const handlePrint = () => {
                const printArea = document.getElementById('report-print-area');
                const editables = printArea.querySelectorAll('[contenteditable="true"]');
                editables.forEach(el => el.removeAttribute('contenteditable'));
                const printAreaHTML = printArea.innerHTML;
                editables.forEach(el => el.setAttribute('contenteditable', 'true'));

                triggerBrowserPrint(title, printAreaHTML, customStyles, pageOrientation);
            };

            document.getElementById('print-report-btn').addEventListener('click', handlePrint);

            // --- D√úZELTME: BO≈û SAYFA SORUNU TAM OLARAK Gƒ∞DERƒ∞LDƒ∞ ---
            const handlePDFDownload = async () => {
                const printArea = document.getElementById('report-print-area');
                const editables = printArea.querySelectorAll('[contenteditable="true"]');
                editables.forEach(el => el.removeAttribute('contenteditable'));

                const allPages = printArea.querySelectorAll('.report-sheet-wrapper');
                if (allPages.length === 0) {
                    showToast('PDF olu≈üturulamadƒ±: Rapor i√ßeriƒüi bulunamadƒ±.', 'error');
                    editables.forEach(el => el.setAttribute('contenteditable', 'true'));
                    return;
                }

                showToast('PDF olu≈üturuluyor, l√ºtfen bekleyin...', 'info');

                try {
                    // Sadece .report-sheet elementlerini al (wrapper olmadan)
                    const reportSheets = [];
                    allPages.forEach(wrapper => {
                        const sheet = wrapper.querySelector('.report-sheet');
                        if (sheet) {
                            reportSheets.push(sheet.cloneNode(true));
                        }
                    });

                    if (reportSheets.length === 0) {
                        showToast('PDF olu≈üturulamadƒ±: Rapor i√ßeriƒüi bulunamadƒ±.', 'error');
                        editables.forEach(el => el.setAttribute('contenteditable', 'true'));
                        return;
                    }

                    // Tek container'da t√ºm sayfalarƒ± birle≈ütir
                    const pdfContainer = document.createElement('div');
                    pdfContainer.style.width = '100%';

                    reportSheets.forEach((sheet, index) => {
                        // Her sayfanƒ±n stilini ayarla
                        sheet.style.pageBreakBefore = (index > 0) ? 'always' : 'auto';
                        sheet.style.pageBreakAfter = 'auto';
                        sheet.style.pageBreakInside = 'avoid';
                        sheet.style.margin = '0';
                        sheet.style.padding = '0';

                        pdfContainer.appendChild(sheet);
                    });

                    const opt = {
                        margin: 0,
                        filename: `${title.replace(/[/\\?%*:|"<>]/g, '-')}.pdf`,
                        image: { type: 'jpeg', quality: 0.98 },
                        html2canvas: {
                            scale: 2,
                            useCORS: true,
                            letterRendering: true,
                            scrollX: 0,
                            scrollY: 0
                        },
                        jsPDF: {
                            unit: 'mm',
                            format: 'a4',
                            orientation: pageOrientation,
                            compress: true
                        },
                        pagebreak: {
                            mode: ['css', 'legacy']
                        }
                    };

                    await html2pdf().set(opt).from(pdfContainer).save();
                    showToast('PDF ba≈üarƒ±yla indirildi!', 'success');
                } catch (error) {
                    console.error('PDF indirme hatasƒ±:', error);
                    showToast('PDF indirme sƒ±rasƒ±nda bir hata olu≈ütu.', 'error');
                } finally {
                    editables.forEach(el => el.setAttribute('contenteditable', 'true'));
                }
            };

            document.getElementById('pdf-report-btn').addEventListener('click', handlePDFDownload);
        }

        function validateRequiredCentralFields() { const requiredFields = [{ id: 'fullName', name: 'Adƒ± Soyadƒ±' }, { id: 'title', name: 'Unvanƒ±' }, { id: 'amirAdi', name: 'Amir Adƒ±' }, { id: 'amirUnvani', name: 'Amir Unvanƒ±' }]; let missingFields = []; requiredFields.forEach(field => { const el = document.getElementById(field.id); if (!el || el.value.trim() === '') { missingFields.push(field.name); if (el) el.classList.add('error-highlight') } else { if (el) el.classList.remove('error-highlight') } }); if (missingFields.length > 0) { showToast("Eksik bilgi giri≈üi tespit edildi. L√ºtfen t√ºm gerekli alanlarƒ± doldurun.", "error"); const centralInfoTab = document.querySelector('.tab-btn[data-tab="centralInfoSection"]'); if (!centralInfoTab.classList.contains('active')) { centralInfoTab.click() } return false } return true }
        function generateYollukReportPage() {
            const openCard = document.querySelector('.travel-card:not(.is-collapsed)');
            if (openCard) {
                showToast("Rapor olu≈üturmadan √∂nce a√ßƒ±k seyahat kartƒ±nƒ± kapatƒ±n.", "warning");
                requestCloseTravelCard(openCard);
                return;
            }
            if (!validateRequiredCentralFields()) return;
            try {
                const reportHTML = generateYollukReportHTML();
                if (!reportHTML) return;

                const content = `<div class="report-sheet-wrapper"><div class="report-sheet report-sheet-A4-landscape"><div class="report-content">${reportHTML}</div></div></div>`;

const styles = `
                /* --- 1. GENEL AYARLAR --- */
                .report-sheet {
                    font-family: 'Times New Roman', Times, serif !important;
                    padding: 15px !important;
                }

                .main-content-table * {
                    font-size: 10px !important;
                    line-height: 1.2 !important;
                    color: #000 !important;
                    box-sizing: border-box !important;
                }

                /* --- 2. TABLO DI≈û ƒ∞SKELETƒ∞ (1.6PX - TAM AYAR) --- */
                .main-content-table {
                    width: 100%;
                    border-collapse: collapse !important;
                    margin-bottom: 5px;
                    border: 1.6px solid #000 !important;
                }

                /* --- 3. √úST KISIM: BA≈ûLIKLAR (360 DERECE - 1.6PX) --- */
                .header-info-row td, 
                .main-header th,
                .title-cell,
                .label-cell,
                .value-cell {
                    border: 1.6px solid #000 !important;
                    background-color: #fcfcfc !important;
                }

                /* --- 4. √ñZEL H√úCRE AYARLARI --- */
                .main-header th {
                    font-weight: 700 !important;
                    vertical-align: middle !important;
                    text-align: center !important;
                }

                .title-cell {
                    text-align: center !important;
                    vertical-align: middle !important;
                    font-size: 13px !important;
                    font-weight: 800 !important;
                }

                /* --- 5. ALT KISIM: VERƒ∞ SATIRLARI (1PX) --- */
                .main-content-table tbody td {
                    border: 1px solid #444 !important; 
                    padding: 3px !important;
                    vertical-align: middle;
                    text-align: center;
                }

                /* --- 6. YASAL UYARI (NORMAL FONT) --- */
                .report-content > p {
                    font-size: 11px !important;
                    font-weight: normal !important;
                    margin-top: 5px !important;
                    text-align: center !important;
                }

                /* --- 7. Hƒ∞ZALAMALAR --- */
                .label-cell { text-align: left !important; padding-left: 5px !important; font-weight: 700 !important; }
                .value-cell { text-align: left !important; padding-left: 5px !important; font-weight: 500 !important; }

                .main-content-table td:nth-child(2),
                .main-content-table td:nth-child(8) {
                    text-align: left !important;
                    white-space: normal !important;
                    padding-left: 4px !important;
                }

                .main-content-table td:nth-child(1), .main-content-table td:nth-child(3), 
                .main-content-table td:nth-child(4), .main-content-table td:nth-child(5), 
                .main-content-table td:nth-child(9), .main-content-table td:nth-child(12) 
                { white-space: nowrap !important; }

                /* Yƒ±l Kutucuklarƒ± */
                .year-box-container { display: flex; justify-content: center; gap: 2px; }
                .year-box {
                    display: inline-flex; align-items: center; justify-content: center;
                    width: 16px; height: 16px;
                    border: 1px solid #000 !important;
                    font-weight: bold; background: #fff;
                }

/* --- 8. ALT TOPLAM --- */
.total-row td {
    font-weight: 800 !important;
    background-color: #fcfcfc !important;
    border: 1.6px solid #000 !important;
    text-align: center !important; /* Rakamlarƒ± yatayda ortalar */
    vertical-align: middle !important; /* Rakamlarƒ± dikeyde ortalar */
}

/* "TOPLAM" yazƒ±sƒ±nƒ±n saƒüa yaslƒ± kalmasƒ±nƒ± garanti eder */
.total-row td:first-child {
    text-align: right !important;
    padding-right: 10px !important;
}

                /* --- 9. ƒ∞MZA B√ñL√úM√ú --- */
                .footer-table { 
                    width: 100%; 
                    margin-top: 35px !important; 
                    font-size: 10px !important;
                }
                
                .signature-section td { 
                    border: none !important; 
                    text-align: center; 
                    vertical-align: top !important;
                }

                .footer-table p { 
                    margin: 2px 0 !important; 
                    padding: 0 !important; 
                }

                .footer-table p:nth-child(3) { 
                    margin-bottom: 30px !important; 
                }
            `;
                openReportInNewPage("Yurti√ßi Ge√ßici G√∂rev Yolluƒüu Bildirimi", content, styles, 'landscape');
                showToast("Yolluk raporu olu≈üturuldu", "success")
            } catch (error) {
                console.error("Yolluk Raporu Hatasƒ±:", error);
                showToast("Rapor olu≈üturulurken bir hata olu≈ütu: " + error.message, "error")
            }
        }
        function generateGorevEmriReportPage() { const openCard = document.querySelector('.travel-card:not(.is-collapsed)'); if (openCard) { showToast("Rapor olu≈üturmadan √∂nce a√ßƒ±k seyahat kartƒ±nƒ± kapatƒ±n.", "warning"); requestCloseTravelCard(openCard); return } if (!validateRequiredCentralFields()) return; try { const reportHTML = generateGorevEmriReportHTML(); if (!reportHTML) return; const content = `<div class="report-sheet-wrapper"><div class="report-sheet report-sheet-A4-portrait"><div class="report-content">${reportHTML}</div></div></div>`; const styles = `.report-sheet{font-size:12px;line-height:1.4}h3{text-align:center;margin:0 0 20px 0;font-size:16px;font-weight:700}table{width:100%;border-collapse:collapse;table-layout:auto;margin-bottom:15px;font-size:10px}tr{height:30px}th,td{border:1px solid #000;padding:4px 5px;vertical-align:middle;white-space:normal;font-size:9px}th{font-weight:700;text-align:center;background-color:#f5f5f5;font-size:8px}td{text-align:center;font-size:9px}td:last-child{text-align:left}.no-border td{border:none!important;padding:2px 4px}.header-table{margin-bottom:20px;font-size:12px}.footer-table{margin-top:25px;font-size:11px}`; openReportInNewPage("ƒ∞l ƒ∞√ßi Aylƒ±k G√∂revlendirme Olur'u", content, styles, 'portrait'); showToast("G√∂rev emri raporu olu≈üturuldu", "success") } catch (error) { showToast("Rapor olu≈üturulurken bir hata olu≈ütu: " + error.message, "error") } }
        function generateAraziIfaPage() { const openCard = document.querySelector('.travel-card:not(.is-collapsed)'); if (openCard) { showToast("Rapor olu≈üturmadan √∂nce a√ßƒ±k seyahat kartƒ±nƒ± kapatƒ±n.", "warning"); requestCloseTravelCard(openCard); return } if (!validateRequiredCentralFields()) return; try { const reportHTML = generateAraziIfaHTML(); if (!reportHTML) return; const content = `<div class="report-sheet-wrapper"><div class="report-sheet report-sheet-A4-portrait"><div class="report-content">${reportHTML}</div></div></div>`; const styles = `.report-sheet{font-size:10px;line-height:1.2}h3{text-align:center;margin:0 0 15px 0;font-size:14px;font-weight:700}table{width:100%;border-collapse:collapse;font-size:9px;table-layout:fixed;margin-bottom:10px}tr{height:22px}th,td{border:1px solid #000;padding:2px 3px;text-align:left;vertical-align:middle;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:9px}th{font-weight:700;font-size:8px}.center{text-align:center}.no-border,.no-border td{border:none;padding:1px 2px}.header-info{margin-bottom:15px;table-layout:auto;font-size:10px}.header-info td{padding:2px 4px}.main-table th{text-align:center}`; openReportInNewPage("3 Aylƒ±k √ñzel Hizmet Tazminatƒ± ƒ∞fa √áetveli", content, styles, 'portrait'); showToast("Arazi ifa √ßetveli olu≈üturuldu", "success") } catch (error) { showToast("Rapor olu≈üturulurken bir hata olu≈ütu: " + error.message, "error") } }
        function generateAraziPuantajPage() { const openCard = document.querySelector('.travel-card:not(.is-collapsed)'); if (openCard) { showToast("Rapor olu≈üturmadan √∂nce a√ßƒ±k seyahat kartƒ±nƒ± kapatƒ±n.", "warning"); requestCloseTravelCard(openCard); return } if (!validateRequiredCentralFields()) return; try { const reportHTML = generateAraziPuantajHTML(); if (!reportHTML) return; const content = `<div class="report-sheet-wrapper"><div class="report-sheet report-sheet-A4-landscape"><div class="report-content">${reportHTML}</div></div></div>`; const styles = `.report-sheet{font-size:10px;line-height:1.3}table{width:100%;border-collapse:collapse;font-size:10px;margin-bottom:10px;table-layout:fixed}tr{height:26px}th,td{border:1px solid #000;padding:3px 2px;text-align:center;vertical-align:middle;font-size:10px}th{font-weight:700;font-size:9px}.day-cell{width:1.8%}.no-border,.no-border td{border:none;padding:2px 4px}.header-info-container{display:flex;justify-content:space-between;font-size:12px;margin-bottom:15px}`; openReportInNewPage("3 Aylƒ±k Arazi Tazminatƒ± Puantaj Cetveli", content, styles, 'landscape'); showToast("Arazi puantaj cetveli olu≈üturuldu", "success") } catch (error) { showToast("Rapor olu≈üturulurken bir hata olu≈ütu: " + error.message, "error") } }
        function generateKontrolPuantajPage() { const openCard = document.querySelector('.travel-card:not(.is-collapsed)'); if (openCard) { showToast("Rapor olu≈üturmadan √∂nce a√ßƒ±k seyahat kartƒ±nƒ± kapatƒ±n.", "warning"); requestCloseTravelCard(openCard); return } if (!validateRequiredCentralFields()) return; try { const html = generateKontrolPuantajHTML(); if (!html) return; const styles = `.report-sheet{font-size:11px;line-height:1.3}h3,h4{text-align:center;margin:0;font-weight:700}h3{font-size:14px;margin-bottom:2px}h4{font-size:11px;font-weight:400;margin-bottom:20px}.main-table{width:100%;border-collapse:collapse;font-size:10px;table-layout:fixed}.main-table tr{height:25px}.main-table th,.main-table td{border:1px solid #000;padding:2px;vertical-align:middle;text-align:center;word-wrap:break-word}.main-table th{font-weight:700;font-size:9px}.main-table .aciklama-cell{text-align:left;font-size:8px;line-height:1.2}.imza-table{margin-top:25px;font-size:11px;width:100%;border-collapse:collapse}.imza-table td{border:none;text-align:center;vertical-align:bottom}`; openReportInNewPage("Kontrol Hizmetlerine ƒ∞li≈ükin Puantaj Tablosu", html, styles, 'portrait'); showToast("Kontrol puantaj tablosu olu≈üturuldu", "success") } catch (error) { showToast("Rapor olu≈üturulurken bir hata olu≈ütu: " + error.message, "error"); console.error("Kontrol puantaj tablosu olu≈üturulurken hata:", error) } }
        function generateKontrolCizelgePage() { const openCard = document.querySelector('.travel-card:not(.is-collapsed)'); if (openCard) { showToast("Rapor olu≈üturmadan √∂nce a√ßƒ±k seyahat kartƒ±nƒ± kapatƒ±n.", "warning"); requestCloseTravelCard(openCard); return } if (!validateRequiredCentralFields()) return; try { const reportHTML = generateKontrolCizelgeHTML(); if (!reportHTML) return; const content = `<div class="report-sheet-wrapper"><div class="report-sheet report-sheet-A4-landscape"><div class="report-content">${reportHTML}</div></div></div>`; const styles = `.report-sheet{font-size:10px;line-height:1.3}h3{font-size:14px;text-align:center;font-weight:700;margin-bottom:20px}.main-table{width:100%;border-collapse:collapse;font-size:10px;table-layout:fixed}.main-table th,.main-table td{border:1px solid #000;padding:4px 2px;text-align:center;vertical-align:middle}.main-table th{font-weight:700;font-size:9px}.day-cell{width:2%}.info-table{margin-bottom:20px;font-size:11px;width:100%}.info-table td{border:none;padding:2px}.imza-table{margin-top:40px;font-size:11px;width:100%}.imza-table td{border:none;text-align:right}`; openReportInNewPage("ƒ∞lave Kontrol Hizmetleri √áalƒ±≈üma G√ºnleri √áizelgesi", content, styles, 'landscape'); showToast("Kontrol √ßizelgesi olu≈üturuldu", "success") } catch (error) { showToast("Rapor olu≈üturulurken bir hata olu≈ütu: " + error.message, "error"); console.error("Kontrol √ßizelgesi olu≈üturulurken hata:", error) } }

        function generateKontrolPuantajHTML() { const selectedMonths = Array.from(document.getElementById('kontrolMonthFilter').selectedOptions).map(opt => parseInt(opt.value)); const year = parseInt(document.getElementById('budgetYear').value); const maxControlDays = parseInt(document.getElementById('maxControlDays').value) || 0; if (selectedMonths.length === 0) { showToast("L√ºtfen en az bir rapor ayƒ± se√ßin.", "warning"); return null } const validControlDays = getValidKontrolDays(selectedMonths, year); const kontrolTuru = document.getElementById("kontrolTuru").value || "Belge Kontrol√º"; const kontrolMevzuat = document.getElementById("kontrolMevzuat").value || "4915"; const kontrolBaslangic = document.getElementById("kontrolBaslangic").value || "09:00"; const kontrolBitis = document.getElementById("kontrolBitis").value || "16:00"; const kontrolAciklama = document.getElementById("kontrolAciklama").value || ""; const amirAdi = document.getElementById("kontrolAmirAdi").value || document.getElementById("amirAdi").value; const amirUnvani = document.getElementById("kontrolAmirUnvani").value || document.getElementById("amirUnvani").value; let allPagesHTML = ''; selectedMonths.forEach(month => { let daysForMonth = validControlDays.filter(d => d.getMonth() + 1 === month); if (maxControlDays > 0 && daysForMonth.length > maxControlDays) { daysForMonth = daysForMonth.slice(0, maxControlDays); showToast(`${turkceAylar[month - 1]} ayƒ± i√ßin ${maxControlDays} g√ºn sƒ±nƒ±rƒ± uygulandƒ±.`, "info") } if (daysForMonth.length === 0) return; let dutyRows = ''; daysForMonth.forEach(day => { dutyRows += `<tr><td contenteditable="true">${day.toLocaleDateString('tr-TR')}</td><td contenteditable="true">${kontrolTuru}</td><td contenteditable="true">${kontrolMevzuat}</td><td class="aciklama-cell" contenteditable="true">${kontrolAciklama}</td><td contenteditable="true">${kontrolBaslangic}</td><td contenteditable="true">${kontrolBitis}</td></tr>` }); const totalRows = 18; for (let i = daysForMonth.length; i < totalRows; i++) { dutyRows += `<tr><td style="height: 25px;">&nbsp;</td><td></td><td></td><td></td><td></td><td></td></tr>` } const pageHTML = `<div class="report-sheet-wrapper"><div class="report-sheet report-sheet-A4-portrait"><div class="report-content"><h3>KONTROL Hƒ∞ZMETLERƒ∞NE ƒ∞Lƒ∞≈ûKƒ∞N PUANTAJ TABLOSU (EK-1)</h3><h4>(Deƒüi≈üik:1/2/2024 tarihli ve 12843329 sayƒ±lƒ± Olur/6.md)</h4><table class="no-border" style="width: 100%; font-size: 11px; margin-bottom: 15px;"><tr><td style="text-align: right;"><b>Ait Olduƒüu Yƒ±l:</b> ${year} &nbsp;&nbsp; <b>Ay:</b> ${turkceAylar[month - 1]}</td></tr></table><table class="main-table"><thead><tr><th rowspan="2" style="width:12%">Tarih</th><th rowspan="2" style="width:15%">Kontrol T√ºr√º (1)</th><th rowspan="2" style="width:10%">Kontrol T√ºr√ºn√ºn Dayandƒ±ƒüƒ± Mevzuat (2)</th><th rowspan="2" style="width:45%">A√ßƒ±klama</th><th colspan="2" style="width:18%">Saat Aralƒ±ƒüƒ±</th></tr><tr><th style="width:9%">Ba≈ülangƒ±√ß</th><th style="width:9%">Biti≈ü</th></tr></thead><tbody>${dutyRows}</tbody></table><table class="imza-table"><tr><td style="width: 50%;">&nbsp;</td><td style="width: 50%; text-align: right; padding-right: 20px;"><div style="display: inline-block; text-align: center;">Kontrol G√∂revini Y√ºr√ºten Personel<br>...../...../${year}<br><br><b contenteditable="true">${document.getElementById("fullName").value}</b><br><span contenteditable="true">${document.getElementById("title").value}</span></div></td></tr><tr><td colspan="2" style="text-align: center; padding-top: 30px;">...../...../${year}<br><br><b contenteditable="true">${amirAdi}</b><br><span contenteditable="true">${amirUnvani}</span></td></tr></table></div></div></div>`; allPagesHTML += pageHTML }); if (allPagesHTML === '') { showToast(`Se√ßilen aylar i√ßin ge√ßerli bir kontrol g√ºn√º bulunamadƒ±.`, "warning"); return null } return allPagesHTML }

        function generateKontrolCizelgeHTML() {
            const selectedMonths = Array.from(document.getElementById('kontrolMonthFilter').selectedOptions).map(opt => parseInt(opt.value)); const year = parseInt(document.getElementById('budgetYear').value); const maxControlDays = parseInt(document.getElementById('maxControlDays').value) || 0; if (selectedMonths.length === 0) { showToast("L√ºtfen en az bir rapor ayƒ± se√ßin.", "warning"); return null } const validControlDays = getValidKontrolDays(selectedMonths, year); const amirAdi = document.getElementById("kontrolAmirAdi").value || document.getElementById("amirAdi").value; const amirUnvani = document.getElementById("kontrolAmirUnvani").value || document.getElementById("amirUnvani").value; const monthNames = selectedMonths.map(m => turkceAylar[m - 1]).join(', '); let reportHTML = `<h3>ƒ∞LAVE KONTROL Hƒ∞ZMETLERƒ∞ KAPSAMINDA √áALI≈ûILAN PERSONELƒ∞N √áALI≈ûTIƒûI G√úNLERƒ∞ G√ñSTERƒ∞R √áƒ∞ZELGE</h3>`; reportHTML += `<table class="info-table"><tr><td style="width: 80px;"><b>Kurum</b></td><td style="width: 10px;">:</td><td>${document.getElementById("department").value}</td><td style="width: 120px; text-align: right;"><b>Ait Olduƒüu Ay</b></td><td style="width: 10px;">:</td><td style="width: 150px;">${monthNames}</td></tr><tr><td><b>ƒ∞≈ü Yeri</b></td><td>:</td><td>${document.getElementById("birim").value}</td><td style="text-align: right;"><b>B√ºt√ße Yƒ±lƒ±</b></td><td>:</td><td>${year}</td></tr></table>`; let dayHeaders = ''; for (let i = 1; i <= 31; i++) { dayHeaders += `<th class="day-cell">${i}</th>` }
            let monthRowsHTML = ''; const numMonths = selectedMonths.length; if (numMonths > 0) {
                selectedMonths.forEach((month, index) => {
                    let daysForThisMonth = validControlDays.filter(d => d.getMonth() + 1 === month).map(d => d.getDate()); if (maxControlDays > 0 && daysForThisMonth.length > maxControlDays) { daysForThisMonth = daysForThisMonth.slice(0, maxControlDays) } let dayCells = ''; for (let i = 1; i <= 31; i++) { dayCells += `<td class="day-cell">${daysForThisMonth.includes(i) ? 'X' : ''}</td>` }
                    if (index === 0) {
                        monthRowsHTML += `<tr><td>${index + 1}</td><td rowspan="${numMonths}" style="vertical-align: middle;">${document.getElementById("fullName").value}</td><td rowspan="${numMonths}" style="vertical-align: middle;">${document.getElementById("title").value}</td><td>${turkceAylar[month - 1]}</td>${dayCells}<td>${daysForThisMonth.length}</td><td rowspan="${numMonths}" style="vertical-align: middle;"></td></tr>`;
                    } else {
                        monthRowsHTML += `<tr><td>${index + 1}</td><td>${turkceAylar[month - 1]}</td>${dayCells}<td>${daysForThisMonth.length}</td></tr>`;
                    }
                });
            }
            const monthsWithControl = selectedMonths.filter(month => { let daysForThisMonth = validControlDays.filter(d => d.getMonth() + 1 === month); if (maxControlDays > 0) daysForThisMonth = daysForThisMonth.slice(0, maxControlDays); return daysForThisMonth.length > 0 }).map(m => turkceAylar[m - 1]); const monthsText = monthsWithControl.length > 0 ? monthsWithControl.join(' ') : monthNames; const controlText = monthsWithControl.length > 0 ? `${year} yƒ±lƒ± ${monthsText} ${monthsWithControl.length === 1 ? 'ayƒ±nda' : 'aylarƒ±nda'} kontrol hizmeti y√ºr√ºt√ºlm√º≈üt√ºr.` : `${year} yƒ±lƒ± ${monthNames} ${monthNames.length === 1 ? 'ayƒ±nda' : 'aylarƒ±nda'} kontrol hizmeti y√ºr√ºt√ºlmemi≈ütir.`; reportHTML += `<table class="main-table"><thead><tr><th rowspan="2" style="width: 4%;">Sƒ±ra No</th><th rowspan="2" style="width: 12%;">Adƒ± Soyadƒ±</th><th rowspan="2" style="width: 10%;">Unvanƒ±</th><th rowspan="2" style="width: 8%;">Ait Olduƒüu Ay</th><th colspan="31">KONTROL G√ñREVƒ∞Nƒ∞N YAPILDIƒûI G√úNLER</th><th rowspan="2" style="width: 5%;">Aylƒ±k √áalƒ±≈ütƒ±ƒüƒ± G√ºn Sayƒ±sƒ±</th><th rowspan="2" style="width: 5%;">ƒ∞mza</th></tr><tr>${dayHeaders}</tr></thead><tbody>${monthRowsHTML}</tbody></table><p style="margin-top: 20px; text-align: left;">Yukarƒ±da belirtilen teknik eleman ${controlText}</p><table class="imza-table"><tr><td style="text-align: right; padding-right: 20px;"><div style="display: inline-block; text-align: center;"><div>Uygundur</div><div style="margin-top: 10px;">....../....../${year}</div><div style="margin-top: 25px; font-weight: bold;" contenteditable="true">${amirAdi}</div><div style="font-size: 10px; margin-top: 5px;" contenteditable="true">${amirUnvani}</div></div></td></tr></table>`; return reportHTML
        }

        function generateYollukReportHTML() {
    const dailyRate = parseFloat(document.getElementById("dailyRate").value) || 0;
    const accommodationRate = parseFloat(document.getElementById("accommodationRate").value) || 0;
    const selectedMonthOptions = Array.from(document.getElementById('yollukMonthFilter').selectedOptions);
    const selectedMonths = selectedMonthOptions.map(opt => parseInt(opt.value, 10));

    if (selectedMonths.length === 0) {
        showToast("L√ºtfen en az bir rapor ayƒ± se√ßin.", "warning");
        return null;
    }

    const selectAll = selectedMonths.includes(0);
    const year = document.getElementById("budgetYear").value.toString();
    const y1 = year[0] || '';
    const y2 = year[1] || '';
    const y3 = year[2] || '';
    const y4 = year[3] || '';

    const g√∂revYeri = document.getElementById("g√∂revYeri").value || "Sinop";
    let allReportItems = [];
    let totalDailyAmount = 0;
    let totalAccommodationCost = 0;
    let totalTransportCost = 0;
    const oneDay = 864e5;

    // --- Seyahat Kartlarƒ±nƒ± D√∂ng√ºye Al ---
    document.querySelectorAll(".travel-card").forEach(row => {
        const type = row.querySelector('.gorev-tipi-select').value;
        let taskStartDate, taskEndDate;

        if (type === 'gunubirlik') {
            const dateStr = row.querySelector(".travel-date").value;
            if (!dateStr || isNaN(new Date(dateStr).getTime())) return;
            taskStartDate = taskEndDate = new Date(dateStr);
        } else {
            const startDateStr = row.querySelector(".coklu-start-date").value;
            const endDateStr = row.querySelector(".coklu-end-date").value;
            if (!startDateStr || !endDateStr || isNaN(new Date(startDateStr).getTime()) || isNaN(new Date(endDateStr).getTime())) return;
            taskStartDate = new Date(startDateStr);
            taskEndDate = new Date(endDateStr);
        }

        if (!selectAll) {
            const month = taskStartDate.getMonth() + 1;
            if (!selectedMonths.includes(month)) return;
        }

        // Ta≈üƒ±tlarƒ± Topla
        const allTransportsForRow = [];
        row.querySelectorAll('.transport-entry').forEach((tr, index) => {
            allTransportsForRow.push({
                id: `transport-${row.id}-${index}`,
                date: tr.querySelector('.transport-date').value,
                type: tr.querySelector('.transport-type').value,
                description: tr.querySelector('.transport-description').value,
                cost: parseFloat(tr.querySelector('.transport-cost').value) || 0
            });
        });

        const processedTransportIds = new Set();

        // --- G√úN√úBƒ∞RLƒ∞K HESABI ---
        if (type === 'gunubirlik') {
            const allowance = calculateAllowance(row.querySelector(".travel-start").value, row.querySelector(".travel-end").value, false);
            let rawRoute = row.querySelector(".travel-route").value;
            
            // G√ºn√ºbirlik temizlik: Ayƒ±rƒ±cƒ±larƒ± standartla≈ütƒ±r
            // Kullanƒ±cƒ± virg√ºl, tire veya sla≈ü kullanmƒ±≈üsa hepsini b√ºy√ºkt√ºr (>) i≈üaretine √ßevirir
            let cleanRoute = rawRoute.replace(/[-/,]+/g, ' > '); 
            
            // Eƒüer kullanƒ±cƒ± sadece "Kastamonu" yazdƒ±ysa "Sinop > Kastamonu > Sinop" yapar
            let route = (cleanRoute && !cleanRoute.includes(g√∂revYeri)) ? `${g√∂revYeri} > ${cleanRoute} > ${g√∂revYeri}` : cleanRoute;

            let attachedTransport = null;
            if (allTransportsForRow.length > 0) {
                attachedTransport = {
                    type: allTransportsForRow.map(t => `${t.type} (${t.description})`).join(', '),
                    amount: allTransportsForRow.reduce((sum, t) => sum + t.cost, 0)
                };
                allTransportsForRow.forEach(t => processedTransportIds.add(t.id));
            }

            if ((allowance && allowance.val > 0) || attachedTransport) {
                allReportItems.push({
                    sortDate: taskStartDate,
                    type: 'gundelik',
                    date: taskStartDate,
                    route: route,
                    start: row.querySelector(".travel-start").value,
                    end: row.querySelector(".travel-end").value,
                    dayCount: allowance.str,
                    dailyRate: dailyRate,
                    dailyAmount: dailyRate * allowance.val,
                    attachedTransport: attachedTransport
                });
            }
        } 
        // --- √áOKLU G√úN HESABI (Zƒ∞NCƒ∞RLEME & STANDART) ---
        else {
            if (taskEndDate.getTime() < taskStartDate.getTime()) return;

            const destination = row.querySelector(".travel-route").value;
            
            // === AKILLI AYIRICI ===
            // Tire (-), Virg√ºl (,), Taksim (/), B√ºy√ºkt√ºr (>) i≈üaretlerinin hepsini kabul eder.
            // √ñrn: "Karab√ºk, Bartƒ±n" veya "Karab√ºk/Bartƒ±n" veya "Karab√ºk - Bartƒ±n" hepsi √ßalƒ±≈üƒ±r.
            const stops = destination.split(/[-/>,]+/).map(s => s.trim()).filter(s => s && s.toLowerCase() !== g√∂revYeri.toLowerCase());
            
            const totalDays = Math.round((taskEndDate - taskStartDate) / oneDay) + 1;
            const totalAccommodation = parseFloat(row.querySelector(".coklu-accommodation").value) || 0;
            const geceSayisi = Math.max(1, totalDays - 1);
            
            let currentLoopDate = new Date(taskStartDate);
            let currentLocation = g√∂revYeri; 
            let stopIndex = 0; 

            for (let i = 0; i < totalDays; i++) {
                let routeText = "";
                
                // --- SON G√úN (D√ñN√ú≈û) ---
                if (i === totalDays - 1) {
                    // Kalan ≈üehirler varsa hepsini ekle (Zonguldak > Bolu > Sinop gibi)
                    let remainingStops = "";
                    if (stopIndex < stops.length) {
                        remainingStops = " > " + stops.slice(stopIndex).join(" > ");
                    }
                    // "(D√∂n√º≈ü)" ibaresi silindi, sadece temiz rota
                    routeText = `${currentLocation}${remainingStops} > ${g√∂revYeri}`;
                } 
                // --- ARA G√úNLER ---
                else {
                    if (stopIndex < stops.length) {
                        const nextStop = stops[stopIndex];
                        routeText = `${currentLocation} > ${nextStop}`;
                        currentLocation = nextStop;
                        stopIndex++;
                    } else {
                        // Durak bitti, otelde kalƒ±yor
                        routeText = `${currentLocation} (Mahallinde)`;
                    }
                }

                // Ta≈üƒ±t
                const dateStr = currentLoopDate.toISOString().split('T')[0];
                const daysTransports = allTransportsForRow.filter(t => t.date === dateStr);
                let attachedTransport = null;
                if (daysTransports.length > 0) {
                    attachedTransport = {
                        type: daysTransports.map(t => `${t.type} (${t.description})`).join(', '),
                        amount: daysTransports.reduce((sum, t) => sum + t.cost, 0)
                    };
                    daysTransports.forEach(t => processedTransportIds.add(t.id));
                }

                // Konaklama (Son geceye toplam yazar)
                let attachedExpense = null;
                if (i === totalDays - 2 && totalAccommodation > 0) {
                    const limit = dailyRate * accommodationRate * geceSayisi;
                    const reimbursable = Math.min(totalAccommodation, limit);
                    attachedExpense = {
                        type: `Konaklama (${geceSayisi} Gece Toplamƒ±)`,
                        amount: reimbursable
                    };
                }

                allReportItems.push({
                    sortDate: new Date(currentLoopDate),
                    type: 'gundelik',
                    date: new Date(currentLoopDate),
                    route: routeText,
                    dayCount: 1,
                    dailyRate: dailyRate,
                    dailyAmount: dailyRate,
                    attachedTransport: attachedTransport,
                    attachedExpense: attachedExpense
                });

                currentLoopDate.setDate(currentLoopDate.getDate() + 1);
            }

            // Kalan manuel ta≈üƒ±tlar
            allTransportsForRow.filter(t => !processedTransportIds.has(t.id)).forEach(t => {
                allReportItems.push({
                    sortDate: new Date(t.date),
                    type: 'tasit',
                    date: new Date(t.date),
                    route: t.description,
                    expenseType: t.type,
                    expenseAmount: t.cost
                });
            });
        }
    });

    // --- Sƒ±ralama ve Tablo Olu≈üturma ---
    allReportItems.sort((a, b) => a.sortDate.getTime() - b.sortDate.getTime());

    let reportRows = [];
    allReportItems.forEach(item => {
        const f = n => n ? n.toFixed(2).replace(".", ",") : "0,00";
        let dateStr = item.date.toLocaleDateString("tr-TR");
        
        if (item.type === 'gundelik') {
            totalDailyAmount += item.dailyAmount;
            const konaklamaTuru = item.attachedExpense ? item.attachedExpense.type : '';
            const konaklamaTutari = item.attachedExpense ? item.attachedExpense.amount : 0;
            totalAccommodationCost += konaklamaTutari;
            const tasitTuru = item.attachedTransport ? item.attachedTransport.type : '';
            const tasitTutari = item.attachedTransport ? item.attachedTransport.amount : 0;
            totalTransportCost += tasitTutari;

            const expenseTuru = [konaklamaTuru, tasitTuru].filter(Boolean).join(' + ');
            const expenseTutari = konaklamaTutari + tasitTutari;
            const total = item.dailyAmount + expenseTutari;

            reportRows.push(`<tr><td>${dateStr}</td><td>${item.route}</td><td>${item.start || ''}</td><td>${item.end || ''}</td><td>${item.dayCount}</td><td>${f(item.dailyRate)}</td><td>${f(item.dailyAmount)}</td><td>${expenseTuru}</td><td>${f(expenseTutari)}</td><td></td><td></td><td>${f(total)}</td></tr>`);
        } else if (item.type === 'tasit') {
            totalTransportCost += item.expenseAmount;
            reportRows.push(`<tr><td>${dateStr}</td><td>${item.route}</td><td></td><td></td><td></td><td></td><td></td><td>${item.expenseType}</td><td>${f(item.expenseAmount)}</td><td></td><td></td><td>${f(item.expenseAmount)}</td></tr>`);
        }
    });

    const grandTotal = totalDailyAmount + totalAccommodationCost + totalTransportCost;
    let travelRowsHtml = reportRows.join("");
    const maxRows = 15;
    for (let i = reportRows.length; i < maxRows; i++) {
        travelRowsHtml += `<tr><td>&nbsp;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>`;
    }

    // HTML √áƒ±ktƒ±sƒ±
    return `
    <table class="main-content-table">
    <thead>
        <tr class="header-info-row">
            <td colspan="1" class="label-cell">Adƒ± Soyadƒ±</td>
            <td colspan="1" class="value-cell left-align">${document.getElementById("fullName").value}</td>
            <td colspan="6" rowspan="4" class="title-cell">YURTƒ∞√áƒ∞ / GE√áƒ∞Cƒ∞ G√ñREV YOLLUƒûU Bƒ∞LDƒ∞Rƒ∞Mƒ∞</td>
            <td colspan="4" class="value-cell" style="border-bottom: 1px solid transparent !important;"> </td> 
        </tr>
        <tr class="header-info-row">
            <td colspan="1" class="label-cell">Unvanƒ±</td>
            <td colspan="1" class="value-cell left-align">${document.getElementById("title").value}</td>
            <td colspan="4" class="value-cell" style="border-top: 1px solid transparent !important;"> </td>
        </tr>
        <tr class="header-info-row">
            <td colspan="1" class="label-cell">Aylƒ±k Kadro Derecesi ve<br>Ek G√∂stergesi</td>
            <td colspan="1" class="value-cell left-align">${document.getElementById("degree").value}</td>
            <td colspan="1" class="label-cell">Dairesi</td>
            <td colspan="3" class="value-cell left-align">${document.getElementById("department").value}</td>
        </tr>
        <tr class="header-info-row">
            <td colspan="1" class="label-cell">G√ºndeliƒüi</td>
            <td colspan="1" class="value-cell left-align">${dailyRate.toFixed(2).replace(",", ".")} TL</td>
            <td colspan="1" class="label-cell">B√ºt√ße Yƒ±lƒ±</td>
            <td colspan="3" class="value-cell">
                <div class="year-box-container" style="justify-content: center; padding: 0;">
                    <span class="year-box">${y1}</span>
                    <span class="year-box">${y2}</span>
                    <span class="year-box">${y3}</span>
                    <span class="year-box">${y4}</span>
                </div>
            </td>
        </tr>
        <tr class="main-header">
            <th rowspan="2" style="width: 8%;">Yolculuk ve Oturma Tarihleri</th>
            <th rowspan="2" style="width: 25%;">Nereden Nereye Yolculuk Edildiƒüi veya Nerede Oturduƒüu</th>
            <th colspan="2" style="width: 7%;">Hareket Saatleri</th>
            <th rowspan="2" style="width: 3%; line-height: 1;">G√ºn<br>Sayƒ±sƒ±</th>
            <th colspan="2" style="width: 11%;">G√úNDELƒ∞KLER</th>
            <th colspan="2" style="width: 31.5%;">TA≈ûIT VE ZORUNLU Gƒ∞DERLER</th>
            <th rowspan="2" style="width: 3%;">D√∂vizin Cinsi</th>
            <th rowspan="2" style="width: 3%;">Kuru</th>
            <th rowspan="2" style="width: 8.5%;">Toplam Tutar</th>
        </tr>
        <tr class="main-header">
            <th style="width: 3.5%;">Gidi≈ü</th>
            <th style="width: 3.5%;">D√∂n√º≈ü</th>
            <th style="width: 5.5%;">Bir G√ºnl√ºƒü√º</th>
            <th style="width: 5.5%;">Tutarƒ±</th>
            <th style="width: 27.5%;">√áe≈üidi ve Mevkii</th>
            <th style="width: 4%;">Tutarƒ±</th>
        </tr>
    </thead>
    <tbody>${travelRowsHtml}</tbody>
    <tfoot>
        <tr class="total-row">
            <td colspan="6" style="text-align:right; padding-right:10px;">TOPLAM</td>
            <td>${totalDailyAmount.toFixed(2).replace(".", ",")}</td>
            <td></td>
            <td>${(totalAccommodationCost + totalTransportCost).toFixed(2).replace(".", ",")}</td>
            <td colspan="2"></td>
            <td>${grandTotal.toFixed(2).replace(".", ",")}</td>
        </tr>
    </tfoot>
    </table>
    
    <p style="text-align:center;margin-top:5px;font-size:8px">Yukarƒ±da belirtilen tarih ve saatler arasƒ±nda yapmƒ±≈ü olduƒüum ge√ßici g√∂rev yolluƒüu ile ${grandTotal > 0 ? numberToWordsTR(grandTotal) : 'SIFIR'} harcamaya ait bildirimdir.</p>
    
    <table class="footer-table signature-section" style="margin-top:10px;">
        <tr>
            <td style="width:50%; text-align:center; padding: 10px; vertical-align: top;">
                <p>... / ... / ${document.getElementById("budgetYear").value}</p>
                <p>Birim Yetkilisi (*)</p>
                <p>(ƒ∞mza)</p><br><br>
                <p>Adƒ± Soyadƒ± : <span contenteditable="true">${document.getElementById("amirAdi").value}</span></p>
                <p>Unvanƒ± : <span contenteditable="true">${document.getElementById("amirUnvani").value}</span></p>
            </td>
            <td style="width:50%; text-align:center; padding: 10px; vertical-align: top;">
                <p>... / ... / ${document.getElementById("budgetYear").value}</p>
                <p>Bildirim Sahibi</p>
                <p>(ƒ∞mza)</p><br><br>
                <p>Adƒ± Soyadƒ± : <span contenteditable="true">${document.getElementById("fullName").value}</span></p>
                <p>Unvanƒ± : <span contenteditable="true">${document.getElementById("title").value}</span></p>
            </td>
        </tr>
    </table>`;
}

        function generateAraziIfaHTML() {
            const period = document.getElementById("araziDonem").value; const year = parseInt(document.getElementById("budgetYear").value); const g√∂revYeri = document.getElementById("g√∂revYeri").value || "Sinop"; const amirAdi = document.getElementById("araziAmirAdi").value || document.getElementById("amirAdi").value; const amirUnvani = document.getElementById("araziAmirUnvani").value || document.getElementById("amirUnvani").value; const periodMap = { 1: [0, 2], 2: [3, 5], 3: [6, 8], 4: [9, 11] }; const [startMonth, endMonth] = periodMap[period];
            let dutyDays = getDutyDaysForPeriod(startMonth, endMonth).filter(day => !araziDaysMovedToKontrol.has(toYYYYMMDD(day.date)));
            const periodName = `${period}. D√∂nem`; const monthYear = `${turkceAylar[startMonth]}, ${turkceAylar[startMonth + 1]}, ${turkceAylar[endMonth]} ${year}`; let dutyRows = ''; dutyDays.forEach((day, index) => { dutyRows += `<tr><td class="center">${index + 1}</td><td class="center">${day.date.toLocaleDateString("tr-TR")}</td><td>${turkceGunler[day.date.getDay()]}</td><td>${day.route}</td><td>${day.konu}</td></tr>` }); for (let i = dutyDays.length; i < 30; i++) { dutyRows += `<tr><td class="center">${i + 1}</td><td></td><td></td><td></td><td></td></tr>` } return `<div style="text-align:center; margin-bottom:20px;"><h3>3 AYLIK √ñZEL Hƒ∞ZMET TAZMƒ∞NATI</h3></div><table class="no-border header-info"><tr><td style="width:15%;"><b>M√úD√úRL√úƒû√ú</b></td><td style="width:2%;">:</td><td style="width:50%;">${document.getElementById("department").value}</td><td style="width:15%;"><b>D√ñNEMƒ∞</b></td><td style="width:2%;">:</td><td>${periodName}</td></tr><tr><td><b>Bƒ∞Rƒ∞Mƒ∞</b></td><td>:</td><td>${document.getElementById("birim").value}</td><td style="width:15%;"><b>AY-YIL</b></td><td style="width:2%;">:</td><td>${monthYear}</td></tr><tr><td><b>ADI SOYADI</b></td><td>:</td><td>${document.getElementById("fullName").value}</td></tr><tr><td><b>UNVANI</b></td><td>:</td><td>${document.getElementById("title").value}</td></tr></table><table class="main-table"><thead><tr><th style="width: 8%;">SIRA NO</th><th style="width: 15%;">TARƒ∞H</th><th style="width: 15%;">G√úN</th><th style="width: 22%;">G√ñREV YERƒ∞</th><th style="width: 40%;">G√ñREV KONUSU</th></tr></thead><tbody>${dutyRows}</tbody></table><p style="margin-top:20px; font-size:11px;">Yukarƒ±da adƒ± belirtilen teknik personel tarih, g√ºn, g√∂rev yeri ve g√∂revin konusunun belirtildiƒüi g√∂revleri ifa etmi≈ütir.</p><table class="no-border" style="width:100%; margin-top:50px;"><tr><td colspan="2" style="text-align:right; padding-right: 20px;"><div style="display:inline-block; text-align:right;"><b contenteditable="true">${document.getElementById("fullName").value}</b><br><div style="text-align:center;" contenteditable="true">${document.getElementById("title").value}</div></div></td></tr><tr><td colspan="2" style="text-align:center; padding-top:40px;">....../....../${year}<br><br><br><b contenteditable="true">${amirAdi}</b><br><span contenteditable="true">${amirUnvani}</span></td></tr></table>`
        }

        function generateAraziPuantajHTML() {
            const period = document.getElementById("araziDonem").value; const year = parseInt(document.getElementById("budgetYear").value); const amirAdi = document.getElementById("araziAmirAdi").value || document.getElementById("amirAdi").value; const amirUnvani = document.getElementById("araziAmirUnvani").value || document.getElementById("amirUnvani").value; const periodMap = { 1: [0, 2], 2: [3, 5], 3: [6, 8], 4: [9, 11] }; const [startMonth, endMonth] = periodMap[period];
            let dutyDays = getDutyDaysForPeriod(startMonth, endMonth).filter(day => !araziDaysMovedToKontrol.has(toYYYYMMDD(day.date)));
            const monthNames = [turkceAylar[startMonth], turkceAylar[startMonth + 1], turkceAylar[endMonth]]; const monthData = {}; monthNames.forEach(month => { monthData[month] = { days: [], count: 0 } }); dutyDays.forEach(day => { const monthName = turkceAylar[day.date.getMonth()]; if (monthData[monthName]) { monthData[monthName].days.push(day.date.getDate()); monthData[monthName].count++ } }); const grandTotal = monthData[monthNames[0]].count + monthData[monthNames[1]].count + monthData[monthNames[2]].count; let dayColumns = ''; for (let i = 1; i <= 31; i++) { dayColumns += `<th class="day-cell">${i}</th>` }
            let monthRows = ''; const numMonths = monthNames.length; if (numMonths > 0) {
                monthNames.forEach((month, index) => {
                    const data = monthData[month]; let dayCells = ''; for (let i = 1; i <= 31; i++) { dayCells += `<td class="day-cell">${data.days.includes(i) ? 'X' : ''}</td>` }
                    if (index === 0) {
                        monthRows += `<tr><td style="width: 4%;">${index + 1}</td><td style="width: 12%; text-align: center; vertical-align: middle;" rowspan="${numMonths}">${document.getElementById("fullName").value}</td><td style="width: 10%; text-align: center; vertical-align: middle;" rowspan="${numMonths}">${document.getElementById("title").value}</td><td style="width: 8%;">${month}</td>${dayCells}<td style="width: 5%;">${data.count}</td><td style="width: 5%; vertical-align: middle;" rowspan="${numMonths}">${grandTotal}</td><td style="width: 6%; vertical-align: middle;" rowspan="${numMonths}"></td></tr>`;
                    } else {
                        monthRows += `<tr><td style="width: 4%;">${index + 1}</td><td style="width: 8%;">${month}</td>${dayCells}<td style="width: 5%;">${data.count}</td></tr>`;
                    }
                });
            }
            const monthsWithDuty = monthNames.filter(month => monthData[month].count > 0); const monthsText = monthsWithDuty.length > 0 ? monthsWithDuty.join(' ') : monthNames.join(' '); const dutyText = monthsWithDuty.length > 0 ? `${year} yƒ±lƒ± ${monthsText} ${monthsWithDuty.length === 1 ? 'ayƒ±nda' : 'aylarƒ±nda'} arazide g√∂rev yapmƒ±≈ütƒ±r.` : `${year} yƒ±lƒ± ${monthNames.join(' ')} ${monthNames.length === 1 ? 'ayƒ±nda' : 'aylarƒ±nda'} arazide g√∂rev yapmamƒ±≈ütƒ±r.`; return `<div class="header-info-container"><div style="text-align: left;"><div style="font-weight: bold;">${document.getElementById("department").value}</div><div>${monthNames.join(' ')}</div></div><div style="text-align: center; font-weight: bold; font-size: 14px;">ARAZƒ∞ √áALI≈ûMALARINI G√ñSTEREN √áƒ∞ZELGE</div><div style="text-align: right; font-weight: bold;">B√ºt√ße Yƒ±lƒ±: ${year}</div></div><table class="main-table"><thead><tr><th style="width: 4%;">Sƒ±ra No</th><th style="width: 12%;">Adƒ± Soyadƒ±</th><th style="width: 10%;">√únvanƒ±</th><th style="width: 8%;">Ait Olduƒüu Ay</th>${dayColumns}<th style="width: 5%;">Aylƒ±k √áalƒ±≈ütƒ±ƒüƒ± G√ºn Sayƒ±sƒ±</th><th style="width: 5%;">√ú√ß Aylƒ±k D√∂nem √áalƒ±≈ütƒ±ƒüƒ± G√ºn Toplamƒ±</th><th style="width: 6%;">ƒ∞mza</th></tr></thead><tbody>${monthRows}</tbody></table><p style="margin-top:20px; font-size:10px; text-align:left;">Yukarƒ±da belirtilen teknik eleman ${dutyText}</p><div style="margin-top:40px; text-align:right; padding-right: 20px;"><div style="font-size: 11px; display: inline-block; text-align: center;"><div>Uygundur</div><div style="margin-top: 10px;">...../....../${year}</div><div style="margin-top: 25px; font-weight: bold;" contenteditable="true">${amirAdi}</div><div style="font-size: 10px; margin-top: 5px;" contenteditable="true">${amirUnvani}</div></div></div>`
        }

        function generateGorevEmriReportHTML() { const duties = []; const g√∂revYeri = document.getElementById("g√∂revYeri").value || "Sinop"; const amirAdi = document.getElementById("amirAdi").value; const amirUnvani = document.getElementById("amirUnvani").value; const olurYetkilisi = document.getElementById("olurYetkilisi").value; const olurUnvan = document.getElementById("olurUnvan").value; const selectedMonthOptions = Array.from(document.getElementById('yollukMonthFilter').selectedOptions); const selectedMonths = selectedMonthOptions.map(opt => parseInt(opt.value, 10)); if (selectedMonths.length === 0) { showToast("L√ºtfen en az bir rapor ayƒ± se√ßin.", "warning"); return null } const selectAll = selectedMonths.includes(0); const rows = document.querySelectorAll(".travel-card"); rows.forEach(row => { if (row.querySelector('input[name*="gorevTipi"]:checked').value === 'seminer') return; const type = row.querySelector(".gorev-tipi-select").value; if (type === 'gunubirlik') { const dateStr = row.querySelector(".travel-date").value; if (dateStr) { const date = new Date(dateStr); if (selectAll || selectedMonths.includes(date.getMonth() + 1)) { duties.push({ date: date, route: row.querySelector(".travel-route").value, konu: row.querySelector(".travel-konu").value }) } } } else { const startDateStr = row.querySelector(".coklu-start-date").value; const endDateStr = row.querySelector(".coklu-end-date").value; if (startDateStr && endDateStr) { const startDate = new Date(startDateStr); const endDate = new Date(endDateStr); const route = row.querySelector(".travel-route").value; const konu = row.querySelector(".travel-konu").value; for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) { if (selectAll || selectedMonths.includes(d.getMonth() + 1)) { const currentDate = new Date(d); let currentRoute = route; if (startDate.getTime() !== endDate.getTime()) { if (currentDate.getTime() === startDate.getTime()) currentRoute = `${g√∂revYeri}-${route}`; else if (currentDate.getTime() === endDate.getTime()) currentRoute = `${route}-${g√∂revYeri}`; else currentRoute = `${route} (Mahallinde)` } duties.push({ date: currentDate, route: currentRoute, konu: konu }) } } } } }); duties.sort((a, b) => a.date - b.date); if (duties.length === 0) { showToast("Se√ßilen aylar i√ßin g√∂rev bulunamadƒ±.", "warning"); return null } let dutyRows = ''; duties.slice(0, 20).forEach((duty, index) => { dutyRows += `<tr><td>${index + 1}</td><td>${duty.date.toLocaleDateString("tr-TR")}</td><td>${duty.route}</td><td>${duty.konu}</td></tr>` }); for (let i = duties.length; i < 20; i++) { dutyRows += `<tr><td>${i + 1}</td><td></td><td></td><td></td></tr>` } const monthNames = [...new Set(duties.map(d => turkceAylar[d.date.getMonth()]))].join(', '); const lastDate = duties[duties.length - 1].date; const monthYear = `${turkceAylar[lastDate.getMonth()]} ${lastDate.getFullYear()}`; return `<h3 style="text-align:center;">ƒ∞L ƒ∞√áƒ∞ AYLIK G√ñREVLENDƒ∞RME OLUR'U</h3><table class="no-border header-table" style="width:100%;margin-bottom:10px"><tr><td style="width:60%;vertical-align:top;text-align:left"><table class="no-border" style="width:100%"><tr><td style="width:100px;vertical-align:top;text-align:left;white-space:nowrap;"><b>M√úD√úRL√úƒû√ú&nbsp;&nbsp;&nbsp;:</b></td><td style="vertical-align:top;text-align:left;">${document.getElementById("department").value}</td></tr><tr><td style="width:100px;vertical-align:top;text-align:left;white-space:nowrap;"><b>Bƒ∞Rƒ∞Mƒ∞&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</b></td><td style="vertical-align:top;text-align:left;">${document.getElementById("birim").value}</td></tr><tr><td style="width:100px;vertical-align:top;text-align:left;white-space:nowrap;"><b>UNVANI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:</b></td><td style="vertical-align:top;text-align:left;">${document.getElementById("title").value}</td></tr><tr><td style="width:100px;vertical-align:top;text-align:left;white-space:nowrap;"><b>ADI SOYADI&nbsp;:</b></td><td style="vertical-align:top;text-align:left;">${document.getElementById("fullName").value}</td></tr></table></td><td style="width:40%;vertical-align:top;text-align:right"><table class="no-border" style="width:100%;margin-left:auto"><tr><td style="width:60px;vertical-align:top;text-align:left;white-space:nowrap;"><b>D√ñNEMƒ∞&nbsp;:</b></td><td style="vertical-align:top;text-align:left;">${monthNames}</td></tr><tr><td style="width:60px;vertical-align:top;text-align:left;white-space:nowrap;"><b>AY-YIL&nbsp;&nbsp;:</b></td><td style="vertical-align:top;text-align:left;">${monthYear}</td></tr></table></td></tr></table><table><thead><tr><th style="width: 8%;">Sƒ±ra</th><th style="width: 15%;">Tarihi</th><th style="width: 27%;">G√∂rev Yeri</th><th style="width: 50%;">G√∂revin Konusu</th></tr></thead><tbody>${dutyRows}</tbody></table><table class="no-border footer-table" style="width:100%;margin-top:20px"><tr><td style="width:60%"></td><td style="text-align:right;padding-right:20px"><div style="display:inline-block; text-align:center;"><div>.../.../${document.getElementById("budgetYear").value}</div><div style="margin-top:20px;"><b contenteditable="true">${amirAdi}</b></div><div contenteditable="true">${amirUnvani}</div></div></td></tr></table><table class="no-border footer-table" style="width:100%;margin-top:30px"><tr><td style="text-align:center"><b>OLUR</b><br>.../.../${document.getElementById("budgetYear").value}<br><br><b contenteditable="true">${olurYetkilisi}</b><br><span contenteditable="true">${olurUnvan}</span></td></tr></table>` }

        function getValidKontrolDays(months, year) {
            const araziGunleri = new Set; document.querySelectorAll(".travel-card").forEach(row => { if (row.querySelector('input[name*="gorevTipi"]:checked')?.value !== 'normal') return; const type = row.querySelector(".gorev-tipi-select").value; const addDateToSet = date => araziGunleri.add(toYYYYMMDD(date)); if (type === 'gunubirlik') { const dateStr = row.querySelector(".travel-date").value; if (dateStr) addDateToSet(new Date(dateStr)) } else { const startDateStr = row.querySelector(".coklu-start-date").value; const endDateStr = row.querySelector(".coklu-end-date").value; if (startDateStr && endDateStr) { for (let d = new Date(startDateStr), e = new Date(endDateStr); d <= e; d.setDate(d.getDate() + 1)) { addDateToSet(new Date(d)) } } } }); const seminerGunleri = new Set; document.querySelectorAll(".travel-card").forEach(row => { if (row.querySelector('input[name*="gorevTipi"]:checked')?.value !== 'seminer') return; const type = row.querySelector(".gorev-tipi-select").value; const addDateToSet = date => seminerGunleri.add(toYYYYMMDD(date)); if (type === 'gunubirlik') { const dateStr = row.querySelector(".travel-date").value; if (dateStr) addDateToSet(new Date(dateStr)) } else { const startDateStr = row.querySelector(".coklu-start-date").value; const endDateStr = row.querySelector(".coklu-end-date").value; if (startDateStr && endDateStr) { for (let d = new Date(startDateStr), e = new Date(endDateStr); d <= e; d.setDate(d.getDate() + 1)) { addDateToSet(new Date(d)) } } } }); const excludedDatesSet = new Set; const excludedInput = document.getElementById('excludedDates').value.replace(/\s+/g, ''); if (excludedInput) { excludedInput.split(',').forEach(part => { if (part.includes('-')) { const [start, end] = part.split('-'); const [startDay, startMonth] = start.split(/[.\/]/).map(Number); const [endDay, endMonth] = end.split(/[.\/]/).map(Number); if (startDay && startMonth && endDay && endMonth) { let currentDate = new Date(year, startMonth - 1, startDay); const endDate = new Date(year, endMonth - 1, endDay); while (currentDate <= endDate) { excludedDatesSet.add(toYYYYMMDD(currentDate)); currentDate.setDate(currentDate.getDate() + 1) } } } else { const [day, month] = part.split(/[.\/]/).map(Number); if (day && month) { excludedDatesSet.add(toYYYYMMDD(new Date(year, month - 1, day))) } } }) } const officialHolidays2025 = [{ month: 1, day: 1 }, { month: 3, day: 30 }, { month: 3, day: 31 }, { month: 4, day: 1 }, { month: 4, day: 23 }, { month: 5, day: 1 }, { month: 5, day: 19 }, { month: 6, day: 6 }, { month: 6, day: 7 }, { month: 6, day: 8 }, { month: 6, day: 9 }, { month: 7, day: 15 }, { month: 8, day: 30 }, { month: 10, day: 29 }]; officialHolidays2025.forEach(h => { if (year === 2025) { excludedDatesSet.add(toYYYYMMDD(new Date(year, h.month - 1, h.day))) } });
            const extraHolidayDatesSet = new Set; const extraHolidayInput = document.getElementById('extraHolidayDates')?.value.replace(/\s+/g, '') || ''; if (extraHolidayInput) { extraHolidayInput.split(',').forEach(part => { const [day, month] = part.split(/[.\/]/).map(Number); if (day && month) { extraHolidayDatesSet.add(toYYYYMMDD(new Date(year, month - 1, day))) } }) } const validControlDays = []; months.forEach(month => { const daysInMonth = new Date(year, month, 0).getDate(); for (let day = 1; day <= daysInMonth; day++) { const currentDate = new Date(year, month - 1, day); const dateString = toYYYYMMDD(currentDate); const dayOfWeek = currentDate.getDay(); const isMovedToKontrol = araziDaysMovedToKontrol.has(dateString); if (isMovedToKontrol) { validControlDays.push(currentDate); continue } const isExtraHolidayWork = extraHolidayDatesSet.has(dateString); if (isExtraHolidayWork) { validControlDays.push(currentDate); continue } const isWeekend = (dayOfWeek === 0 || dayOfWeek === 6); const isHoliday = excludedDatesSet.has(dateString); const isSeminar = seminerGunleri.has(dateString); const isNormalArazi = araziGunleri.has(dateString); if (isWeekend || isHoliday || isSeminar || isNormalArazi) continue; validControlDays.push(currentDate) } }); return validControlDays.sort((a, b) => a - b)
        }
        function getDutyDaysForPeriod(startMonth, endMonth) { const year = parseInt(document.getElementById("budgetYear").value); const startDate = new Date(year, startMonth, 1); const endDate = new Date(year, endMonth + 1, 0); const dutyDays = []; document.querySelectorAll(".travel-card").forEach(row => { if (row.querySelector('input[name*="gorevTipi"]:checked')?.value !== 'normal') return; const type = row.querySelector(".gorev-tipi-select").value; const route = row.querySelector(".travel-route").value; const konu = row.querySelector(".travel-konu").value; if ("gunubirlik" === type) { const date = row.querySelector(".travel-date").value; if (date) { const d = new Date(date); if (d >= startDate && d <= endDate) { dutyDays.push({ date: d, route: route, konu: konu }) } } } else { const startDateStr = row.querySelector(".coklu-start-date").value; const endDateStr = row.querySelector(".coklu-end-date").value; if (startDateStr && endDateStr) { for (let d = new Date(startDateStr), e = new Date(endDateStr); d <= e; d.setDate(d.getDate() + 1)) { if (d >= startDate && d <= endDate) { dutyDays.push({ date: new Date(d), route: route, konu: konu }) } } } } }); return dutyDays.sort((a, b) => a.date - b.date) }

        function calculateAllowance(startTime, endTime, hasAccommodation) {
            if (hasAccommodation) return { str: "1", val: 1 };
            const parseTime = timeStr => (parseInt(timeStr.split(":")[0], 10) * 60) + parseInt(timeStr.split(":")[1], 10);
            const startMinutes = parseTime(startTime);
            const endMinutes = parseTime(endTime);
            const isOvernight = endMinutes < startMinutes;
            const lunchStart = 12 * 60;
            const lunchEnd = 13 * 60;
            const dinnerTime = 19 * 60;
            let mealsPassed = 0;
            if (isOvernight) {
                if (startMinutes <= lunchStart) mealsPassed++;
                if (startMinutes < dinnerTime) mealsPassed++;
                if (endMinutes > lunchEnd) mealsPassed++;
                if (endMinutes > dinnerTime) mealsPassed++;
            } else {
                if (startMinutes <= lunchStart && endMinutes > lunchEnd) mealsPassed++;
                if (startMinutes < dinnerTime && endMinutes > dinnerTime) mealsPassed++;
            }
            if (mealsPassed >= 2) { return { str: "2/3", val: 2 / 3 }; }
            if (mealsPassed === 1) { return { str: "1/3", val: 1 / 3 }; }
            return { str: "0", val: 0 };
        }

        function numberToWordsTR(number) { if (number === 0) return "SIFIR"; const [integerPart, fractionalPart = "0"] = String(number.toFixed(2)).split("."); const ones = ["", "Bƒ∞R", "ƒ∞Kƒ∞", "√ú√á", "D√ñRT", "BE≈û", "ALTI", "YEDƒ∞", "SEKƒ∞Z", "DOKUZ"]; const tens = ["", "ON", "Yƒ∞RMƒ∞", "OTUZ", "KIRK", "ELLƒ∞", "ALTMI≈û", "YETMƒ∞≈û", "SEKSEN", "DOKSAN"]; function convert(n) { if (n === '0') return ""; let str = ""; if (n.length > 3) { let thousands = n.slice(0, -3); str += (thousands === '1' ? "" : convert(thousands)) + "Bƒ∞N" } let part = n.slice(-3); if (part.length === 3 && part[0] !== '0') { str += (part[0] === '1' ? "" : ones[part[0]]) + "Y√úZ"; part = part.slice(1) } if (part.length === 2 && part[0] !== '0') { str += tens[part[0]]; part = part.slice(1) } if (part.length === 1) { str += ones[part[0]] } return str } let liraText = convert(integerPart); if (liraText === "") liraText = "SIFIR"; let result = liraText + "T√úRKLƒ∞RASI"; const kurus = parseInt(fractionalPart, 10); if (kurus > 0) { result += convert(String(kurus)) + "KURU≈û" } return result }

        function updateTravelCounter() { const count = document.querySelectorAll(".travel-card").length; document.getElementById("travel-counter").textContent = count; }

        function addTravelEntry(entry = {}, isInitialLoad = false) {
    if (!isInitialLoad) playSound('click');
    const listContainer = document.getElementById("travel-list"); const cardId = `travel-${travelIdCounter++}`;
    const card = document.createElement("div"); card.className = "travel-card"; card.id = cardId;
    if (!isInitialLoad) { card.classList.add('newly-added'); setTimeout(() => card.classList.remove('newly-added'), 600); }
    const today = new Date().toISOString().split('T')[0];
    const defaults = { type: "gunubirlik", gorevTipi: "normal", date: today, route: "", start: "08:00", end: "17:00", konu: "Av ve Yaban Hayatƒ± ile ƒ∞lgili Saha ƒ∞≈üleri", accommodation: "", startDate: today, endDate: today, startTime: "08:00", endTime: "17:00", totalAccommodation: "", gidisSuresi: 1, donusSuresi: 1, transport: [], isCollapsed: isInitialLoad };
    const data = { ...defaults, ...entry };
    if (isInitialLoad) data.isCollapsed = true;
    
    card.innerHTML = `
    <div class="travel-card-summary" onclick="toggleCardCollapse(this)"></div>
    <div class="travel-card-content">
        <div class="travel-progress-bar"><div class="travel-progress-fill"></div></div>
        <div class="travel-form-grid">
            <!-- Adƒ±m 1: G√∂rev T√ºr√º -->
            <div class="travel-form-step" style="background: linear-gradient(135deg, var(--primary-color-translucent), transparent);">
                <div class="input-group">
                    <label style="text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"><i data-lucide="layers"></i> G√∂rev T√ºr√º Se√ßimi</label>
                    <select id="${cardId}-type" class="gorev-tipi-select" onchange="updateRowType(this)" style="font-size: 15px; font-weight: 600;"><option value="gunubirlik" ${data.type === 'gunubirlik' ? 'selected' : ''}>üìÖ G√ºn√ºbirlik G√∂rev</option><option value="coklu" ${data.type === 'coklu' ? 'selected' : ''}>üè® √áoklu G√ºn / Konaklama</option></select>
                    <small><i data-lucide="info"></i>G√∂rev t√ºr√ºn√º se√ßtikten sonra diƒüer alanlar a√ßƒ±lacak</small>
                </div>
                
                <div class="step-content" id="${cardId}-step2" style="display:none; margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px dashed var(--border-color);">
                    <div class="input-group">
                        <label style="text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"><i data-lucide="briefcase"></i> G√∂rev Kategorisi</label>
                        <div class="gorev-tipi-options">
                            <label class="gorev-tipi-option ${data.gorevTipi === 'normal' ? 'active' : ''}"><input type="radio" name="${cardId}-gorevTipi" value="normal" ${data.gorevTipi === 'normal' ? 'checked' : ''} onchange="updateGorevTipi(this)"> üéØ Normal G√∂rev</label>
                            <label class="gorev-tipi-option ${data.gorevTipi === 'seminer' ? 'active' : ''}"><input type="radio" name="${cardId}-gorevTipi" value="seminer" ${data.gorevTipi === 'seminer' ? 'checked' : ''} onchange="updateGorevTipi(this)"> üìö Seminer/Eƒüitim</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Adƒ±m 2: Tarih & Saat -->
            <div class="travel-form-step" id="${cardId}-step3" style="background: linear-gradient(135deg, transparent, var(--accent-color-translucent)); display:none;">
                <div class="input-group"><label style="text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"><i data-lucide="calendar-clock"></i> Tarih & Saat Bilgileri</label>
                     <div class="gunubirlik-fields" ${data.type === 'coklu' ? 'style="display:none;"' : ''}>
                        <input type="date" class="travel-date" value="${data.date}" style="margin-bottom: 0.75rem;" title="G√∂rev tarihi">
                        <div class="date-time-fields-grid">
                            <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                                <label style="font-size: 0.85rem; font-weight: 600; color: var(--text-secondary); text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.35rem;"><i data-lucide="clock" style="width: 14px; height: 14px;"></i> Gidi≈ü Saati</label>
                                <input type="time" class="travel-start" value="${data.start}" title="G√∂rev ba≈ülangƒ±√ß saati">
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                                <label style="font-size: 0.85rem; font-weight: 600; color: var(--text-secondary); text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.35rem;"><i data-lucide="clock" style="width: 14px; height: 14px;"></i> D√∂n√º≈ü Saati</label>
                                <input type="time" class="travel-end" value="${data.end}" title="G√∂rev biti≈ü saati">
                            </div>
                        </div>
                        <small><i data-lucide="info"></i>G√∂rev tarihini ve saatlerini girin</small>
                    </div>
                    <div class="coklu-fields" ${data.type === 'gunubirlik' ? 'style="display:none;"' : ''}>
                       <div class="date-time-fields-grid" style="margin-bottom: 0.75rem;">
                            <input type="date" class="coklu-start-date" value="${data.startDate}" title="G√∂rev ba≈ülangƒ±√ß tarihi">
                            <input type="date" class="coklu-end-date" value="${data.endDate}" title="G√∂rev biti≈ü tarihi">
                        </div>
                        <div class="date-time-fields-grid">
                            <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                                <label style="font-size: 0.85rem; font-weight: 600; color: var(--text-secondary); text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.35rem;"><i data-lucide="arrow-right" style="width: 14px; height: 14px;"></i> Gidi≈ü S√ºresi (G√ºn)</label>
                                <input type="number" class="coklu-gidis-suresi" value="${data.gidisSuresi}" min="1" title="Gidi≈ü yolculuƒüu ka√ß g√ºn s√ºrd√º?">
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                                <label style="font-size: 0.85rem; font-weight: 600; color: var(--text-secondary); text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.35rem;"><i data-lucide="arrow-left" style="width: 14px; height: 14px;"></i> D√∂n√º≈ü S√ºresi (G√ºn)</label>
                                <input type="number" class="coklu-donus-suresi" value="${data.donusSuresi}" min="1" title="D√∂n√º≈ü yolculuƒüu ka√ß g√ºn s√ºrd√º?">
                            </div>
                        </div>
                        <small><i data-lucide="info"></i>Ba≈ülangƒ±√ß-biti≈ü tarihleri ve yol s√ºresini girin</small>
                    </div>
                </div>
            </div>
            
            <!-- Adƒ±m 3: G√∂rev Detaylarƒ± -->
            <div class="travel-form-step" style="background: linear-gradient(135deg, var(--primary-color-translucent), transparent); grid-column: span 2;">
                <div class="travel-form-row-2col">
                    <div class="input-group">
                        <label style="text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"><i data-lucide="map-pin"></i> G√ºzergah</label>
                        <div style="position:relative; z-index: 10003;">
                            <input type="text" class="travel-route" placeholder="√ñrn: Karab√ºk - Bartƒ±n - Zonguldak" value="${data.route}">
                            <div class="autocomplete-items" style="display:none;"></div>
                        </div>
                        <!-- G√úZERGAH UYARI METNƒ∞ -->
                        <small style="color: var(--primary-color); margin-top:5px; font-size: 0.75rem; font-weight:600; text-align:center; display: block !important; opacity:0.9;">
                            <i data-lucide="info" style="width:12px; height:12px; vertical-align:middle; margin-right:2px;"></i> 
                            Zincirleme seyahat i√ßin ≈üehirlerin arasƒ±na <b>tire (-)</b> veya <b>virg√ºl (,)</b> koyunuz.
                        </small>
                    </div>
                    <div class="input-group"><label style="text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"><i data-lucide="file-text"></i> G√∂rev Konusu</label><div style="position:relative; z-index: 10003;"><input type="text" class="travel-konu" placeholder="√∂rn: Av ve Yaban Hayatƒ± Saha ƒ∞≈üleri" value="${data.konu}"><div class="autocomplete-items" style="display:none;"></div></div></div>
                </div>
                
                <!-- Konaklama √úcreti (Sadece √áoklu i√ßin) -->
                <div class="coklu-fields" ${data.type === 'gunubirlik' ? 'style="display:none;"' : ''}>
                    <div class="input-group" style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px dashed var(--border-color);"><label style="text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"><i data-lucide="home"></i> Toplam Konaklama √úcreti (TL)</label><input type="number" class="coklu-accommodation" placeholder="0.00" value="${data.totalAccommodation}" title="Konaklama faturasƒ± toplam tutarƒ±"><small style="display: block !important;"><i data-lucide="info"></i>Konaklama faturasƒ± tutarƒ±nƒ± girin</small></div>
                </div>
            </div>

        <!-- Adƒ±m 3: Ta≈üƒ±t Giderleri -->
        <div class="transport-details travel-form-step" data-step="3. Adƒ±m" style="border-color: var(--primary-color);">
            <h5 class="transport-details-header" style="text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"><i data-lucide="car"></i> Ta≈üƒ±t Giderleri</h5>
            <div class="transport-list"></div>
            <button class="add-transport-btn" onclick="addTransportRow(this)"><i data-lucide="plus"></i> Ta≈üƒ±t Gideri Ekle</button>
        </div>

        <div class="travel-card-actions">
            <div style="display: flex; gap: 0.75rem; margin-left: auto;">
                <button class="remove-btn" onclick="removeTravelEntry(event, '${cardId}')"><i data-lucide="trash-2"></i> Sil</button>
                <button class="save-and-close-btn" onclick="requestCloseTravelCard(this, true)"><i data-lucide="check-circle"></i> Kaydet ve Kapat</button>
            </div>
        </div>
    </div>`;
    listContainer.appendChild(card);

    const overlapCheckHandler = (e) => handleDateOrTimeChange(e.target);
    const storePreviousValueHandler = (e) => { e.target.dataset.previousValue = e.target.value; };

    card.querySelectorAll('input, select, textarea').forEach(input => {
        input.addEventListener('change', () => {
            saveData();
            updateTravelProgress(card);
        });
        input.addEventListener('input', () => {
            if (input.classList.contains('error-highlight')) {
                input.classList.remove('error-highlight');
            }
            updateTravelProgress(card);
        });
    });

    const dateOrTimeInputs = card.querySelectorAll('.travel-date, .travel-start, .travel-end, .coklu-start-date, .coklu-end-date');
    dateOrTimeInputs.forEach(input => {
        input.addEventListener('focus', storePreviousValueHandler);
        input.addEventListener('change', overlapCheckHandler);
    });

    if (data.transport && data.transport.length > 0) { const transportContainer = card.querySelector('.transport-list'); data.transport.forEach(transportItem => addTransportRow(transportContainer.nextElementSibling, transportItem)); }
    updateTravelCounter(); updateNightCounter(card.querySelector(".coklu-start-date")); updateGorevTipi(card.querySelector(`input[name="${cardId}-gorevTipi"]:checked`));
    attachAutocomplete(card.querySelector(".travel-route"), dynamicLocations);
    attachAutocomplete(card.querySelector(".travel-konu"), dynamicTopics);
    updateSummaryView(card);
    if (data.isCollapsed) {
        card.classList.add('is-collapsed');
    } else {
        const step2 = document.getElementById(cardId + '-step2');
        const step3 = document.getElementById(cardId + '-step3');
        if (step2) step2.style.display = 'block';
        if (step3) step3.style.display = 'block';
    }
    card.dataset.savedState = getCardState(card);
    lucide.createIcons();

    if (!isInitialLoad) {
        card.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
}
        function handleTransportChange(selectElement) {
            const transportEntry = selectElement.closest('.transport-entry'); if (!transportEntry) return;
            const descriptionInput = transportEntry.querySelector('.transport-description'); if (!descriptionInput) return;
            const card = selectElement.closest('.travel-card'); if (!card) return;
            const transportType = selectElement.value;
            const homeBase = document.getElementById('g√∂revYeri').value || 'Sinop';
            const destination = card.querySelector('.travel-route').value || 'Hedef';
            const transportEntries = Array.from(card.querySelectorAll('.transport-entry'));
            const currentIndex = transportEntries.indexOf(transportEntry);
            let suggestion = '';
            switch (transportType) {
                case 'Otob√ºs': suggestion = (currentIndex > 0) ? `${destination}‚Äì${homeBase}` : `${homeBase}‚Äì${destination}`; break;
                case 'Taksi':
                    let isArrivalTaxi = true;
                    for (let i = 0; i < currentIndex; i++) { if (transportEntries[i].querySelector('.transport-type').value === 'Taksi') { isArrivalTaxi = false; break; } }
                    suggestion = isArrivalTaxi ? 'Terminal‚ÄìOtel' : 'Otel‚ÄìTerminal';
                    break;
                case 'Tren': suggestion = (currentIndex > 0) ? `Ankara‚Äì${homeBase}` : `${homeBase}‚ÄìAnkara`; break;
                case 'U√ßak': suggestion = (currentIndex > 0) ? `Ankara‚Äì${homeBase} (U√ßu≈ü)` : `${homeBase}‚ÄìAnkara (U√ßu≈ü)`; break;
                case 'Resmi Ara√ß': suggestion = (currentIndex > 0) ? `${destination}‚Äì${homeBase} (Resmi Ara√ß)` : `${homeBase}‚Äì${destination} (Resmi Ara√ß)`; break;
                case '√ñzel Ara√ß': suggestion = (currentIndex > 0) ? `${destination}‚Äì${homeBase} (√ñzel Ara√ß)` : `${homeBase}‚Äì${destination} (√ñzel Ara√ß)`; break;
            }
            descriptionInput.value = suggestion;
        }
        function addTransportRow(button, data = {}) {
            const transportList = button.closest('.transport-details').querySelector('.transport-list');
            const transportRow = document.createElement('div'); transportRow.className = 'transport-entry';
            const card = button.closest('.travel-card'); const type = card.querySelector('.gorev-tipi-select').value;
            let defaultDate;
            if (type === 'gunubirlik') { defaultDate = card.querySelector('.travel-date').value; }
            else { defaultDate = (transportList.children.length === 0) ? card.querySelector('.coklu-start-date').value : card.querySelector('.coklu-end-date').value; }
            defaultDate = data.date || defaultDate || new Date().toISOString().split('T')[0];
            transportRow.innerHTML = `<select class="transport-type" onchange="handleTransportChange(this)"><option value="">Se√ßiniz</option><option value="Otob√ºs" ${data.type === 'Otob√ºs' ? 'selected' : ''}>Otob√ºs</option> <option value="U√ßak" ${data.type === 'U√ßak' ? 'selected' : ''}>U√ßak</option> <option value="Tren" ${data.type === 'Tren' ? 'selected' : ''}>Tren</option> <option value="Taksi" ${data.type === 'Taksi' ? 'selected' : ''}>Taksi</option> <option value="Resmi Ara√ß" ${data.type === 'Resmi Ara√ß' ? 'selected' : ''}>Resmi Ara√ß</option> <option value="√ñzel Ara√ß" ${data.type === '√ñzel Ara√ß' ? 'selected' : ''}>√ñzel Ara√ß</option></select><input type="text" class="transport-description" placeholder="A√ßƒ±klama" value="${data.description || ''}"><input type="number" step="0.01" class="transport-cost" placeholder="√úcret" value="${data.cost || ''}"><input type="date" class="transport-date" value="${defaultDate}"><button class="icon-btn" style="color: #ef4444;" onclick="this.parentElement.remove(); saveData();"><i data-lucide="x"></i></button>`;
            transportList.appendChild(transportRow);
            transportRow.querySelectorAll('input, select').forEach(input => {
                input.addEventListener('change', () => {
                    saveData();
                    updateSummaryView(card);
                });
            });
            lucide.createIcons();
            button.scrollIntoView({ behavior: 'auto', block: 'nearest' });
        }
        function removeTravelEntry(event, cardId) {
            event.stopPropagation();
            const card = document.getElementById(cardId);
            if (card && confirm('Bu seyahat giri≈üini silmek istediƒüinizden emin misiniz?')) {
                card.remove();
                sortTravelEntries();
                updateTravelCounter();
                saveData();
                showToast("Seyahat ba≈üarƒ±yla silindi.", "success");
            }
        }
        function updateRowType(selectElement) {
            const card = selectElement.closest(".travel-card"); const type = selectElement.value;
            const cardId = card.id;

            // Adƒ±m 2'yi g√∂ster (G√∂rev Tipi)
            const step2 = document.getElementById(cardId + '-step2');
            if (step2) {
                step2.style.display = 'block';
                step2.style.animation = 'fadeInUp 0.5s ease-out';
            }

            card.querySelectorAll(".gunubirlik-fields").forEach(el => el.style.display = type === "gunubirlik" ? "block" : "none");
            card.querySelectorAll(".coklu-fields").forEach(el => el.style.display = type === "coklu" ? "block" : "none");
            if (type === 'coklu') {
                const startDateInput = card.querySelector(".coklu-start-date");
                const endDateInput = card.querySelector(".coklu-end-date");
                endDateInput.value = startDateInput.value;
                updateNightCounter(startDateInput);
            }
            syncTransportDates(card);
        }
        function updateGorevTipi(radioElement) {
            if (!radioElement) return;
            const card = radioElement.closest(".travel-card");
            const cardId = card.id;

            card.querySelectorAll(".gorev-tipi-option").forEach(opt => opt.classList.remove("active"));
            radioElement.closest(".gorev-tipi-option").classList.add("active");

            // Adƒ±m 3'√º g√∂ster (Tarih & Saat)
            const step3 = document.getElementById(cardId + '-step3');
            if (step3) {
                step3.style.display = 'block';
                step3.style.animation = 'fadeInUp 0.5s ease-out';
            }
        }
        function updateNightCounter(inputElement) {
            const card = inputElement?.closest(".travel-card"); if (!card) return;
            const startDateInput = card.querySelector(".coklu-start-date"); const endDateInput = card.querySelector(".coklu-end-date");
            const accommodationInput = card.querySelector(".coklu-accommodation"); if (!accommodationInput) return;
            endDateInput.min = startDateInput.value;
            if (endDateInput.value && startDateInput.value > endDateInput.value) { endDateInput.value = startDateInput.value; }
            if (startDateInput.value && endDateInput.value) { const startDate = new Date(startDateInput.value); const endDate = new Date(endDateInput.value); const diffDays = Math.round(Math.abs(endDate - startDate) / 864e5); accommodationInput.placeholder = `${diffDays} gece konaklama`; } else { accommodationInput.placeholder = "0.00"; }
        }

        function handleDateOrTimeChange(inputElement) {
            const card = inputElement.closest('.travel-card');
            if (!card) return;
            if (inputElement.classList.contains('coklu-start-date') || inputElement.classList.contains('coklu-end-date')) {
                updateNightCounter(inputElement);
            }
            syncTransportDates(card);
            const cardId = card.id;
            const type = card.querySelector('.gorev-tipi-select').value;
            let startDate, endDate, startTime, endTime;
            if (type === 'gunubirlik') {
                const dateVal = card.querySelector('.travel-date').value;
                if (!dateVal) return;
                startDate = endDate = dateVal;
                startTime = card.querySelector('.travel-start').value;
                endTime = card.querySelector('.travel-end').value;
            } else {
                startDate = card.querySelector('.coklu-start-date').value;
                endDate = card.querySelector('.coklu-end-date').value;
                startTime = '00:00';
                endTime = '23:59';
            }
            if (!startDate || !endDate || !startTime || !endTime) return;
            if (isTimeSlotOccupied(startDate, endDate, startTime, endTime, cardId)) {
                showToast("‚ùå √áakƒ±≈üma! Bu zaman diliminde ba≈üka bir g√∂rev mevcut.", "error");
                inputElement.value = inputElement.dataset.previousValue;
                if (inputElement.classList.contains('coklu-start-date')) {
                    const endDateInput = card.querySelector('.coklu-end-date');
                    if (endDateInput.value < inputElement.value) endDateInput.value = inputElement.value;
                }
            }
        }

        function isTimeSlotOccupied(startDate, endDate, startTime, endTime, currentCardId) {
            const startDateTimeToCheck = new Date(`${startDate}T${startTime}`);
            const endDateTimeToCheck = new Date(`${endDate}T${endTime}`);
            const allCards = document.querySelectorAll('.travel-card');
            for (const card of allCards) {
                if (card.id === currentCardId) continue;
                const type = card.querySelector('.gorev-tipi-select').value;
                let otherStartDate, otherEndDate, otherStartTime, otherEndTime;
                if (type === 'gunubirlik') {
                    const dateVal = card.querySelector('.travel-date').value;
                    if (!dateVal) continue;
                    otherStartDate = otherEndDate = dateVal;
                    otherStartTime = card.querySelector('.travel-start').value;
                    otherEndTime = card.querySelector('.travel-end').value;
                } else {
                    otherStartDate = card.querySelector('.coklu-start-date').value;
                    otherEndDate = card.querySelector('.coklu-end-date').value;
                    otherStartTime = '00:00';
                    otherEndTime = '23:59';
                }
                if (!otherStartDate || !otherEndDate || !otherStartTime || !otherEndTime) continue;
                const otherStartDateTime = new Date(`${otherStartDate}T${otherStartTime}`);
                const otherEndDateTime = new Date(`${otherEndDate}T${otherEndTime}`);
                if (startDateTimeToCheck < otherEndDateTime && endDateTimeToCheck > otherStartDateTime) {
                    return true;
                }
            }
            return false;
        }

        function syncTransportDates(card) {
            const type = card.querySelector('.gorev-tipi-select').value;
            const transportEntries = card.querySelectorAll('.transport-entry');
            if (transportEntries.length === 0) return;
            if (type === 'gunubirlik') {
                const date = card.querySelector('.travel-date').value;
                transportEntries.forEach(entry => entry.querySelector('.transport-date').value = date);
            } else {
                const startDate = card.querySelector('.coklu-start-date').value;
                const endDate = card.querySelector('.coklu-end-date').value;
                transportEntries.forEach((entry, index) => { entry.querySelector('.transport-date').value = (index === 0) ? startDate : endDate; });
            }
        }
        function attachAutocomplete(input, suggestions) {
            const showSuggestions = function () {
                const val = this.value; const autocompleteContainer = this.parentNode;
                const autocompleteItems = autocompleteContainer.querySelector('.autocomplete-items'); autocompleteItems.innerHTML = '';
                if (val.length < 1 && document.activeElement !== this) {
                    autocompleteItems.style.display = 'none'; return;
                }
                let matchCount = 0;
                const filteredSuggestions = suggestions.filter(s => s.toLowerCase().includes(val.toLowerCase()));
                filteredSuggestions.forEach(suggestion => {
                    if (matchCount >= 7) return; matchCount++;
                    const item = document.createElement('div'); item.classList.add('autocomplete-item');
                    const startIndex = suggestion.toLowerCase().indexOf(val.toLowerCase()); const endIndex = startIndex + val.length;
                    item.innerHTML = `${suggestion.substring(0, startIndex)}<strong>${suggestion.substring(startIndex, endIndex)}</strong>${suggestion.substring(endIndex)}`;
                    item.addEventListener('click', function () { input.value = suggestion; autocompleteItems.style.display = 'none'; });
                    autocompleteItems.appendChild(item);
                });
                autocompleteItems.style.display = filteredSuggestions.length > 0 ? 'block' : 'none';
            };
            input.addEventListener('input', showSuggestions); input.addEventListener('focus', showSuggestions);
            document.addEventListener('click', function (e) { if (!input.parentNode.contains(e.target)) { input.parentNode.querySelector('.autocomplete-items').style.display = 'none'; } });
        }

        function updateSummaryView(card) {
            const summaryContainer = card.querySelector('.travel-card-summary');
            if (!summaryContainer) return;

            const allCards = Array.from(document.querySelectorAll('#travel-list .travel-card'));
            const sequenceNumber = allCards.indexOf(card) + 1;
            const typeSelect = card.querySelector('.gorev-tipi-select');
            const gorevTipiInput = card.querySelector('input[name*="gorevTipi"]:checked');
            const gorevTipiText = gorevTipiInput ? (gorevTipiInput.value === 'seminer' ? 'Seminer' : 'Normal') : 'Bilinmiyor';
            const route = card.querySelector('.travel-route').value || '<i>G√ºzergah Yok</i>';
            const konu = card.querySelector('.travel-konu').value || '<i>Konu Yok</i>';

            let dateAndTypeSummary = '';
            if (typeSelect.value === 'gunubirlik') {
                const date = card.querySelector('.travel-date').value;
                const dateText = date ? new Date(date).toLocaleDateString('tr-TR', { day: '2-digit', month: '2-digit', year: 'numeric' }) : '<i>Tarih Yok</i>';
                dateAndTypeSummary = `<strong>${dateText}</strong> - G√ºn√ºbirlik / ${gorevTipiText}`;
            } else {
                const startDate = card.querySelector('.coklu-start-date').value;
                const endDate = card.querySelector('.coklu-end-date').value;
                let dateRangeText = '<i>Tarih Aralƒ±ƒüƒ± Yok</i>';
                if (startDate && endDate) {
                    const startDateText = new Date(startDate).toLocaleDateString('tr-TR', { day: '2-digit', month: '2-digit', year: 'numeric' });
                    if (startDate === endDate) {
                        dateRangeText = startDateText;
                    } else {
                        const endDateText = new Date(endDate).toLocaleDateString('tr-TR', { day: '2-digit', month: '2-digit', year: 'numeric' });
                        dateRangeText = `${startDateText} - ${endDateText}`;
                    }
                }
                dateAndTypeSummary = `<strong>${dateRangeText}</strong> - √áoklu / ${gorevTipiText}`;
            }

            summaryContainer.innerHTML = `
            <div class="summary-info">
                <span class="summary-seq-no">${sequenceNumber}</span>
                <div class="summary-item summary-date-type" title="Tarih ve G√∂rev Tipi">
                    <i data-lucide="calendar-days" style="width:16px;"></i>
                    <span>${dateAndTypeSummary}</span>
                </div>
                <div class="summary-item summary-route" title="${route}">
                    <i data-lucide="map-pin" style="width:16px; color: var(--primary-color);"></i> 
                    <span>${route}</span>
                </div>
                <div class="summary-item summary-subject" title="${konu}">
                    <i data-lucide="file-text" style="width:16px;"></i> 
                    <span>${konu}</span>
                </div>
            </div>
            <div class="summary-actions">
                <button class="copy-task-btn" onclick="duplicateTravelEntry(event, '${card.id}')" title="Bu g√∂revi bir sonraki m√ºsait g√ºne kopyala">
                    <i data-lucide="copy"></i> Kopyala
                </button>
                <button class="remove-btn" onclick="removeTravelEntry(event, '${card.id}')"><i data-lucide="trash-2"></i></button>
            </div>`;
            lucide.createIcons();
        }

        function refreshAllSummaryViews() {
            document.querySelectorAll('.travel-card').forEach(card => updateSummaryView(card));
        }

        function toggleCardCollapse(element) {
    const cardToToggle = element.closest('.travel-card'); 
    if (!cardToToggle) return;

    if (cardToToggle.classList.contains('is-collapsed')) {
        // Ba≈üka a√ßƒ±k kart varsa kapat
        const currentlyOpenCard = document.querySelector('.travel-card:not(.is-collapsed)');
        if (currentlyOpenCard && currentlyOpenCard !== cardToToggle) {
            const wasClosed = requestCloseTravelCard(currentlyOpenCard, true);
            if (!wasClosed) return;
        }

        // Kartƒ± a√ß
        cardToToggle.classList.remove('is-collapsed');
        cardToToggle.dataset.savedState = getCardState(cardToToggle);

        // Ekrana ortalama (Gecikmeli √ßalƒ±≈üƒ±r ki animasyon bitsin)
        setTimeout(() => {
            cardToToggle.scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center',
                inline: 'nearest'
            });
        }, 350); 

    } else {
        // Kartƒ± kapat
        requestCloseTravelCard(cardToToggle);
    }
}
        function getCardState(card) {
            if (!card) return '{}';
            const state = {};
            card.querySelectorAll('input:not([type="hidden"]), select, textarea').forEach(el => {
                const key = el.className || el.name || Math.random();
                if (el.type === 'radio') { if (el.checked) { state[el.name] = el.value; } }
                else { state[key] = el.value; }
            });
            return JSON.stringify(state);
        }

        function requestCloseTravelCard(element, showSuccessToast = false) {
            const card = element.closest('.travel-card');
            if (!card) return false;
            const routeInput = card.querySelector('.travel-route');
            const konuInput = card.querySelector('.travel-konu');
            
            // Hatalarƒ± toplamak i√ßin bo≈ü bir √ßanta hazƒ±rlayalƒ±m
            let eksikListesi = [];

            // 1. G√úZERGAH KONTROL√ú
            if (routeInput.value.trim() === '') {
                routeInput.classList.add('error-highlight'); // Kƒ±rmƒ±zƒ± yap
                routeInput.classList.add('shake-hard');      // Salla!
                eksikListesi.push("G√ºzergah");              // Listeye not al
                
                // Animasyon bitince sallanmayƒ± durdur (tekrar sallanabilsin diye)
                setTimeout(() => routeInput.classList.remove('shake-hard'), 500);
            } else {
                routeInput.classList.remove('error-highlight');
            }

            // 2. KONU KONTROL√ú
            if (konuInput.value.trim() === '') {
                konuInput.classList.add('error-highlight');
                konuInput.classList.add('shake-hard');
                eksikListesi.push("G√∂rev Konusu");
                
                setTimeout(() => konuInput.classList.remove('shake-hard'), 500);
            } else {
                konuInput.classList.remove('error-highlight');
            }

            // 3. EƒûER √áANTADA EKSƒ∞K VARSA UYARI VER
            if (eksikListesi.length > 0) {
                // Eksikleri virg√ºlle ayƒ±rarak yaz (√ñrn: "G√ºzergah ve G√∂rev Konusu")
                const eksiklerMetni = eksikListesi.join(" ve ");
                
                // Ekrana kocaman bir uyarƒ± bas
                showToast(`üõë Dƒ∞KKAT: <b>${eksiklerMetni}</b> bilgisini girmediniz!`, "error");
                
                // Hata sesi √ßal (varsa)
                if(typeof playSound === 'function') playSound('error');
                
                return false; // Kaydetme i≈ülemini durdur
            }
            sortTravelEntries();
            saveData();
            updateSummaryView(card);
            card.classList.add('is-collapsed');
            if (showSuccessToast) {
                showToast("‚úÖ Seyahat ba≈üarƒ±yla kaydedildi!", "success");
                createConfetti(card);
            }
            return true;
        }

        // Konfeti animasyonu (geli≈ütirilmi≈ü)
        function createConfetti(element) {
            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8', '#F7DC6F', '#BB8FCE', '#E74C3C', '#3498DB', '#2ECC71'];
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;

            // Daha fazla konfeti ve daha dinamik
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = centerX + 'px';
                    confetti.style.top = centerY + 'px';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animation = `confetti ${0.8 + Math.random() * 0.7}s ease-out forwards`;
                    confetti.style.transform = `translateX(${(Math.random() - 0.5) * 300}px) rotate(${Math.random() * 360}deg)`;
                    confetti.style.width = (8 + Math.random() * 6) + 'px';
                    confetti.style.height = confetti.style.width;
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 2000);
                }, i * 20);
            }

            // Ba≈üarƒ± sesi (sessiz, sadece g√∂rsel feedback)
            playSuccessSound();
        }

        // Ba≈üarƒ± sesi (Web Audio API ile)
        function playSuccessSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.value = 800;
                oscillator.type = 'sine';

                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
            } catch (e) {
                // Ses √ßalmazsa sessizce devam et
            }
        }

        // ƒ∞lerleme √ßubuƒüunu g√ºncelle
        function updateTravelProgress(card) {
            const progressFill = card.querySelector('.travel-progress-fill');
            if (!progressFill) return;

            let progress = 0;
            const requiredFields = [
                card.querySelector('.travel-route'),
                card.querySelector('.travel-konu')
            ];

            const filledFields = requiredFields.filter(field => field && field.value.trim() !== '').length;
            progress = (filledFields / requiredFields.length) * 100;

            progressFill.style.width = progress + '%';
        }

        function updateDefaultReportPeriods() {
            const monthsWithTravel = new Set();
            document.querySelectorAll('.travel-card').forEach(card => {
                const type = card.querySelector('.gorev-tipi-select').value;
                if (type === 'gunubirlik') {
                    const dateVal = card.querySelector('.travel-date').value;
                    if (dateVal) monthsWithTravel.add(new Date(dateVal).getMonth() + 1);
                } else {
                    const startVal = card.querySelector('.coklu-start-date').value;
                    const endVal = card.querySelector('.coklu-end-date').value;
                    if (startVal && endVal) {
                        for (let d = new Date(startVal); d <= new Date(endVal); d.setDate(d.getDate() + 1)) {
                            monthsWithTravel.add(d.getMonth() + 1);
                        }
                    }
                }
            });

            if (monthsWithTravel.size > 0) {
                const monthsArray = Array.from(monthsWithTravel);
                ['yollukMonthFilter', 'kontrolMonthFilter'].forEach(selectId => {
                    const selectElement = document.getElementById(selectId);
                    Array.from(selectElement.options).forEach(opt => {
                        opt.selected = monthsArray.includes(parseInt(opt.value));
                    });

                    // Butonlarƒ± da g√ºncelle
                    const buttonContainerId = selectId === 'yollukMonthFilter' ? 'yolluk-month-buttons' : 'kontrol-month-buttons';
                    const buttonContainer = document.getElementById(buttonContainerId);
                    if (buttonContainer) {
                        buttonContainer.querySelectorAll('.month-btn:not(.all-months)').forEach(btn => {
                            if (monthsArray.includes(parseInt(btn.dataset.value))) {
                                btn.classList.add('selected');
                            } else {
                                btn.classList.remove('selected');
                            }
                        });
                    }
                });

                const lastMonth = Math.max(...monthsArray);
                let period = 1;
                if (lastMonth >= 4 && lastMonth <= 6) period = 2;
                else if (lastMonth >= 7 && lastMonth <= 9) period = 3;
                else if (lastMonth >= 10 && lastMonth <= 12) period = 4;
                document.getElementById('araziDonem').value = period;
            } else {
                ['yollukMonthFilter', 'kontrolMonthFilter'].forEach(selectId => {
                    const selectElement = document.getElementById(selectId);
                    Array.from(selectElement.options).forEach(opt => opt.selected = false);
                });
            }
        }

        function sortTravelEntries() {
            const listContainer = document.getElementById('travel-list');
            const cards = Array.from(listContainer.querySelectorAll('.travel-card'));

            const getCardDate = (card) => {
                const type = card.querySelector('.gorev-tipi-select').value;
                let dateStr;
                if (type === 'gunubirlik') {
                    dateStr = card.querySelector('.travel-date').value;
                } else {
                    dateStr = card.querySelector('.coklu-start-date').value;
                }
                return dateStr ? new Date(dateStr) : new Date('9999-12-31');
            };

            cards.sort((a, b) => {
                const dateA = getCardDate(a);
                const dateB = getCardDate(b);
                return dateA - dateB;
            });

            cards.forEach(card => listContainer.appendChild(card));
        }

        function updateAppTitle() {
            const departmentInput = document.getElementById('department');
            const titleSuffix = document.getElementById('app-title-suffix');
            if (departmentInput && titleSuffix) {
                titleSuffix.textContent = `/ ${departmentInput.value}`;
            }
        }

        let saveTimeout;
        function saveData() {
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => {
                if (!currentProfile) return;
                try {
                    const centralInfo = {};
                    document.querySelectorAll('#centralInfoSection input, #centralInfoSection select, #centralInfoSection textarea').forEach(el => { centralInfo[el.id] = el.value; });
                    const travelList = [];
                    document.querySelectorAll('.travel-card').forEach(card => {
                        const transport = [];
                        card.querySelectorAll('.transport-entry').forEach(tr => { transport.push({ type: tr.querySelector('.transport-type').value, description: tr.querySelector('.transport-description').value, cost: tr.querySelector('.transport-cost').value, date: tr.querySelector('.transport-date').value }); });
                        travelList.push({
                            type: card.querySelector('.gorev-tipi-select').value,
                            gorevTipi: card.querySelector('input[name*="gorevTipi"]:checked').value,
                            date: card.querySelector('.travel-date').value,
                            route: card.querySelector('.travel-route').value,
                            start: card.querySelector('.travel-start').value,
                            end: card.querySelector('.travel-end').value,
                            konu: card.querySelector('.travel-konu').value,
                            startDate: card.querySelector('.coklu-start-date').value,
                            endDate: card.querySelector('.coklu-end-date').value,
                            totalAccommodation: card.querySelector('.coklu-accommodation').value,
                            gidisSuresi: card.querySelector('.coklu-gidis-suresi').value,
                            donusSuresi: card.querySelector('.coklu-donus-suresi').value,
                            transport: transport
                        });
                    });
                    const dataToSave = JSON.stringify({ centralInfo, travelList, excludedAraziDays: Array.from(araziDaysMovedToKontrol) });
                    localStorage.setItem('reportingAppData_' + currentProfile, encodeData(dataToSave));

                    const allRoutes = new Set();
                    const allSubjects = new Set();
                    document.querySelectorAll('.travel-card').forEach(card => {
                        const route = card.querySelector('.travel-route').value;
                        const subject = card.querySelector('.travel-konu').value;
                        if (route) allRoutes.add(route);
                        if (subject) allSubjects.add(subject);
                    });
                    allRoutes.forEach(item => updateAutocompleteMemory('autocomplete_locations', item, dynamicLocations, popularLocations));
                    allSubjects.forEach(item => updateAutocompleteMemory('autocomplete_topics', item, dynamicTopics, popularTopics));

                    refreshAllSummaryViews();
                    updateDefaultReportPeriods();
                    updateAppTitle();

                } catch (error) { console.error("Veri kaydedilirken hata olu≈ütu:", error); showToast("Ayarlar kaydedilemedi.", "error"); }
            }, 300);
        }
        function updateAutocompleteMemory(key, value, dynamicArray, staticArray) {
            if (!value || value.trim() === '') return;
            const trimmedValue = value.trim();
            const lowerCaseValue = trimmedValue.toLowerCase();

            const existsInDynamic = dynamicArray.some(item => item.toLowerCase() === lowerCaseValue);
            const existsInStatic = staticArray.some(item => item.toLowerCase() === lowerCaseValue);

            if (!existsInDynamic && !existsInStatic) {
                dynamicArray.unshift(trimmedValue);
                const storedArray = JSON.parse(decodeData(localStorage.getItem(key) || '[]'));
                if (!storedArray.some(item => item.toLowerCase() === lowerCaseValue)) {
                    storedArray.unshift(trimmedValue);
                    try { localStorage.setItem(key, encodeData(JSON.stringify(storedArray))); } catch (e) { console.error("localStorage'a kaydedilemedi:", e); }
                }
            }
        }

        function loadData() {
            if (!currentProfile) return;
            const encodedData = localStorage.getItem('reportingAppData_' + currentProfile);
            const data = encodedData ? JSON.parse(decodeData(encodedData)) : null;

            araziDaysMovedToKontrol = new Set(data?.excludedAraziDays || []);

            const profileDefaults = profiles[currentProfile].defaults;
            const profileSigners = profiles[currentProfile].signers;

            if (data && data.centralInfo) {
                Object.keys(data.centralInfo).forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.value = data.centralInfo[id];
                });
                Object.keys(profileDefaults).forEach(id => {
                    if (!data.centralInfo.hasOwnProperty(id) || data.centralInfo[id] === '') {
                        const el = document.getElementById(id);
                        if (el) el.value = profileDefaults[id];
                    }
                });
            } else {
                Object.keys(profileDefaults).forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.value = profileDefaults[id];
                });
                Object.keys(profileSigners).forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.value = profileSigners[id];
                });
            }

            document.getElementById('travel-list').innerHTML = ''; travelIdCounter = 0;
            if (data && data.travelList && data.travelList.length > 0) {
                data.travelList.forEach(entry => addTravelEntry(entry, true));
            }

            sortTravelEntries();
            refreshAllSummaryViews();
            updateDefaultReportPeriods();
            updateTravelCounter();
            updateAppTitle();
        }

        function setupTabs() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabPanels = document.querySelectorAll('.tab-panel');
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    const targetPanelId = button.getAttribute('data-tab');
                    tabPanels.forEach(panel => {
                        panel.classList.remove('active');
                        if (panel.id === targetPanelId) { panel.classList.add('active'); }
                    });
                });
            });
        }

        function setupTheme() {
            const themeWrapper = document.getElementById('theme-wrapper');
            const themeTrigger = document.getElementById('theme-trigger');
            const themeWheel = document.querySelector('.theme-wheel');
            const themeOptions = document.querySelectorAll('.theme-option');
            const body = document.body;
            const themeOrder = ["theme-spring", "theme-summer", "theme-autumn", "theme-winter", "theme-night", "theme-historic", "theme-forest", "theme-ocean", "theme-sunrise", "theme-lavender", "theme-graphite"];
            const currentTheme = localStorage.getItem('theme') || 'theme-autumn';

            const applyTheme = (themeName) => {
                body.className = '';
                body.classList.add(themeName);
                localStorage.setItem('theme', themeName);
                const themeIndex = themeOrder.indexOf(themeName);
                const rotation = -themeIndex * (360 / themeOrder.length);
                themeWheel.style.transform = `rotate(${rotation}deg)`;
                themeOptions.forEach(opt => {
                    opt.classList.remove('active');
                    if (opt.dataset.theme === themeName) {
                        opt.classList.add('active');
                    }
                });
                handleThemeAnimation(themeName);
                lucide.createIcons();
                themeWrapper.classList.remove('wheel-is-open');
            };

            themeTrigger.addEventListener('click', (e) => {
                e.stopPropagation();
                themeWrapper.classList.toggle('wheel-is-open');
                lucide.createIcons();
            });

            document.addEventListener('click', (e) => {
                if (!themeWrapper.contains(e.target)) {
                    themeWrapper.classList.remove('wheel-is-open');
                }
            });

            themeOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    e.preventDefault();
                    const selectedTheme = option.dataset.theme;
                    applyTheme(selectedTheme);
                });
            });
            applyTheme(currentTheme);
        }

        function setupLogoUploads() {
            const leftLogoDiv = document.getElementById('left-logo');
            const rightLogoDiv = document.getElementById('right-logo');
            const uploader = document.getElementById('logo-uploader');
            let targetLogoDiv = null;
            const leftLogoDefaultHTML = leftLogoDiv.innerHTML;
            const rightLogoDefaultHTML = rightLogoDiv.innerHTML;

            const renderLogoContainer = (container, storageKey, defaultHTML) => {
                const logoSrc = decodeData(localStorage.getItem(storageKey));

                if (logoSrc) {
                    container.classList.add('has-logo');
                    container.innerHTML = `
                    <img src="${logoSrc}" alt="${storageKey === 'leftLogo' ? 'Sol' : 'Saƒü'} Logo">
                    <button class="logo-delete-btn" aria-label="Logoyu kaldƒ±r" title="Logoyu kaldƒ±r">
                        <i data-lucide="trash-2"></i>
                    </button>
                    <span class="logo-hint" style="display: none;">Logo Ekle</span>
                `;
                    container.querySelector('.logo-delete-btn').addEventListener('click', (event) => {
                        event.stopPropagation();
                        if (confirm('Bu logoyu kaldƒ±rmak istediƒüinizden emin misiniz?')) {
                            localStorage.removeItem(storageKey);
                            renderLogoContainer(container, storageKey, defaultHTML);
                            showToast('Logo kaldƒ±rƒ±ldƒ±.', 'info');
                        }
                    });
                } else {
                    container.classList.remove('has-logo');
                    container.innerHTML = defaultHTML;
                    // Logo yoksa hint'i g√∂ster
                    const hint = container.querySelector('.logo-hint');
                    if (hint) {
                        hint.style.display = 'inline-block';
                    }
                }
                lucide.createIcons();
            };

            renderLogoContainer(leftLogoDiv, 'leftLogo', leftLogoDefaultHTML);
            renderLogoContainer(rightLogoDiv, 'rightLogo', rightLogoDefaultHTML);

            // Logo uyarƒ± kontrol√º - Sayfa y√ºklendiƒüinde ve her 30 saniyede bir kontrol et
            function checkLogoWarnings() {
                const leftLogo = localStorage.getItem('leftLogo');
                const rightLogo = localStorage.getItem('rightLogo');

                // Sol logo kontrol√º
                const leftHint = leftLogoDiv.querySelector('.logo-hint');
                if (!leftLogo && leftHint) {
                    leftHint.style.display = 'inline-block';
                }

                // Saƒü logo kontrol√º
                const rightHint = rightLogoDiv.querySelector('.logo-hint');
                if (!rightLogo && rightHint) {
                    rightHint.style.display = 'inline-block';
                }
            }

            // ƒ∞lk kontrol
            setTimeout(checkLogoWarnings, 1000);

            // Periyodik kontrol (30 saniyede bir)
            setInterval(checkLogoWarnings, 30000);

            const handleUpload = (div, key) => {
                targetLogoDiv = div;
                uploader.setAttribute('data-key', key);
                uploader.click();
            };

            leftLogoDiv.addEventListener('click', () => handleUpload(leftLogoDiv, 'leftLogo'));
            rightLogoDiv.addEventListener('click', () => handleUpload(rightLogoDiv, 'rightLogo'));

            uploader.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file && targetLogoDiv) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const imgSrc = e.target.result;
                        const key = uploader.getAttribute('data-key');
                        localStorage.setItem(key, encodeData(imgSrc));
                        const defaultHTML = key === 'leftLogo' ? leftLogoDefaultHTML : rightLogoDefaultHTML;
                        renderLogoContainer(targetLogoDiv, key, defaultHTML);
                    };
                    reader.readAsDataURL(file);
                }
                uploader.value = '';
            });
        }

        function toYYYYMMDD(date) {
            const d = new Date(date);
            return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
        }

        function openAraziDayManager() {
            const modalContainer = document.getElementById('day-manager-modal-container');
            const listElement = document.getElementById('day-manager-list');
            const subtitle = document.getElementById('day-manager-subtitle');
            const periodSelect = document.getElementById("araziDonem");
            const period = periodSelect.value;
            const periodText = periodSelect.options[periodSelect.selectedIndex].text;

            subtitle.textContent = `${periodText} d√∂nemi i√ßin arazi g√ºnlerini y√∂netin.`;

            const periodMap = { 1: [0, 2], 2: [3, 5], 3: [6, 8], 4: [9, 11] };
            const [startMonth, endMonth] = periodMap[period];
            const dutyDays = getDutyDaysForPeriod(startMonth, endMonth);

            listElement.innerHTML = '';
            if (dutyDays.length === 0) {
                listElement.innerHTML = '<p style="text-align:center; color: var(--text-secondary);">Bu d√∂nem i√ßin y√∂netilecek arazi g√ºn√º bulunamadƒ±.</p>';
            } else {
                dutyDays.forEach(day => {
                    const dateString = toYYYYMMDD(day.date);
                    const isExcluded = araziDaysMovedToKontrol.has(dateString);

                    const item = document.createElement('div');
                    item.className = `day-list-item ${isExcluded ? 'excluded' : ''}`;
                    item.innerHTML = `
                    <div>
                        <span class="day-info">
                            ${day.date.toLocaleDateString('tr-TR', { day: '2-digit', month: 'long', year: 'numeric' })}
                            <span class="day-of-week">${turkceGunler[day.date.getDay()]}</span>
                        </span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <span class="status-label">Kontrole Aktarƒ±ldƒ±</span>
                        <div class="toggle-switch-container ${isExcluded ? '' : 'isleyis-active'}" style="margin:0; padding:0; background:none; cursor:pointer;" onclick="toggleAraziDayExclusion(this, '${dateString}')">
                            <div class="toggle-switch toggle-switch-small">
                                <div class="toggle-handle"></div>
                            </div>
                        </div>
                    </div>
                `;
                    listElement.appendChild(item);
                });
            }

            modalContainer.style.display = 'block';
            lucide.createIcons();
        }

        function toggleAraziDayExclusion(toggleElement, dateString) {
            const item = toggleElement.closest('.day-list-item');
            const isCurrentlyIncluded = toggleElement.classList.contains('isleyis-active');

            if (isCurrentlyIncluded) {
                araziDaysMovedToKontrol.add(dateString);
                toggleElement.classList.remove('isleyis-active');
                item.classList.add('excluded');
            } else {
                araziDaysMovedToKontrol.delete(dateString);
                toggleElement.classList.add('isleyis-active');
                item.classList.remove('excluded');
            }
            saveData();
        }

        function transferAllToKontrol() {
            const listElement = document.getElementById('day-manager-list');
            const dayItems = listElement.querySelectorAll('.day-list-item');
            let transferCount = 0;

            dayItems.forEach(item => {
                const toggleContainer = item.querySelector('.toggle-switch-container');
                const dateString = toggleContainer.onclick.toString().match(/'([^']+)'/)[1];

                if (toggleContainer.classList.contains('isleyis-active')) {
                    // Arazi g√ºn√º ise kontrole aktar
                    araziDaysMovedToKontrol.add(dateString);
                    toggleContainer.classList.remove('isleyis-active');
                    item.classList.add('excluded');
                    transferCount++;
                }
            });

            if (transferCount > 0) {
                saveData();
                showToast(`‚úÖ ${transferCount} g√ºn kontrole aktarƒ±ldƒ±!`, "success");
                createConfetti(document.getElementById('day-manager-modal-container'));
            } else {
                showToast("‚ÑπÔ∏è Aktarƒ±lacak arazi g√ºn√º bulunamadƒ±.", "info");
            }
        }

        function closeAraziDayManager() {
            document.getElementById('day-manager-modal-container').style.display = 'none';
            showToast("‚úÖ G√ºn tercihleri kaydedildi.", "success");
        }

        function handleThemeAnimation(themeName) { }

        // Ay se√ßici butonlarƒ± i√ßin fonksiyon
        function initMonthButtons() {
            const monthNames = ['Ocak', '≈ûubat', 'Mart', 'Nisan', 'Mayƒ±s', 'Haziran', 'Temmuz', 'Aƒüustos', 'Eyl√ºl', 'Ekim', 'Kasƒ±m', 'Aralƒ±k'];

            // Yolluk ay se√ßici
            const yollukSelect = document.getElementById('yollukMonthFilter');
            const yollukContainer = document.createElement('div');
            yollukContainer.className = 'month-selector-grid';
            yollukContainer.id = 'yolluk-month-buttons';

            // T√ºm Aylar butonu
            const allMonthsBtn = document.createElement('div');
            allMonthsBtn.className = 'month-btn all-months';
            allMonthsBtn.textContent = 'T√ºm Aylar';
            allMonthsBtn.dataset.value = '0';
            allMonthsBtn.onclick = function () {
                const isSelected = this.classList.contains('selected');
                const allMonthButtons = document.querySelectorAll('#yolluk-month-buttons .month-btn:not(.all-months)');

                if (!isSelected) {
                    // T√ºm aylarƒ± se√ß
                    this.classList.add('selected');
                    allMonthButtons.forEach(btn => btn.classList.add('selected'));
                    Array.from(yollukSelect.options).forEach(opt => opt.selected = true);
                } else {
                    // T√ºm se√ßimleri kaldƒ±r
                    this.classList.remove('selected');
                    allMonthButtons.forEach(btn => btn.classList.remove('selected'));
                    Array.from(yollukSelect.options).forEach(opt => opt.selected = false);
                }
            };
            yollukContainer.appendChild(allMonthsBtn);

            // Ay butonlarƒ±
            monthNames.forEach((name, index) => {
                const btn = document.createElement('div');
                btn.className = 'month-btn';
                btn.textContent = name;
                btn.dataset.value = (index + 1).toString();
                btn.onclick = function () {
                    document.querySelector('#yolluk-month-buttons .all-months').classList.remove('selected');
                    this.classList.toggle('selected');
                    const selectedValues = Array.from(document.querySelectorAll('#yolluk-month-buttons .month-btn.selected:not(.all-months)')).map(b => b.dataset.value);
                    Array.from(yollukSelect.options).forEach(opt => {
                        opt.selected = selectedValues.includes(opt.value);
                    });
                };
                yollukContainer.appendChild(btn);
            });

            yollukSelect.parentNode.insertBefore(yollukContainer, yollukSelect);
            yollukSelect.style.display = 'none';

            // Bilgilendirme metni ekle
            const yollukInfo = document.createElement('div');
            yollukInfo.className = 'month-selector-info';
            yollukInfo.innerHTML = '<i data-lucide="info"></i><span>√áoklu se√ßim i√ßin ay butonlarƒ±na tƒ±klayƒ±n</span>';
            yollukContainer.parentNode.insertBefore(yollukInfo, yollukContainer.nextSibling);

            // Kontrol ay se√ßici
            const kontrolSelect = document.getElementById('kontrolMonthFilter');
            const kontrolContainer = document.createElement('div');
            kontrolContainer.className = 'month-selector-grid';
            kontrolContainer.id = 'kontrol-month-buttons';

            monthNames.forEach((name, index) => {
                const btn = document.createElement('div');
                btn.className = 'month-btn';
                btn.textContent = name;
                btn.dataset.value = (index + 1).toString();
                btn.onclick = function () {
                    this.classList.toggle('selected');
                    const selectedValues = Array.from(document.querySelectorAll('#kontrol-month-buttons .month-btn.selected')).map(b => b.dataset.value);
                    Array.from(kontrolSelect.options).forEach(opt => {
                        opt.selected = selectedValues.includes(opt.value);
                    });
                };
                kontrolContainer.appendChild(btn);
            });

            kontrolSelect.parentNode.insertBefore(kontrolContainer, kontrolSelect);
            kontrolSelect.style.display = 'none';

            // Bilgilendirme metni ekle
            const kontrolInfo = document.createElement('div');
            kontrolInfo.className = 'month-selector-info';
            kontrolInfo.innerHTML = '<i data-lucide="info"></i><span>√áoklu se√ßim i√ßin ay butonlarƒ±na tƒ±klayƒ±n</span>';
            kontrolContainer.parentNode.insertBefore(kontrolInfo, kontrolContainer.nextSibling);

            // ƒ∞konlarƒ± yenile
            lucide.createIcons();
        }

        // D√∂nem se√ßici butonlarƒ± i√ßin fonksiyon
        function initPeriodButtons() {
            const periodSelect = document.getElementById('araziDonem');
            const periodContainer = document.createElement('div');
            periodContainer.className = 'period-selector-grid';
            periodContainer.id = 'period-buttons';

            const periods = [
                { value: '1', label: '1. D√∂nem', months: 'Ocak - Mart' },
                { value: '2', label: '2. D√∂nem', months: 'Nisan - Haziran' },
                { value: '3', label: '3. D√∂nem', months: 'Temmuz - Eyl√ºl' },
                { value: '4', label: '4. D√∂nem', months: 'Ekim - Aralƒ±k' }
            ];

            periods.forEach(period => {
                const btn = document.createElement('div');
                btn.className = 'period-btn';
                if (periodSelect.value === period.value) {
                    btn.classList.add('selected');
                }
                btn.innerHTML = `<div>${period.label}</div><div class="period-btn-label">${period.months}</div>`;
                btn.dataset.value = period.value;
                btn.onclick = function () {
                    document.querySelectorAll('#period-buttons .period-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    periodSelect.value = this.dataset.value;
                    // Change event'i tetikle
                    periodSelect.dispatchEvent(new Event('change'));
                };
                periodContainer.appendChild(btn);
            });

            periodSelect.parentNode.insertBefore(periodContainer, periodSelect);
            periodSelect.style.display = 'none';

            // Bilgilendirme metni ekle
            const periodInfo = document.createElement('div');
            periodInfo.className = 'month-selector-info';
            periodInfo.innerHTML = '<i data-lucide="info"></i><span>Tazminat d√∂neminizi se√ßin</span>';
            periodContainer.parentNode.insertBefore(periodInfo, periodContainer.nextSibling);

            lucide.createIcons();
        }

        // Klavye kƒ±sayollarƒ±
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + S: Veriyi kaydet
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                saveData();
                showToast("üíæ Veriler kaydedildi!", "success");
            }
            // Ctrl/Cmd + N: Yeni seyahat ekle
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                addTravelEntry();
                showToast("‚ûï Yeni seyahat eklendi!", "success");
            }
            // Ctrl/Cmd + D: Karanlƒ±k mod toggle
            if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
                e.preventDefault();
                toggleQuickDarkMode();
            }
        });

        // Akan Bilgilendirme Bandƒ±
        const infoMessages = [
            { icon: 'image', text: 'Logo eklemek i√ßin √ºst k√∂≈üedeki logo alanlarƒ±na tƒ±klayƒ±n' },
            { icon: 'user-circle', text: '√ñnce profil se√ßimi yapƒ±n, ardƒ±ndan merkezi bilgileri doldurun' },
            { icon: 'plane-takeoff', text: 'Yeni seyahat eklemek i√ßin "Yeni Seyahat Ekle" butonuna tƒ±klayƒ±n' },
            { icon: 'calendar', text: 'Ay se√ßimi i√ßin butonlara tƒ±klayƒ±n, √ßoklu se√ßim yapabilirsiniz' },
            { icon: 'keyboard', text: 'Klavye kƒ±sayollarƒ±: Ctrl+S (Kaydet), Ctrl+N (Yeni Seyahat), Ctrl+D (Karanlƒ±k Mod)' },
            { icon: 'palette', text: 'Tema deƒüi≈ütirmek i√ßin √ºst men√ºdeki palet ikonuna tƒ±klayƒ±n' },
            { icon: 'save', text: 'Verileriniz otomatik olarak tarayƒ±cƒ±nƒ±za kaydedilir' },
            { icon: 'file-text', text: 'Raporlarƒ± PDF olarak indirebilir veya yazdƒ±rabilirsiniz' }
        ];

        // Akan yazƒ± bandƒ± kaldƒ±rƒ±ldƒ± (dikkat daƒüƒ±tƒ±cƒ± olduƒüu i√ßin)

        // Maksimum kontrol g√ºn√º hƒ±zlƒ± se√ßim
        function setMaxControlDays(value) {
            document.getElementById('maxControlDays').value = value;

            // Buton g√∂rsellerini g√ºncelle
            document.querySelectorAll('.input-group .period-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');

            const message = value === 0 ? "Sƒ±nƒ±rsƒ±z kontrol g√ºn√º se√ßildi" : `${value} g√ºn se√ßildi`;
            showToast(message, "success");
            saveData();
        }

        // Hari√ß tutulacak g√ºnler i√ßin kolay se√ßim
        function addExcludedDateRange() {
            const startDate = document.getElementById('excludeStartDate').value;
            const endDate = document.getElementById('excludeEndDate').value;
            const textarea = document.getElementById('excludedDates');

            if (!startDate) {
                showToast("L√ºtfen ba≈ülangƒ±√ß tarihi se√ßin", "warning");
                return;
            }

            const formatDate = (dateStr) => {
                const d = new Date(dateStr);
                return `${String(d.getDate()).padStart(2, '0')}.${String(d.getMonth() + 1).padStart(2, '0')}`;
            };

            let dateText = formatDate(startDate);
            if (endDate && endDate !== startDate) {
                dateText += `-${formatDate(endDate)}`;
            }

            const currentValue = textarea.value.trim();
            textarea.value = currentValue ? `${currentValue}, ${dateText}` : dateText;

            // Temizle
            document.getElementById('excludeStartDate').value = '';
            document.getElementById('excludeEndDate').value = '';

            showToast("Tarih ba≈üarƒ±yla eklendi", "success");
            saveData();
        }

        // Hƒ±zlƒ± karanlƒ±k mod
        function toggleQuickDarkMode() {
            const currentTheme = document.body.className || 'theme-autumn';
            if (currentTheme.includes('night') || currentTheme.includes('graphite')) {
                document.body.className = 'theme-autumn';
                localStorage.setItem('theme', 'theme-autumn');
                showToast("‚òÄÔ∏è Aydƒ±nlƒ±k mod aktif", "success");
            } else {
                document.body.className = 'theme-night';
                localStorage.setItem('theme', 'theme-night');
                showToast("üåô Karanlƒ±k mod aktif", "success");
            }
            lucide.createIcons();
        }

        document.addEventListener('DOMContentLoaded', () => {
            initApp();
            setupTabs();
            initMonthButtons();
            initPeriodButtons();

            // Hƒ±zlƒ± karanlƒ±k mod butonu ekle
            const darkToggle = document.createElement('button');
            darkToggle.className = 'quick-dark-toggle';
            darkToggle.innerHTML = '<i data-lucide="moon" style="width:24px;height:24px;"></i>';
            darkToggle.onclick = toggleQuickDarkMode;
            darkToggle.title = 'Karanlƒ±k Mod (Ctrl+D)';
            document.body.appendChild(darkToggle);

            // Akan bilgilendirme bandƒ± kaldƒ±rƒ±ldƒ±

            lucide.createIcons();
            document.getElementById('centralInfoSection').addEventListener('change', saveData);
            document.getElementById('centralInfoSection').addEventListener('keyup', saveData);
            document.getElementById('centralInfoSection').addEventListener('input', saveData);

            document.addEventListener('click', (event) => {
                const openCard = document.querySelector('.travel-card:not(.is-collapsed)');
                if (openCard && !openCard.contains(event.target)) {
                    const isSafeClick = event.target.closest('.autocomplete-item, .toast-notification, .add-btn, .remove-btn, .profile-card, .icon-btn, .theme-option, .logo-placeholder, #in-app-report-modal, .day-manager-modal-overlay');
                    if (isSafeClick) return;
                    const isClickOnTab = event.target.closest('.tab-btn');
                    requestCloseTravelCard(openCard, isClickOnTab);
                }
            });
        });

        // ===== BUTON SES EFEKTLERƒ∞ - TOK VE TATLI =====
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new (AudioContext || window.webkitAudioContext)();
        let soundsEnabled = true;

        function playClickSound() {
            if (!soundsEnabled) return;
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            // Daha tok tƒ±k sesi - d√º≈ü√ºk frekans
            oscillator.frequency.value = 320; // Daha tok (E4)
            oscillator.type = 'sine';

            gainNode.gain.setValueAtTime(0.15, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);

            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.1);
        }

        function playSuccessSound() {
            if (!soundsEnabled) return;
            // Daha tok ve derin ba≈üarƒ± melodisi
            const notes = [
                { freq: 261.63, time: 0 },      // C4 - Daha tok
                { freq: 329.63, time: 0.1 },    // E4 - Daha tok
                { freq: 392.00, time: 0.2 }     // G4 - Daha tok
            ];

            notes.forEach(note => {
                const oscillator = audioCtx.createOscillator();
                const gainNode = audioCtx.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);

                oscillator.frequency.value = note.freq;
                oscillator.type = 'sine';

                const startTime = audioCtx.currentTime + note.time;
                gainNode.gain.setValueAtTime(0.12, startTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, startTime + 0.3);

                oscillator.start(startTime);
                oscillator.stop(startTime + 0.3);
            });
        }

        function playHoverSound() {
            if (!soundsEnabled) return;
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            // Daha tok hover sesi
            oscillator.frequency.value = 440; // A4 - Daha tok
            oscillator.type = 'sine';

            gainNode.gain.setValueAtTime(0.015, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.04);

            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.04);
        }

        // Butonlara ses efektleri ekle
        document.addEventListener('click', (e) => {
            if (audioCtx.state === 'suspended') audioCtx.resume();

            // T√ºm tƒ±klanabilir elementler i√ßin ses
            const clickedButton = e.target.closest('button:not(.no-sound)');
            const clickedLabel = e.target.closest('label.gorev-tipi-option, label.month-btn, label.period-btn');
            const clickedCard = e.target.closest('.profile-card, .travel-card-summary');
            const clickedTab = e.target.closest('.tab-btn');
            const clickedTheme = e.target.closest('.theme-option');
            const clickedLogo = e.target.closest('.logo-placeholder');
            const clickedIconBtn = e.target.closest('.icon-btn');

            if (clickedButton || clickedLabel || clickedCard || clickedTab || clickedTheme || clickedLogo || clickedIconBtn) {
                playClickSound();
            }

            // Rapor olu≈üturma butonlarƒ± i√ßin ba≈üarƒ± sesi
            if (e.target.closest('[onclick*="generate"]')) {
                setTimeout(() => playSuccessSound(), 100);
            }
        });

        // Hover sesleri
        setTimeout(() => {
            document.querySelectorAll('button, .month-btn, .period-btn').forEach(el => {
                el.addEventListener('mouseenter', () => playHoverSound());
            });
        }, 1000);
/* --- YENƒ∞ GERƒ∞ AL (UNDO) Sƒ∞STEMƒ∞ --- */

// Silinen veriyi burada tutacaƒüƒ±z
let lastDeletedTravel = null;
let undoTimeout = null;
let undoToastElement = null;

// Bu fonksiyon, eski silme fonksiyonunu ezer (override eder)
function removeTravelEntry(event, cardId) {
    if(event) event.stopPropagation();
    const card = document.getElementById(cardId);
    if (!card) return;

    // 1. Veriyi Hafƒ±zaya Al (Kopyala)
    const transport = [];
    card.querySelectorAll('.transport-entry').forEach(tr => {
        transport.push({
            type: tr.querySelector('.transport-type').value,
            description: tr.querySelector('.transport-description').value,
            cost: tr.querySelector('.transport-cost').value,
            date: tr.querySelector('.transport-date').value
        });
    });

    lastDeletedTravel = {
        type: card.querySelector('.gorev-tipi-select').value,
        gorevTipi: card.querySelector('input[name*="gorevTipi"]:checked').value,
        date: card.querySelector('.travel-date').value,
        route: card.querySelector('.travel-route').value,
        start: card.querySelector('.travel-start').value,
        end: card.querySelector('.travel-end').value,
        konu: card.querySelector('.travel-konu').value,
        startDate: card.querySelector('.coklu-start-date').value,
        endDate: card.querySelector('.coklu-end-date').value,
        totalAccommodation: card.querySelector('.coklu-accommodation').value,
        gidisSuresi: card.querySelector('.coklu-gidis-suresi').value,
        donusSuresi: card.querySelector('.coklu-donus-suresi').value,
        transport: transport,
        isCollapsed: false // Geri gelince a√ßƒ±k gelsin
    };

    // 2. Kartƒ± Animasyonla Gizle
    card.style.transition = "all 0.4s ease";
    card.style.transform = "scale(0.9) translateX(-50px)";
    card.style.opacity = "0";
    
    // 3. Biraz bekleyip tamamen sil ve bildirimi g√∂ster
    setTimeout(() => {
        card.remove();
        sortTravelEntries();
        updateTravelCounter();
        saveData();
        
        if(typeof playSound === 'function') playSound('click'); // Ses
        
        showUndoNotification(); // Kutuyu √ßƒ±kart
    }, 350);
}

// Modern Geri Al bildirimini g√∂steren fonksiyon
function showUndoNotification() {
    // Eƒüer ekranda zaten bir kutu varsa onu temizle
    if (undoToastElement) {
        clearTimeout(undoTimeout);
        undoToastElement.remove();
    }

    // Yeni kutuyu olu≈ütur - Modern tasarƒ±m
    undoToastElement = document.createElement('div');
    undoToastElement.className = 'undo-notification';
    undoToastElement.innerHTML = `
        <div class="undo-content">
            <div class="undo-title">
                <i data-lucide="trash-2" style="width:18px; color:#ef4444;"></i>
                G√∂rev Silindi
            </div>
            <div class="undo-message">Yanlƒ±≈ülƒ±kla sildiyseniz geri alabilirsiniz</div>
        </div>
        <button class="undo-btn" onclick="restoreLastDeletedTravel()">
            <i data-lucide="rotate-ccw" style="width:16px;"></i>
            Geri Al
        </button>
        <div class="undo-timer-line">
            <div class="undo-timer-progress" id="undo-progress"></div>
        </div>
    `;
    
    document.body.appendChild(undoToastElement);
    if(typeof lucide !== 'undefined') lucide.createIcons();

    // Kutuyu g√∂r√ºn√ºr yap (Animasyonlu giri≈ü)
    setTimeout(() => undoToastElement.classList.add('show'), 10);

    // Progress bar'ƒ± ba≈ülat
    const progress = undoToastElement.querySelector('#undo-progress');
    setTimeout(() => {
        if (progress) progress.style.width = '0%';
    }, 50);

    // Hover durumunu kontrol et
    let isHovered = false;
    undoToastElement.addEventListener('mouseenter', () => {
        isHovered = true;
        clearTimeout(undoTimeout);
        // Progress bar'ƒ± durdur
        const prog = undoToastElement.querySelector('#undo-progress');
        if (prog) {
            const currentWidth = prog.getBoundingClientRect().width;
            const totalWidth = prog.parentElement.getBoundingClientRect().width;
            prog.style.transition = 'none';
            prog.style.width = (currentWidth / totalWidth * 100) + '%';
        }
    });

    undoToastElement.addEventListener('mouseleave', () => {
        isHovered = false;
        // Kalan s√ºreyi hesapla ve devam et
        const prog = undoToastElement.querySelector('#undo-progress');
        if (prog) {
            const currentWidth = parseFloat(prog.style.width) || 100;
            const remainingTime = (currentWidth / 100) * 8000;
            if (remainingTime > 0) {
                prog.style.transition = `width ${remainingTime}ms linear`;
                prog.style.width = '0%';
                scheduleHide(remainingTime);
            }
        }
    });

    // 8 saniye sonra otomatik gizle (hover deƒüilse)
    scheduleHide(8000);
}

function scheduleHide(delay) {
    clearTimeout(undoTimeout);
    undoTimeout = setTimeout(() => {
        if (undoToastElement && !undoToastElement.matches(':hover')) {
            undoToastElement.classList.add('hiding');
            setTimeout(() => {
                if (undoToastElement) undoToastElement.remove();
                lastDeletedTravel = null;
            }, 400);
        }
    }, delay);
}

// "Geri Al" butonuna basƒ±nca √ßalƒ±≈üan fonksiyon
function restoreLastDeletedTravel() {
    if (!lastDeletedTravel) return;

    // Hafƒ±zadaki kartƒ± listeye geri ekle
    addTravelEntry(lastDeletedTravel);
    
    // Kutuyu hemen kaldƒ±r
    if (undoToastElement) {
        undoToastElement.classList.remove('show');
        setTimeout(() => undoToastElement.remove(), 400);
    }
    
    if(typeof playSound === 'function') playSound('save'); // Ba≈üarƒ± sesi
    lastDeletedTravel = null; // Hafƒ±zayƒ± temizle
}

// G√∂rev Kopyalama Fonksiyonu - Bir sonraki m√ºsait g√ºne kopyalar
function duplicateTravelEntry(event, cardId) {
    if(event) event.stopPropagation();
    const card = document.getElementById(cardId);
    if (!card) return;

    // Mevcut kartƒ±n verilerini al
    const transport = [];
    card.querySelectorAll('.transport-entry').forEach(tr => {
        transport.push({
            type: tr.querySelector('.transport-type').value,
            description: tr.querySelector('.transport-description').value,
            cost: tr.querySelector('.transport-cost').value,
            date: tr.querySelector('.transport-date').value
        });
    });

    const originalData = {
        type: card.querySelector('.gorev-tipi-select').value,
        gorevTipi: card.querySelector('input[name*="gorevTipi"]:checked').value,
        date: card.querySelector('.travel-date').value,
        route: card.querySelector('.travel-route').value,
        start: card.querySelector('.travel-start').value,
        end: card.querySelector('.travel-end').value,
        konu: card.querySelector('.travel-konu').value,
        startDate: card.querySelector('.coklu-start-date').value,
        endDate: card.querySelector('.coklu-end-date').value,
        totalAccommodation: card.querySelector('.coklu-accommodation').value,
        gidisSuresi: card.querySelector('.coklu-gidis-suresi').value,
        donusSuresi: card.querySelector('.coklu-donus-suresi').value,
        transport: transport
    };

    // Bir sonraki m√ºsait g√ºn√º bul
    const nextAvailableDate = findNextAvailableDate(originalData.type === 'gunubirlik' ? originalData.date : originalData.endDate);
    
    // Yeni g√∂rev verilerini hazƒ±rla
    const newData = { ...originalData };
    
    if (originalData.type === 'gunubirlik') {
        newData.date = nextAvailableDate;
        // Ta≈üƒ±t tarihlerini de g√ºncelle
        newData.transport = transport.map(t => ({
            ...t,
            date: nextAvailableDate
        }));
    } else {
        // √áoklu g√ºn i√ßin: Aynƒ± g√ºn sayƒ±sƒ±nƒ± koru
        const originalStart = new Date(originalData.startDate);
        const originalEnd = new Date(originalData.endDate);
        const dayDifference = Math.ceil((originalEnd - originalStart) / (1000 * 60 * 60 * 24));
        
        const newStart = new Date(nextAvailableDate);
        const newEnd = new Date(newStart);
        newEnd.setDate(newEnd.getDate() + dayDifference);
        
        newData.startDate = newStart.toISOString().split('T')[0];
        newData.endDate = newEnd.toISOString().split('T')[0];
        
        // Ta≈üƒ±t tarihlerini de g√ºncelle (ilk ta≈üƒ±t ba≈ülangƒ±√ß, son ta≈üƒ±t biti≈ü)
        newData.transport = transport.map((t, index) => ({
            ...t,
            date: index === 0 ? newData.startDate : (index === transport.length - 1 ? newData.endDate : t.date)
        }));
    }
    
    newData.isCollapsed = true; // Yeni kart a√ßƒ±k gelsin
    
    // Yeni kartƒ± ekle
    addTravelEntry(newData);
    
    if(typeof playSound === 'function') playSound('save');
    showToast(`‚úÖ G√∂rev ${nextAvailableDate} tarihine kopyalandƒ±!`, "success");
}

// Bir sonraki m√ºsait g√ºn√º bulan fonksiyon
function findNextAvailableDate(currentDate) {
    const allCards = document.querySelectorAll('.travel-card');
    const occupiedDates = new Set();
    
    // T√ºm mevcut g√∂rev tarihlerini topla
    allCards.forEach(card => {
        const type = card.querySelector('.gorev-tipi-select').value;
        if (type === 'gunubirlik') {
            const date = card.querySelector('.travel-date').value;
            if (date) occupiedDates.add(date);
        } else {
            const startDate = card.querySelector('.coklu-start-date').value;
            const endDate = card.querySelector('.coklu-end-date').value;
            if (startDate && endDate) {
                const start = new Date(startDate);
                const end = new Date(endDate);
                // Aradaki t√ºm g√ºnleri ekle
                for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
                    occupiedDates.add(d.toISOString().split('T')[0]);
                }
            }
        }
    });
    
    // Mevcut tarihten sonraki ilk bo≈ü g√ºn√º bul
    let nextDate = new Date(currentDate);
    nextDate.setDate(nextDate.getDate() + 1); // Bir g√ºn sonrasƒ±ndan ba≈üla
    
    // Maksimum 365 g√ºn ileriye bak (sonsuz d√∂ng√ºy√º √∂nle)
    let attempts = 0;
    while (attempts < 365) {
        const dateStr = nextDate.toISOString().split('T')[0];
        const dayOfWeek = nextDate.getDay();
        
        // Hafta sonu deƒüilse ve dolu deƒüilse
        if (dayOfWeek !== 0 && dayOfWeek !== 6 && !occupiedDates.has(dateStr)) {
            return dateStr;
        }
        
        nextDate.setDate(nextDate.getDate() + 1);
        attempts++;
    }
    
    // Eƒüer bo≈ü g√ºn bulunamazsa, sadece bir g√ºn sonrasƒ±nƒ± d√∂nd√ºr
    const fallbackDate = new Date(currentDate);
    fallbackDate.setDate(fallbackDate.getDate() + 1);
    return fallbackDate.toISOString().split('T')[0];
}

// ==================== WIZARD MODAL FONKSƒ∞YONLARI ====================
let wizardCurrentStep = 1;
let wizardData = {
    gorevKategorisi: null,
    type: null,
    startDate: null,
    endDate: null,
    startTime: '08:00',
    endTime: '17:00',
    gidisSuresi: 1,
    donusSuresi: 1,
    route: '',
    konu: 'Av ve Yaban Hayatƒ± ile ƒ∞lgili Saha ƒ∞≈üleri',
    konaklama: '',
    transport: []
};

function openTravelWizard() {
    playSound('click');
    wizardCurrentStep = 1;
    wizardData = {
        gorevKategorisi: null,
        type: null,
        startDate: null,
        endDate: null,
        startTime: '08:00',
        endTime: '17:00',
        gidisSuresi: 1,
        donusSuresi: 1,
        route: '',
        konu: 'Av ve Yaban Hayatƒ± ile ƒ∞lgili Saha ƒ∞≈üleri',
        konaklama: '',
        transport: []
    };
    
    // Reset form
    document.querySelectorAll('.wizard-option-card').forEach(card => card.classList.remove('selected'));
    document.getElementById('wizardStartDate').value = new Date().toISOString().split('T')[0];
    document.getElementById('wizardEndDate').value = new Date().toISOString().split('T')[0];
    document.getElementById('wizardStartTime').value = '08:00';
    document.getElementById('wizardEndTime').value = '17:00';
    document.getElementById('wizardGidisSuresi').value = '1';
    document.getElementById('wizardDonusSuresi').value = '1';
    document.getElementById('wizardRoute').value = '';
    document.getElementById('wizardKonu').value = 'Av ve Yaban Hayatƒ± ile ƒ∞lgili Saha ƒ∞≈üleri';
    document.getElementById('wizardKonaklama').value = '';
    document.getElementById('wizardTransportList').innerHTML = '';
    
    updateWizardStep();
    document.getElementById('travelWizardOverlay').style.display = 'flex';
    
    // Attach autocomplete to wizard inputs
    setTimeout(() => {
        const routeInput = document.getElementById('wizardRoute');
        const konuInput = document.getElementById('wizardKonu');
        
        if (routeInput && typeof attachAutocomplete === 'function') {
            attachAutocomplete(routeInput, dynamicLocations);
        }
        if (konuInput && typeof attachAutocomplete === 'function') {
            attachAutocomplete(konuInput, dynamicTopics);
        }
        
        // Tarih/saat inputlarƒ±na √∂zel efektler ekle
        enhanceDateTimeInputs();
        
        lucide.createIcons();
    }, 100);
}

function closeTravelWizard() {
    playSound('click');
    document.getElementById('travelWizardOverlay').style.display = 'none';
}

function selectTransportType(option) {
    playSound('click');
    const item = option.closest('.wizard-transport-item');
    const type = option.dataset.type;
    
    // Se√ßimi g√ºncelle
    item.querySelectorAll('.transport-type-option').forEach(opt => opt.classList.remove('selected'));
    option.classList.add('selected');
    
    // Hidden input'u g√ºncelle
    item.querySelector('.transport-type').value = type;
    
    // Selector'ƒ± gizle, detaylarƒ± g√∂ster
    const selector = item.querySelector('.transport-type-selector');
    const details = item.querySelector('.transport-details');
    
    selector.style.display = 'none';
    details.style.display = 'block';
    details.style.animation = 'fadeInUp 0.4s ease-out';
    
    // Otomatik a√ßƒ±klama √∂ner
    const descInput = item.querySelector('.transport-description');
    const route = document.getElementById('wizardRoute').value || 'Hedef';
    const homeBase = document.getElementById('g√∂revYeri')?.value || 'Sinop';
    
    const allItems = Array.from(document.querySelectorAll('.wizard-transport-item'));
    const currentIndex = allItems.indexOf(item);
    
    let suggestion = '';
    switch (type) {
        case 'Otob√ºs':
            suggestion = (currentIndex > 0) ? `${route}‚Äì${homeBase}` : `${homeBase}‚Äì${route}`;
            break;
        case 'Taksi':
            let isArrivalTaxi = true;
            for (let i = 0; i < currentIndex; i++) {
                if (allItems[i].querySelector('.transport-type').value === 'Taksi') {
                    isArrivalTaxi = false;
                    break;
                }
            }
            suggestion = isArrivalTaxi ? 'Terminal‚ÄìOtel' : 'Otel‚ÄìTerminal';
            break;
        case 'Tren':
            suggestion = (currentIndex > 0) ? `Ankara‚Äì${homeBase}` : `${homeBase}‚ÄìAnkara`;
            break;
        case 'U√ßak':
            suggestion = (currentIndex > 0) ? `Ankara‚Äì${homeBase} (U√ßu≈ü)` : `${homeBase}‚ÄìAnkara (U√ßu≈ü)`;
            break;
        case 'Resmi Ara√ß':
            suggestion = (currentIndex > 0) ? `${route}‚Äì${homeBase} (Resmi Ara√ß)` : `${homeBase}‚Äì${route} (Resmi Ara√ß)`;
            break;
        case '√ñzel Ara√ß':
            suggestion = (currentIndex > 0) ? `${route}‚Äì${homeBase} (√ñzel Ara√ß)` : `${homeBase}‚Äì${route} (√ñzel Ara√ß)`;
            break;
    }
    
    descInput.value = suggestion;
    
    // ƒ∞lk input'a focus
    descInput.focus();
    
    lucide.createIcons();
}

function toggleWizardType(type) {
    playSound('click');
    
    // Update toggle buttons
    document.querySelectorAll('.wizard-type-toggle').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.type === type);
    });
    
    const today = new Date().toISOString().split('T')[0];
    
    if (type === 'gunubirlik') {
        document.getElementById('wizardGunubirlikFields').style.display = 'block';
        document.getElementById('wizardCokluFields').style.display = 'none';
        
        document.getElementById('wizardStartDate').value = today;
        wizardData.type = 'gunubirlik';
        wizardData.startDate = today;
        wizardData.endDate = today;
    } else {
        document.getElementById('wizardGunubirlikFields').style.display = 'none';
        document.getElementById('wizardCokluFields').style.display = 'block';
        
        document.getElementById('wizardStartDateMulti').value = today;
        document.getElementById('wizardEndDate').value = today;
        wizardData.type = 'coklu';
        wizardData.startDate = today;
        wizardData.endDate = today;
    }
    
    document.getElementById('wizardNextBtn').disabled = false;
    lucide.createIcons();
}

// √ñzel tarih/saat se√ßici deƒüi≈ükenleri
let currentPickerInput = null;
let currentPickerType = null;
let currentPickerValue = { day: null, month: null, year: null, hour: null, minute: null };

// Tarih ve saat inputlarƒ±na √∂zel efektler ekle
function enhanceDateTimeInputs() {
    const dateInputs = document.querySelectorAll('.wizard-input-group input[type="date"]');
    const timeInputs = document.querySelectorAll('.wizard-input-group input[type="time"]');
    
    dateInputs.forEach(input => {
        // Takvim ikonuna tƒ±klandƒ±ƒüƒ±nda √∂zel picker a√ß
        input.addEventListener('click', function(e) {
            // Eƒüer takvim ikonuna tƒ±klandƒ±ysa
            const rect = this.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const iconStart = rect.width - 50; // Takvim ikonu saƒüda
            
            if (clickX > iconStart) {
                e.preventDefault();
                openCustomDatePicker(this);
            }
            // Deƒüilse normal input davranƒ±≈üƒ± (elle yazma)
        });
        
        // Deƒüer deƒüi≈ütiƒüinde kutlama
        input.addEventListener('change', function() {
            createInputCelebration(this);
        });
    });
    
    timeInputs.forEach(input => {
        // Saat ikonuna tƒ±klandƒ±ƒüƒ±nda √∂zel picker a√ß
        input.addEventListener('click', function(e) {
            // Eƒüer saat ikonuna tƒ±klandƒ±ysa
            const rect = this.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const iconStart = rect.width - 50; // Saat ikonu saƒüda
            
            if (clickX > iconStart) {
                e.preventDefault();
                openCustomTimePicker(this);
            }
            // Deƒüilse normal input davranƒ±≈üƒ± (elle yazma)
        });
        
        // Deƒüer deƒüi≈ütiƒüinde kutlama
        input.addEventListener('change', function() {
            createInputCelebration(this);
        });
    });
}

function openCustomDatePicker(input) {
    playSound('click');
    currentPickerInput = input;
    currentPickerType = 'date';
    
    // Mevcut deƒüeri parse et
    if (input.value) {
        const parts = input.value.split('-');
        currentPickerValue.year = parseInt(parts[0]);
        currentPickerValue.month = parseInt(parts[1]);
        currentPickerValue.day = parseInt(parts[2]);
    } else {
        const today = new Date();
        currentPickerValue.year = today.getFullYear();
        currentPickerValue.month = today.getMonth() + 1;
        currentPickerValue.day = today.getDate();
    }
    
    showDatePicker('day');
}

function openCustomTimePicker(input) {
    playSound('click');
    currentPickerInput = input;
    currentPickerType = 'time';
    
    // Mevcut deƒüeri parse et
    if (input.value) {
        const parts = input.value.split(':');
        currentPickerValue.hour = parseInt(parts[0]);
        currentPickerValue.minute = parseInt(parts[1]);
    } else {
        currentPickerValue.hour = 8;
        currentPickerValue.minute = 0;
    }
    
    showTimePicker('hour');
}

function showDatePicker(step) {
    const overlay = document.getElementById('customPickerOverlay');
    const title = document.getElementById('customPickerTitle');
    const grid = document.getElementById('customPickerGrid');
    
    grid.innerHTML = '';
    
    if (step === 'day') {
        title.textContent = 'üìÖ G√ºn Se√ßin';
        const daysInMonth = new Date(currentPickerValue.year, currentPickerValue.month, 0).getDate();
        
        for (let i = 1; i <= daysInMonth; i++) {
            const item = document.createElement('div');
            item.className = 'custom-picker-item';
            if (i === currentPickerValue.day) item.classList.add('selected');
            item.textContent = i;
            item.onclick = () => {
                currentPickerValue.day = i;
                playSound('click');
                showDatePicker('month');
            };
            grid.appendChild(item);
        }
    } else if (step === 'month') {
        title.textContent = 'üìÜ Ay Se√ßin';
        const months = ['Ocak', '≈ûubat', 'Mart', 'Nisan', 'Mayƒ±s', 'Haziran', 
                       'Temmuz', 'Aƒüustos', 'Eyl√ºl', 'Ekim', 'Kasƒ±m', 'Aralƒ±k'];
        
        months.forEach((month, index) => {
            const item = document.createElement('div');
            item.className = 'custom-picker-item';
            if (index + 1 === currentPickerValue.month) item.classList.add('selected');
            item.textContent = month;
            item.onclick = () => {
                currentPickerValue.month = index + 1;
                playSound('click');
                showDatePicker('year');
            };
            grid.appendChild(item);
        });
    } else if (step === 'year') {
        title.textContent = 'üìÖ Yƒ±l Se√ßin';
        const currentYear = new Date().getFullYear();
        
        for (let i = currentYear - 5; i <= currentYear + 5; i++) {
            const item = document.createElement('div');
            item.className = 'custom-picker-item';
            if (i === currentPickerValue.year) item.classList.add('selected');
            item.textContent = i;
            item.onclick = () => {
                currentPickerValue.year = i;
                playSound('click');
                applyDateValue();
            };
            grid.appendChild(item);
        }
    }
    
    overlay.style.display = 'flex';
    lucide.createIcons();
}

function showTimePicker(step) {
    const overlay = document.getElementById('customPickerOverlay');
    const title = document.getElementById('customPickerTitle');
    const grid = document.getElementById('customPickerGrid');
    
    grid.innerHTML = '';
    
    if (step === 'hour') {
        title.textContent = 'üïê Saat Se√ßin';
        
        for (let i = 0; i < 24; i++) {
            const item = document.createElement('div');
            item.className = 'custom-picker-item';
            if (i === currentPickerValue.hour) item.classList.add('selected');
            item.textContent = i.toString().padStart(2, '0');
            item.onclick = () => {
                currentPickerValue.hour = i;
                playSound('click');
                showTimePicker('minute');
            };
            grid.appendChild(item);
        }
    } else if (step === 'minute') {
        title.textContent = '‚è∞ Dakika Se√ßin';
        
        for (let i = 0; i < 60; i += 5) {
            const item = document.createElement('div');
            item.className = 'custom-picker-item';
            if (i === currentPickerValue.minute) item.classList.add('selected');
            item.textContent = i.toString().padStart(2, '0');
            item.onclick = () => {
                currentPickerValue.minute = i;
                playSound('click');
                applyTimeValue();
            };
            grid.appendChild(item);
        }
    }
    
    overlay.style.display = 'flex';
    lucide.createIcons();
}

function applyDateValue() {
    const dateStr = `${currentPickerValue.year}-${currentPickerValue.month.toString().padStart(2, '0')}-${currentPickerValue.day.toString().padStart(2, '0')}`;
    currentPickerInput.value = dateStr;
    
    // Change event'i tetikle
    const event = new Event('change', { bubbles: true });
    currentPickerInput.dispatchEvent(event);
    
    createInputCelebration(currentPickerInput);
    closeCustomPicker();
}

function applyTimeValue() {
    const timeStr = `${currentPickerValue.hour.toString().padStart(2, '0')}:${currentPickerValue.minute.toString().padStart(2, '0')}`;
    currentPickerInput.value = timeStr;
    
    // Change event'i tetikle
    const event = new Event('change', { bubbles: true });
    currentPickerInput.dispatchEvent(event);
    
    createInputCelebration(currentPickerInput);
    closeCustomPicker();
}

function closeCustomPicker() {
    playSound('click');
    document.getElementById('customPickerOverlay').style.display = 'none';
    currentPickerInput = null;
    currentPickerType = null;
}

function createInputCelebration(element) {
    // Mini kutlama efekti
    const rect = element.getBoundingClientRect();
    const colors = ['var(--primary-color)', 'var(--accent-color)', '#f59e0b', '#10b981'];
    
    for (let i = 0; i < 8; i++) {
        const particle = document.createElement('div');
        particle.style.position = 'fixed';
        particle.style.width = '8px';
        particle.style.height = '8px';
        particle.style.borderRadius = '50%';
        particle.style.background = colors[i % colors.length];
        particle.style.pointerEvents = 'none';
        particle.style.zIndex = '100003';
        particle.style.boxShadow = '0 0 10px currentColor';
        
        particle.style.left = rect.left + rect.width / 2 + 'px';
        particle.style.top = rect.top + rect.height / 2 + 'px';
        
        document.body.appendChild(particle);
        
        const angle = (Math.PI * 2 * i) / 8;
        const velocity = 60;
        const vx = Math.cos(angle) * velocity;
        const vy = Math.sin(angle) * velocity;
        
        let posX = 0, posY = 0, opacity = 1;
        const animate = () => {
            posX += vx * 0.05;
            posY += vy * 0.05 + 1;
            opacity -= 0.02;
            
            particle.style.transform = `translate(${posX}px, ${posY}px) scale(${opacity})`;
            particle.style.opacity = opacity;
            
            if (opacity > 0) {
                requestAnimationFrame(animate);
            } else {
                particle.remove();
            }
        };
        animate();
    }
    
    // Ses efekti
    playSound('click');
}

// Input pop animasyonu
const style = document.createElement('style');
style.textContent = `
    @keyframes inputPop {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
`;
document.head.appendChild(style);

// ESC tu≈üu ile wizard'ƒ± kapat
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        const overlay = document.getElementById('travelWizardOverlay');
        if (overlay && overlay.style.display === 'flex') {
            closeTravelWizard();
        }
    }
});

// Overlay'e tƒ±klandƒ±ƒüƒ±nda kapat
document.addEventListener('click', function(e) {
    if (e.target.id === 'travelWizardOverlay') {
        closeTravelWizard();
    }
});

function selectWizardOption(card, field, value) {
    // Remove selected from siblings
    card.parentElement.querySelectorAll('.wizard-option-card').forEach(c => c.classList.remove('selected'));
    card.classList.add('selected');
    
    wizardData[field] = value;
    
    // G√∂rev kategorisi se√ßildiƒüinde
    if (field === 'gorevKategorisi') {
        // Otomatik olarak bir sonraki adƒ±ma ge√ß
        setTimeout(() => {
            wizardNextStep();
        }, 300);
    }
    
    // G√∂rev t√ºr√º se√ßildiƒüinde (g√ºn√ºbirlik/√ßoklu)
    if (field === 'gorevTuru') {
        wizardData.type = value;
        
        // Bug√ºn√ºn tarihini set et
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('wizardStartDate').value = today;
        document.getElementById('wizardEndDate').value = today;
        wizardData.startDate = today;
        wizardData.endDate = today;
        
        // Otomatik olarak bir sonraki adƒ±ma ge√ß
        setTimeout(() => {
            wizardNextStep();
        }, 300);
    }
    
    lucide.createIcons();
}

function handleWizardDateChange() {
    playSound('click');
    
    const startDate = document.getElementById('wizardStartDate').value;
    const endDate = document.getElementById('wizardEndDate').value;
    
    // Step 3: Ba≈ülangƒ±√ß tarihi
    if (wizardCurrentStep === 3 && startDate) {
        wizardData.startDate = startDate;
        if (wizardData.type === 'gunubirlik') {
            wizardData.endDate = startDate; // G√ºn√ºbirlik i√ßin aynƒ± g√ºn
        }
        document.getElementById('wizardNextBtn').disabled = false;
        createMiniCelebration(event.target);
    }
    
    // Step 4: Biti≈ü tarihi (√ßoklu g√∂rev i√ßin)
    if (wizardCurrentStep === 4 && endDate) {
        wizardData.endDate = endDate;
        
        // Calculate nights for accommodation placeholder
        const start = new Date(wizardData.startDate);
        const end = new Date(endDate);
        const nights = Math.round(Math.abs(end - start) / 86400000);
        document.getElementById('wizardKonaklama').placeholder = `${nights} gece konaklama ‚ú®`;
        
        document.getElementById('wizardNextBtn').disabled = false;
        createMiniCelebration(event.target);
    }
}

function createMiniCelebration(element) {
    // K√º√ß√ºk confetti efekti
    for (let i = 0; i < 5; i++) {
        const particle = document.createElement('div');
        particle.style.position = 'fixed';
        particle.style.width = '6px';
        particle.style.height = '6px';
        particle.style.borderRadius = '50%';
        particle.style.background = ['var(--primary-color)', 'var(--accent-color)', '#f59e0b'][i % 3];
        particle.style.pointerEvents = 'none';
        particle.style.zIndex = '100001';
        
        const rect = element.getBoundingClientRect();
        particle.style.left = rect.left + rect.width / 2 + 'px';
        particle.style.top = rect.top + rect.height / 2 + 'px';
        
        document.body.appendChild(particle);
        
        const angle = (Math.PI * 2 * i) / 5;
        const velocity = 50;
        const vx = Math.cos(angle) * velocity;
        const vy = Math.sin(angle) * velocity;
        
        let posX = 0, posY = 0;
        const animate = () => {
            posX += vx * 0.1;
            posY += vy * 0.1 + 2;
            particle.style.transform = `translate(${posX}px, ${posY}px)`;
            particle.style.opacity = Math.max(0, 1 - posY / 100);
            
            if (posY < 100) {
                requestAnimationFrame(animate);
            } else {
                particle.remove();
            }
        };
        animate();
    }
}

function addWizardTransport() {
    playSound('click');
    const list = document.getElementById('wizardTransportList');
    const index = list.children.length;
    
    const item = document.createElement('div');
    item.className = 'wizard-transport-item';
    
    // Varsayƒ±lan tarih
    const defaultDate = wizardData.startDate || new Date().toISOString().split('T')[0];
    
    item.innerHTML = `<select class="transport-type" onchange="handleWizardTransportChange(this)"><option value="">Se√ßiniz</option><option value="Otob√ºs">Otob√ºs</option><option value="U√ßak">U√ßak</option><option value="Tren">Tren</option><option value="Taksi">Taksi</option><option value="Resmi Ara√ß">Resmi Ara√ß</option><option value="√ñzel Ara√ß">√ñzel Ara√ß</option></select><input type="text" class="transport-description" placeholder="A√ßƒ±klama"><input type="number" step="0.01" class="transport-cost" placeholder="√úcret"><input type="date" class="transport-date" value="${defaultDate}"><button class="icon-btn" style="color: #ef4444;" onclick="this.parentElement.remove(); playSound('click');"><i data-lucide="x"></i></button>`;
    
    list.appendChild(item);
    lucide.createIcons();
}

function handleWizardTransportChange(selectElement) {
    const item = selectElement.closest('.wizard-transport-item');
    const descInput = item.querySelector('.transport-description');
    const transportType = selectElement.value;
    const route = document.getElementById('wizardRoute').value || 'Hedef';
    const homeBase = document.getElementById('g√∂revYeri')?.value || 'Sinop';
    
    const allItems = Array.from(document.querySelectorAll('.wizard-transport-item'));
    const currentIndex = allItems.indexOf(item);
    
    let suggestion = '';
    switch (transportType) {
        case 'Otob√ºs':
            suggestion = (currentIndex > 0) ? `${route}‚Äì${homeBase}` : `${homeBase}‚Äì${route}`;
            break;
        case 'Taksi':
            let isArrivalTaxi = true;
            for (let i = 0; i < currentIndex; i++) {
                if (allItems[i].querySelector('.transport-type').value === 'Taksi') {
                    isArrivalTaxi = false;
                    break;
                }
            }
            suggestion = isArrivalTaxi ? 'Terminal‚ÄìOtel' : 'Otel‚ÄìTerminal';
            break;
        case 'Tren':
            suggestion = (currentIndex > 0) ? `Ankara‚Äì${homeBase}` : `${homeBase}‚ÄìAnkara`;
            break;
        case 'U√ßak':
            suggestion = (currentIndex > 0) ? `Ankara‚Äì${homeBase} (U√ßu≈ü)` : `${homeBase}‚ÄìAnkara (U√ßu≈ü)`;
            break;
        case 'Resmi Ara√ß':
            suggestion = (currentIndex > 0) ? `${route}‚Äì${homeBase} (Resmi Ara√ß)` : `${homeBase}‚Äì${route} (Resmi Ara√ß)`;
            break;
        case '√ñzel Ara√ß':
            suggestion = (currentIndex > 0) ? `${route}‚Äì${homeBase} (√ñzel Ara√ß)` : `${homeBase}‚Äì${route} (√ñzel Ara√ß)`;
            break;
    }
    
    descInput.value = suggestion;
}

function wizardNextStep() {
    playSound('click');
    
    // Celebration effect
    createSuccessBurst();
    
    if (wizardCurrentStep < 12) {
        wizardCurrentStep++;
        
        // G√ºn√ºbirlik g√∂rev i√ßin: Step 4,5,6,11'i atla (biti≈ü tarihi, gidi≈ü s√ºresi, d√∂n√º≈ü s√ºresi, konaklama)
        if (wizardData.type === 'gunubirlik') {
            if (wizardCurrentStep === 4) wizardCurrentStep = 7; // Biti≈ü tarihini atla, gidi≈ü saatine git
            else if (wizardCurrentStep === 11) wizardCurrentStep = 12; // Konaklamayƒ± atla
        }
        
        // √áoklu g√∂rev i√ßin: Step 4,6,7,8'i atla (eski biti≈ü tarihi, eski d√∂n√º≈ü s√ºresi, gidi≈ü saati, d√∂n√º≈ü saati)
        if (wizardData.type === 'coklu') {
            if (wizardCurrentStep === 4) wizardCurrentStep = 5; // Eski biti≈ü tarihini atla
            else if (wizardCurrentStep === 6) wizardCurrentStep = 9; // Eski d√∂n√º≈ü s√ºresini atla, g√ºzergaha git
            else if (wizardCurrentStep === 7) wizardCurrentStep = 9; // Saatleri atla
        }
        
        updateWizardStep();
    }
}

function createSuccessBurst() {
    const modal = document.querySelector('.wizard-modal');
    if (!modal) return;
    
    const burst = document.createElement('div');
    burst.className = 'wizard-success-burst';
    modal.appendChild(burst);
    
    setTimeout(() => burst.remove(), 600);
    
    // Create confetti
    for (let i = 0; i < 15; i++) {
        setTimeout(() => createConfetti(), i * 50);
    }
}

function createConfetti() {
    const modal = document.querySelector('.wizard-modal');
    if (!modal) return;
    
    const confetti = document.createElement('div');
    confetti.className = 'wizard-confetti';
    
    const colors = [
        'var(--primary-color)',
        'var(--accent-color)',
        '#f59e0b',
        '#10b981',
        '#8b5cf6'
    ];
    
    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
    confetti.style.left = Math.random() * 100 + '%';
    confetti.style.top = '0';
    confetti.style.width = (Math.random() * 10 + 5) + 'px';
    confetti.style.height = confetti.style.width;
    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
    
    modal.appendChild(confetti);
    
    setTimeout(() => confetti.remove(), 3000);
}

function wizardPrevStep() {
    playSound('click');
    
    if (wizardCurrentStep > 1) {
        wizardCurrentStep--;
        
        // G√ºn√ºbirlik g√∂rev i√ßin geriye giderken atlamalar
        if (wizardData.type === 'gunubirlik') {
            if (wizardCurrentStep === 11) wizardCurrentStep = 10; // Konaklamayƒ± atla
            else if (wizardCurrentStep === 6) wizardCurrentStep = 3; // Gidi≈ü/d√∂n√º≈ü s√ºrelerini atla
            else if (wizardCurrentStep === 4) wizardCurrentStep = 3; // Biti≈ü tarihini atla
        }
        
        // √áoklu g√∂rev i√ßin geriye giderken atlamalar
        if (wizardData.type === 'coklu') {
            if (wizardCurrentStep === 9) wizardCurrentStep = 5; // Step 6,7,8'i atla, s√ºrelere git
            else if (wizardCurrentStep === 8) wizardCurrentStep = 5; // Saatleri atla
            else if (wizardCurrentStep === 7) wizardCurrentStep = 5; // Saatleri atla
            else if (wizardCurrentStep === 6) wizardCurrentStep = 5; // Eski d√∂n√º≈ü s√ºresini atla
            else if (wizardCurrentStep === 5) wizardCurrentStep = 3; // Step 4'√º atla
            else if (wizardCurrentStep === 4) wizardCurrentStep = 3; // Eski biti≈ü tarihini atla
        }
        
        updateWizardStep();
    }
}

function updateWizardStep() {
    // Update step visibility
    document.querySelectorAll('.wizard-step').forEach((step, index) => {
        step.classList.toggle('active', index + 1 === wizardCurrentStep);
    });
    
    // Step 3'te ba≈ülƒ±k ve a√ßƒ±klama g√∂rev tipine g√∂re dinamik deƒüi≈ütir
    if (wizardCurrentStep === 3) {
        const titleElement = document.querySelector('.wizard-step[data-step="3"] .wizard-step-title');
        const descElement = document.querySelector('.wizard-step[data-step="3"] .wizard-step-description');
        
        if (titleElement && descElement) {
            if (wizardData.type === 'gunubirlik') {
                titleElement.innerHTML = '<i data-lucide="calendar"></i>\n                        G√∂rev Tarihi';
                descElement.textContent = 'G√∂revinizin tarihini se√ßin';
            } else {
                titleElement.innerHTML = '<i data-lucide="calendar"></i>\n                        G√∂rev Tarihleri';
                descElement.textContent = 'G√∂revinizin ba≈ülangƒ±√ß ve biti≈ü tarihlerini se√ßin';
            }
        }
    }
    
    // Step 3'te biti≈ü tarihi alanƒ±nƒ± g√∂rev tipine g√∂re g√∂ster/gizle
    if (wizardCurrentStep === 3) {
        const endDateGroup = document.querySelector('.wizard-end-date-group');
        if (endDateGroup && wizardData.type) {
            if (wizardData.type === 'gunubirlik') {
                endDateGroup.style.display = 'none';
            } else {
                endDateGroup.style.display = 'flex';
            }
        }
    }
    
    // Update progress bar
    document.querySelectorAll('.wizard-progress-step').forEach((step, index) => {
        step.classList.toggle('active', index < wizardCurrentStep);
    });
    
    // Update buttons
    const backBtn = document.getElementById('wizardBackBtn');
    const nextBtn = document.getElementById('wizardNextBtn');
    const finishBtn = document.getElementById('wizardFinishBtn');
    
    backBtn.style.display = wizardCurrentStep > 1 ? 'flex' : 'none';
    
    if (wizardCurrentStep === 12) {
        nextBtn.style.display = 'none';
        finishBtn.style.display = 'flex';
    } else {
        nextBtn.style.display = 'flex';
        finishBtn.style.display = 'none';
        
        // Check if current step is valid
        let isValid = true;
        if (wizardCurrentStep === 1) {
            isValid = wizardData.gorevKategorisi !== null;
        } else if (wizardCurrentStep === 2) {
            isValid = wizardData.type !== null;
        } else if (wizardCurrentStep === 3) {
            const startDate = document.getElementById('wizardStartDate').value;
            // G√ºn√ºbirlik g√∂revde sadece ba≈ülangƒ±√ß tarihi yeterli
            if (wizardData.type === 'gunubirlik') {
                isValid = !!startDate;
            } else {
                // √áoklu g√∂revde hem ba≈ülangƒ±√ß hem biti≈ü tarihi gerekli
                const endDate = document.getElementById('wizardEndDate').value;
                isValid = !!startDate && !!endDate;
            }
        } else if (wizardCurrentStep === 4) {
            const endDate = document.getElementById('wizardEndDate').value;
            isValid = !!endDate;
        }
        
        nextBtn.disabled = !isValid;
    }
    
    // Auto-focus ilk input'a (select olmadan)
    setTimeout(() => {
        const activeStep = document.querySelector('.wizard-step.active');
        if (activeStep) {
            const firstInput = activeStep.querySelector('input[type="date"], input[type="time"], input[type="number"], input[type="text"], textarea');
            if (firstInput) {
                firstInput.focus();
                // Cursor'u sona koy (select kullanma)
                if (firstInput.value) {
                    firstInput.setSelectionRange(firstInput.value.length, firstInput.value.length);
                }
            }
        }
    }, 100);
    
    lucide.createIcons();
}

function finishWizard() {
    playSound('success');
    
    // Collect data from form based on type
    wizardData.startDate = document.getElementById('wizardStartDate').value;
    wizardData.route = document.getElementById('wizardRoute').value;
    wizardData.konu = document.getElementById('wizardKonu').value;
    
    if (wizardData.type === 'gunubirlik') {
        wizardData.endDate = wizardData.startDate;
        wizardData.startTime = document.getElementById('wizardStartTime').value;
        wizardData.endTime = document.getElementById('wizardEndTime').value;
    } else {
        // √áoklu g√∂rev i√ßin
        wizardData.endDate = document.getElementById('wizardEndDate').value;
        wizardData.gidisSuresi = parseInt(document.getElementById('wizardGidisSuresi').value) || 1;
        wizardData.donusSuresi = parseInt(document.getElementById('wizardDonusSuresi').value) || 1;
        wizardData.konaklama = document.getElementById('wizardKonaklama').value;
    }
    
    // Collect transport data
    wizardData.transport = [];
    document.querySelectorAll('.wizard-transport-item').forEach(item => {
        const type = item.querySelector('.transport-type').value;
        const description = item.querySelector('.transport-description').value;
        const cost = item.querySelector('.transport-cost').value;
        const date = item.querySelector('.transport-date')?.value || wizardData.startDate;
        
        if (type) {
            // Emoji'leri temizle
            const cleanType = type.replace(/[\u{1F300}-\u{1F9FF}]/gu, '').trim();
            wizardData.transport.push({
                type: cleanType,
                description: description,
                cost: cost,
                date: date
            });
        }
    });
    
    // Create travel entry with wizard data
    const entry = {
        type: wizardData.type,
        gorevTipi: wizardData.gorevKategorisi,
        date: wizardData.startDate,
        route: wizardData.route,
        start: wizardData.startTime,
        end: wizardData.endTime,
        konu: wizardData.konu,
        startDate: wizardData.startDate,
        endDate: wizardData.endDate,
        startTime: wizardData.startTime,
        endTime: wizardData.endTime,
        totalAccommodation: wizardData.konaklama,
        gidisSuresi: wizardData.gidisSuresi,
        donusSuresi: wizardData.donusSuresi,
        transport: wizardData.transport,
        isCollapsed: false
    };
    
    addTravelEntry(entry, false);
    closeTravelWizard();
    
    showToast("Seyahat ba≈üarƒ±yla eklendi!", "success");
}
    </script>

    <!-- Floating Bilgilendirme Kartƒ± -->
    <div class="floating-info-card" id="floatingInfoCard">
        <button class="close-btn"
            onclick="document.getElementById('floatingInfoCard').style.display='none'; localStorage.setItem('hideInfoCard', 'true');"
            aria-label="Kapat">
            <i data-lucide="x" style="width: 18px; height: 18px;"></i>
        </button>
        <div class="info-icon">
            <i data-lucide="sparkles" style="width: 20px; height: 20px; stroke-width: 2.5;"></i>
        </div>
        <h5>
            <i data-lucide="save" style="width: 16px; height: 16px; color: var(--primary-color);"></i>
            Otomatik Kayƒ±t Sistemi
        </h5>
        <p>
            Merkezi bilgileriniz <strong>otomatik olarak kaydedilir</strong> ve se√ßtiƒüiniz profile √∂zel saklanƒ±r.
            Her seferinde tekrar girmenize gerek yoktur. Profil deƒüi≈ütirdiƒüinizde bilgileriniz otomatik y√ºklenir.
        </p>
    </div>

    <script>
        // Floating info kartƒ±nƒ± kontrol et
        document.addEventListener('DOMContentLoaded', () => {
            const hideInfoCard = localStorage.getItem('hideInfoCard');
            const infoCard = document.getElementById('floatingInfoCard');

            if (hideInfoCard === 'true') {
                infoCard.style.display = 'none';
            } else {
                // Kartƒ± g√∂r√ºn√ºr yap (animasyon CSS'de)
                infoCard.style.display = 'block';
            }

            // ƒ∞konlarƒ± yenile
            setTimeout(() => {
                lucide.createIcons();
            }, 100);
        });
    </script>

    <!-- Wizard Modal for Travel Entry -->
    <div id="travelWizardOverlay" class="travel-wizard-overlay" style="display: none;">
        <div class="travel-wizard-modal">
            <button class="wizard-close-btn" onclick="closeTravelWizard()" title="Kapat">√ó</button>
            
            <div class="wizard-header">
                <h2 class="wizard-title">
                    <i data-lucide="sparkles"></i>
                    Yeni Seyahat Ekle
                </h2>
                <p class="wizard-subtitle">Adƒ±m adƒ±m seyahat bilgilerinizi girin</p>
                <div class="wizard-progress">
                    <div class="wizard-progress-step active"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                    <div class="wizard-progress-step"></div>
                </div>
            </div>
            
            <div class="wizard-body">
                <!-- Step 1: G√∂rev Kategorisi -->
                <div class="wizard-step active" data-step="1">
                    <h3 class="wizard-step-title">
                        <i data-lucide="briefcase"></i>
                        G√∂rev Kategorisi
                    </h3>
                    <p class="wizard-step-description">G√∂revinizin t√ºr√ºn√º se√ßin</p>
                    <div class="wizard-option-grid">
                        <div class="wizard-option-card" onclick="selectWizardOption(this, 'gorevKategorisi', 'normal')">
                            <div class="wizard-option-icon">üéØ</div>
                            <h4 class="wizard-option-title">Normal G√∂rev</h4>
                            <p class="wizard-option-desc">Standart g√∂revlendirme</p>
                        </div>
                        <div class="wizard-option-card" onclick="selectWizardOption(this, 'gorevKategorisi', 'seminer')">
                            <div class="wizard-option-icon">üìö</div>
                            <h4 class="wizard-option-title">Seminer/Eƒüitim</h4>
                            <p class="wizard-option-desc">Eƒüitim ve seminer katƒ±lƒ±mƒ±</p>
                        </div>
                    </div>
                </div>
                
                <!-- Step 2: G√∂rev T√ºr√º (G√ºn√ºbirlik/√áoklu) -->
                <div class="wizard-step" data-step="2">
                    <h3 class="wizard-step-title">
                        <i data-lucide="calendar-range"></i>
                        G√∂rev T√ºr√º
                    </h3>
                    <p class="wizard-step-description">G√∂reviniz ka√ß g√ºn s√ºrd√º?</p>
                    <div class="wizard-option-grid">
                        <div class="wizard-option-card" onclick="selectWizardOption(this, 'gorevTuru', 'gunubirlik')">
                            <div class="wizard-option-icon">üìÖ</div>
                            <h4 class="wizard-option-title">G√ºn√ºbirlik</h4>
                            <p class="wizard-option-desc">Tek g√ºnl√ºk g√∂rev</p>
                        </div>
                        <div class="wizard-option-card" onclick="selectWizardOption(this, 'gorevTuru', 'coklu')">
                            <div class="wizard-option-icon">üè®</div>
                            <h4 class="wizard-option-title">√áoklu G√ºn</h4>
                            <p class="wizard-option-desc">Konaklama gerektiren g√∂rev</p>
                        </div>
                    </div>
                </div>
                
                <!-- Step 3: Ba≈ülangƒ±√ß Tarihi -->
                <div class="wizard-step" data-step="3">
                    <h3 class="wizard-step-title">
                        <i data-lucide="calendar"></i>
                        G√∂rev Tarihleri
                    </h3>
                    <p class="wizard-step-description">G√∂revinizin ba≈ülangƒ±√ß ve biti≈ü tarihlerini se√ßin</p>
                    
                    <div class="wizard-date-grid">
                        <div class="wizard-input-group">
                            <label>
                                <i data-lucide="calendar-days"></i> 
                                Ba≈ülangƒ±√ß Tarihi
                            </label>
                            <input type="date" id="wizardStartDate" onchange="handleWizardDateChange()">
                        </div>
                        <div class="wizard-input-group wizard-end-date-group">
                            <label>
                                <i data-lucide="calendar-check"></i> 
                                Biti≈ü Tarihi
                            </label>
                            <input type="date" id="wizardEndDate" onchange="handleWizardDateChange()">
                        </div>
                    </div>
                </div>
                
                <!-- Step 4: Biti≈ü Tarihi (Sadece √ßoklu g√∂rev i√ßin) - ARTIK KULLANILMIYOR -->
                <div class="wizard-step" data-step="4" style="display: none;">
                    <h3 class="wizard-step-title">
                        <i data-lucide="calendar-check"></i>
                        Biti≈ü Tarihi
                    </h3>
                    <p class="wizard-step-description">G√∂reviniz ne zaman bitti?</p>
                    
                    <div style="max-width: 700px; margin: 0 auto; width: 100%;">
                        <div class="wizard-input-group">
                            <label style="justify-content: center; font-size: 1.8rem; margin-bottom: 1.5rem;"><i data-lucide="calendar-days" style="width: 32px; height: 32px;"></i> Biti≈ü Tarihi</label>
                            <input type="date" id="wizardEndDate_old" onchange="handleWizardDateChange()" style="text-align: center;">
                        </div>
                    </div>
                </div>
                
                <!-- Step 5: Gidi≈ü ve D√∂n√º≈ü S√ºreleri (Sadece √ßoklu g√∂rev i√ßin) -->
                <div class="wizard-step" data-step="5">
                    <h3 class="wizard-step-title">
                        <i data-lucide="clock"></i>
                        Yolculuk S√ºreleri
                    </h3>
                    <p class="wizard-step-description">Gidi≈ü ve d√∂n√º≈ü yolculuklarƒ±nƒ±z ka√ß g√ºn s√ºrd√º?</p>
                    
                    <div class="wizard-duration-grid">
                        <div class="wizard-input-group">
                            <label>
                                <i data-lucide="arrow-right"></i> 
                                Gidi≈ü S√ºresi (G√ºn)
                            </label>
                            <input type="number" id="wizardGidisSuresi" value="1" min="1" onchange="document.getElementById('wizardNextBtn').disabled = false;">
                        </div>
                        <div class="wizard-input-group">
                            <label>
                                <i data-lucide="arrow-left"></i> 
                                D√∂n√º≈ü S√ºresi (G√ºn)
                            </label>
                            <input type="number" id="wizardDonusSuresi" value="1" min="1" onchange="document.getElementById('wizardNextBtn').disabled = false;">
                        </div>
                    </div>
                </div>
                
                <!-- Step 6: D√∂n√º≈ü S√ºresi (Sadece √ßoklu g√∂rev i√ßin) - ARTIK KULLANILMIYOR -->
                <div class="wizard-step" data-step="6" style="display: none;">
                    <h3 class="wizard-step-title">
                        <i data-lucide="arrow-left"></i>
                        D√∂n√º≈ü S√ºresi
                    </h3>
                    <p class="wizard-step-description">D√∂n√º≈ü yolculuƒüu ka√ß g√ºn s√ºrd√º?</p>
                    
                    <div style="max-width: 600px; margin: 0 auto; width: 100%;">
                        <div class="wizard-input-group">
                            <label style="justify-content: center; font-size: 1.8rem; margin-bottom: 1.5rem;"><i data-lucide="clock" style="width: 32px; height: 32px;"></i> G√ºn Sayƒ±sƒ±</label>
                            <input type="number" id="wizardDonusSuresi_old" value="1" min="1" onchange="document.getElementById('wizardNextBtn').disabled = false;" style="text-align: center;">
                        </div>
                    </div>
                </div>
                
                <!-- Step 7: Gidi≈ü Saati (Sadece g√ºn√ºbirlik i√ßin) -->
                <div class="wizard-step" data-step="7">
                    <h3 class="wizard-step-title">
                        <i data-lucide="sunrise"></i>
                        Gidi≈ü Saati
                    </h3>
                    <p class="wizard-step-description">Saat ka√ßta yola √ßƒ±ktƒ±nƒ±z?</p>
                    
                    <div style="max-width: 550px; margin: 0 auto; width: 100%;">
                        <div class="wizard-input-group">
                            <label>
                                <i data-lucide="clock"></i> 
                                Gidi≈ü Saati
                            </label>
                            <input type="time" id="wizardStartTime" value="08:00" onchange="document.getElementById('wizardNextBtn').disabled = false;">
                        </div>
                    </div>
                </div>
                
                <!-- Step 8: D√∂n√º≈ü Saati (Sadece g√ºn√ºbirlik i√ßin) -->
                <div class="wizard-step" data-step="8">
                    <h3 class="wizard-step-title">
                        <i data-lucide="sunset"></i>
                        D√∂n√º≈ü Saati
                    </h3>
                    <p class="wizard-step-description">Saat ka√ßta d√∂nd√ºn√ºz?</p>
                    
                    <div style="max-width: 550px; margin: 0 auto; width: 100%;">
                        <div class="wizard-input-group">
                            <label>
                                <i data-lucide="clock"></i> 
                                D√∂n√º≈ü Saati
                            </label>
                            <input type="time" id="wizardEndTime" value="17:00" onchange="document.getElementById('wizardNextBtn').disabled = false;">
                        </div>
                    </div>
                </div>
                
                <!-- Step 9: G√ºzergah -->
                <div class="wizard-step" data-step="9">
                    <h3 class="wizard-step-title">
                        <i data-lucide="map"></i>
                        G√ºzergah
                    </h3>
                    <p class="wizard-step-description">Nereye gittiniz?</p>
                    
                    <div style="max-width: 850px; margin: 0 auto; width: 100%; padding: 0 2rem;">
                        <div class="wizard-input-group">
                            <label style="justify-content: center; font-size: 1.1rem; font-weight: 600; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.6rem;">
                                <i data-lucide="map-pin" style="width: 22px; height: 22px;"></i> 
                                G√ºzergah
                            </label>
                            <!-- G√úZERGAH UYARI METNƒ∞ (Sihirbaz) -->
                            <div style="text-align:center; margin-bottom:10px; color: var(--text-secondary); font-size: 0.95rem; font-weight:500;">
                                Zincirleme seyahat i√ßin ≈üehirlerin arasƒ±na <b style="color:var(--primary-color);">tire (-)</b> veya <b style="color:var(--primary-color);">virg√ºl (,)</b> koyunuz.
                            </div>
                            <div style="position: relative;">
                                <input type="text" id="wizardRoute" placeholder="√∂rn: Kastamonu - Ankara - Sinop" onchange="document.getElementById('wizardNextBtn').disabled = false;" style="text-align: center; font-size: 1.3rem; padding: 1.2rem 1.5rem; border-radius: 12px; width: 100%;">
                                <div class="autocomplete-items" style="display:none;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Step 10: G√∂rev Konusu -->
                <div class="wizard-step" data-step="10">
                    <h3 class="wizard-step-title">
                        <i data-lucide="file-text"></i>
                        G√∂rev Konusu
                    </h3>
                    <p class="wizard-step-description">G√∂revinizin konusu nedir?</p>
                    
                    <div style="max-width: 850px; margin: 0 auto; width: 100%; padding: 0 2rem;">
                        <div class="wizard-input-group">
                            <label style="justify-content: center; font-size: 1.1rem; font-weight: 600; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.6rem;">
                                <i data-lucide="briefcase" style="width: 22px; height: 22px;"></i> 
                                G√∂rev Konusu
                            </label>
                            <div style="position: relative;">
                                <input type="text" id="wizardKonu" placeholder="√∂rn: Av ve Yaban Hayatƒ± Saha ƒ∞≈üleri" value="Av ve Yaban Hayatƒ± ile ƒ∞lgili Saha ƒ∞≈üleri" onchange="document.getElementById('wizardNextBtn').disabled = false;" style="text-align: center; font-size: 1.3rem; padding: 1.2rem 1.5rem; border-radius: 12px; width: 100%;">
                                <div class="autocomplete-items" style="display:none;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Step 11: Konaklama (Sadece √ßoklu g√∂rev i√ßin) -->
                <div class="wizard-step" data-step="11">
                    <h3 class="wizard-step-title">
                        <i data-lucide="home"></i>
                        Konaklama Bilgileri
                    </h3>
                    <p class="wizard-step-description">Konaklama √ºcretinizi girin veya atlayƒ±n</p>
                    
                    <div style="display: flex; justify-content: center; margin-bottom: 3rem;">
                        <button class="wizard-btn wizard-btn-secondary" onclick="wizardNextStep()" style="font-size: 1.2rem; padding: 1rem 2.5rem; border-radius: 14px; display: flex; align-items: center; gap: 0.6rem;">
                            <i data-lucide="skip-forward"></i>
                            Konaklama Yok, Atla
                        </button>
                    </div>
                    
                    <div style="max-width: 650px; margin: 0 auto; width: 100%;">
                        <div class="wizard-input-group">
                            <label style="justify-content: center; font-size: 1.1rem; font-weight: 600; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.6rem;">
                                <i data-lucide="banknote" style="width: 22px; height: 22px;"></i> 
                                Toplam Konaklama √úcreti (TL)
                            </label>
                            <input type="number" id="wizardKonaklama" placeholder="0.00" step="0.01" style="text-align: center; font-size: 1.3rem; padding: 1.2rem; border-radius: 12px; width: 100%;">
                            <small style="text-align: center; display: flex; align-items: center; justify-content: center; gap: 0.5rem; margin-top: 1rem; opacity: 0.7; font-size: 0.95rem;">
                                <i data-lucide="info" style="width: 16px; height: 16px;"></i>
                                T√ºm konaklama g√ºnlerinin toplam √ºcretini girin
                            </small>
                        </div>
                    </div>
                </div>
                
                <!-- Step 12: Ta≈üƒ±t Giderleri -->
                <div class="wizard-step" data-step="12">
                    <h3 class="wizard-step-title">
                        <i data-lucide="car"></i>
                        Ta≈üƒ±t Giderleri
                    </h3>
                    <p class="wizard-step-description">Ula≈üƒ±m giderlerinizi ekleyin veya atlayƒ±n</p>
                    
                    <div class="wizard-transport-skip-container">
                        <button class="wizard-transport-skip-btn" onclick="finishWizard()">
                            <i data-lucide="skip-forward"></i>
                            Ta≈üƒ±t Gideri Yok, Atla
                        </button>
                    </div>
                    
                    <div class="wizard-transport-list" id="wizardTransportList">
                        <!-- Transport items will be added here -->
                    </div>
                    
                    <button class="wizard-add-transport-btn" onclick="addWizardTransport()">
                        <i data-lucide="plus"></i>
                        Ta≈üƒ±t Gideri Ekle
                    </button>
                </div>
            </div>
            
            <div class="wizard-footer">
                <button class="wizard-btn wizard-btn-secondary" id="wizardBackBtn" onclick="wizardPrevStep()" style="display: none;">
                    <i data-lucide="arrow-left"></i>
                    Geri
                </button>
                <div style="flex: 1;"></div>
                <button class="wizard-btn wizard-btn-secondary" onclick="closeTravelWizard()">
                    ƒ∞ptal
                </button>
                <button class="wizard-btn wizard-btn-primary" id="wizardNextBtn" onclick="wizardNextStep()" disabled>
                    ƒ∞leri
                    <i data-lucide="arrow-right"></i>
                </button>
                <button class="wizard-btn wizard-btn-primary" id="wizardFinishBtn" onclick="finishWizard()" style="display: none;">
                    <i data-lucide="check"></i>
                    Tamamla
                </button>
            </div>
        </div>
    </div>

    <!-- Custom Date/Time Picker -->
    <div id="customPickerOverlay" class="custom-picker-overlay" style="display: none;">
        <div class="custom-picker-panel">
            <h3 class="custom-picker-title" id="customPickerTitle">Se√ßim Yapƒ±n</h3>
            <div class="custom-picker-grid" id="customPickerGrid"></div>
            <button class="custom-picker-close" onclick="closeCustomPicker()">Tamam</button>
        </div>
    </div>

    <!-- Verified Build | Necmettin ERGƒ∞N | Safe Enhancement Update v13.0 + Sound Effects -->
<!-- === FINAL LOGO D√úZELTME VE HATIRLATMA Sƒ∞STEMƒ∞ === -->
<script>
    // 1. √ñnce eski stil ve hatalarƒ± temizleyelim
    const existingLogoStyles = document.getElementById('logo-custom-styles');
    if (existingLogoStyles) existingLogoStyles.remove();

    // 2. Yeni Stilleri Ekleyelim
    const styleSheet = document.createElement("style");
    styleSheet.id = "logo-custom-styles";
    styleSheet.innerText = `
        /* Logo Kutusu Temel Tasarƒ±m */
        .logo-placeholder {
            width: 44px !important;
            height: 44px !important;
            border-radius: 12px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            background: rgba(255, 255, 255, 0.4) !important;
            border: 2px dashed var(--primary-color) !important; /* Kesik √ßizgili √ßer√ßeve */
            cursor: pointer !important;
            position: relative !important;
            overflow: hidden !important;
            transition: all 0.3s ease !important;
            box-shadow: none !important;
        }

        /* Logo Varken */
        .logo-placeholder.has-logo {
            border: none !important;
            background: transparent !important;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1) !important;
        }

        /* Logo Resmi */
        .logo-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
        }

        /* Logo Yokken √áƒ±kan ƒ∞kon */
        .logo-placeholder .default-icon {
            color: var(--primary-color);
            opacity: 0.6;
            transition: transform 0.3s ease;
        }

        .logo-placeholder:hover .default-icon {
            transform: scale(1.2);
            opacity: 1;
        }

        /* HATIRLATMA BALONCUƒûU (Animasyonlu) */
        .logo-add-hint {
            position: absolute;
            inset: 0;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 800;
            text-align: center;
            line-height: 1.1;
            transform: translateY(100%); /* Ba≈ülangƒ±√ßta a≈üaƒüƒ±da gizli */
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 10;
            pointer-events: none;
        }

        /* Uyarƒ± Aktif Sƒ±nƒ±fƒ± */
        .logo-placeholder.remind-active .logo-add-hint {
            transform: translateY(0); /* Yukarƒ± kay */
        }
        
        /* Uyarƒ± sƒ±rasƒ±nda √ßer√ßeve parlasƒ±n */
        .logo-placeholder.remind-active {
            border-color: var(--accent-color) !important;
            box-shadow: 0 0 10px var(--primary-color-translucent) !important;
            transform: scale(1.1);
        }
    `;
    document.head.appendChild(styleSheet);

    // 3. Mantƒ±k Kodlarƒ±
    document.addEventListener('DOMContentLoaded', () => {
        const leftDiv = document.getElementById('left-logo');
        const rightDiv = document.getElementById('right-logo');

        // Logo Durumunu Kontrol Et ve HTML'i Temizle
        function refreshLogos() {
            [leftDiv, rightDiv].forEach(div => {
                const isLeft = div.id === 'left-logo';
                const savedLogo = localStorage.getItem(isLeft ? 'leftLogo' : 'rightLogo');

                // Eƒüer localStorage'da veri varsa ama "null" stringi deƒüilse
                if (savedLogo && savedLogo.length > 50) { 
                    div.className = 'logo-placeholder has-logo';
                    // Temiz resim etiketi (Kƒ±rƒ±k linki √∂nler)
                    div.innerHTML = `<img src="${decodeURIComponent(atob(savedLogo))}" onerror="this.style.display='none'">`;
                    
                    // Silme butonu ekle
                    const delBtn = document.createElement('button');
                    delBtn.className = 'logo-delete-btn';
                    delBtn.innerHTML = '<i data-lucide="trash-2"></i>';
                    delBtn.onclick = (e) => {
                        e.stopPropagation();
                        if(confirm('Logoyu kaldƒ±rmak istiyor musunuz?')) {
                            localStorage.removeItem(isLeft ? 'leftLogo' : 'rightLogo');
                            refreshLogos();
                        }
                    };
                    div.appendChild(delBtn);
                } else {
                    // LOGO YOKSA: Temiz HTML (Img etiketi KOYMA)
                    div.className = 'logo-placeholder';
                    div.innerHTML = `
                        <i data-lucide="image-plus" class="default-icon" style="width:24px; height:24px;"></i>
                        <div class="logo-add-hint">Logo<br>Ekle</div>
                    `;
                }
            });
            if(typeof lucide !== 'undefined') lucide.createIcons();
        }

        // Hatƒ±rlatma Animasyon Fonksiyonu
        function triggerReminder() {
            [leftDiv, rightDiv].forEach(div => {
                // Sadece logo yoksa √ßalƒ±≈ütƒ±r
                if (!div.classList.contains('has-logo')) {
                    div.classList.add('remind-active');
                    
                    // 4 saniye sonra kapat
                    setTimeout(() => {
                        div.classList.remove('remind-active');
                    }, 4000);
                }
            });
        }

        // Ba≈ülat
        refreshLogos();

        // 1. TETƒ∞KLEYƒ∞Cƒ∞: Sayfa a√ßƒ±ldƒ±ktan 2 saniye sonra (En ba≈üta)
        setTimeout(triggerReminder, 2000);

        // 2. TETƒ∞KLEYƒ∞Cƒ∞: Her 3 dakikada bir (180000 ms)
        setInterval(triggerReminder, 180000);

        // Logo y√ºkleme olaylarƒ±nƒ± dinle (Mevcut yapƒ±yƒ± bozmadan)
        const uploader = document.getElementById('logo-uploader');
        if(uploader) {
            uploader.addEventListener('change', () => {
                setTimeout(refreshLogos, 500); // Y√ºkleme bitince yenile
            });
        }
    });
</script>

<!-- ========================================== -->
<!-- === Fƒ∞NAL PERFORMANS YAMASI (FIX) === -->
<!-- ========================================== -->
<script>
(function() {
    /* 1. ANIMASYONLARI DURDUR (ƒ∞≈ülemciyi yoran s√ºslemeler) */
    // Bu fonksiyonlarƒ± bo≈üaltarak i≈ülemci y√ºk√ºn√º azaltƒ±yoruz
    window.createMiniCelebration = function() {}; 
    window.createInputCelebration = function() {}; 
    window.createSuccessBurst = function() {};
    // Konfeti efektini √ßok hafifletiyoruz
    window.createConfetti = function() { console.log("Efekt atlandƒ±"); };

    /* 2. ƒ∞KON TARAMASINI SINIRLA (ANA KASMA SEBEBƒ∞ BURASI) */
    // Program normalde her tƒ±klamada t√ºm sayfayƒ± tarƒ±yor. 
    // Biz bunu sadece "a√ßƒ±k olan pencereyi" tarayacak ≈üekilde deƒüi≈ütiriyoruz.
    const originalLucide = lucide.createIcons;
    lucide.createIcons = function(options) {
        const wizardOverlay = document.getElementById('travelWizardOverlay');
        
        // Eƒüer Sihirbaz (Yeni Ekleme Ekranƒ±) a√ßƒ±ksa:
        if (wizardOverlay && wizardOverlay.style.display !== 'none') {
            // SADECE sihirbazƒ±n i√ßindeki ikonlarƒ± g√ºncelle, arka planƒ± elleme!
            originalLucide({
                root: wizardOverlay,
                attrs: {class: "lucide"},
                nameAttr: "data-lucide"
            });
        } else {
            // Sihirbaz kapalƒ±ysa normal √ßalƒ±≈üabilir
            originalLucide(options);
        }
    };

    /* 3. INPUT GECƒ∞KMELERƒ∞Nƒ∞ √ñNLEYEN CSS AYARLARI */
    const fastStyle = document.createElement('style');
    fastStyle.textContent = `
        /* Buzlu cam efektini tamamen kapat (GPU darboƒüazƒ±nƒ± √ß√∂zer) */
        .travel-wizard-overlay, .travel-wizard-modal, .wizard-step {
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
            background: rgba(255, 255, 255, 0.98) !important; /* D√ºz beyaz yap */
        }
        
        /* Yazƒ± yazarken olu≈üan gecikmeyi (input lag) √∂nle */
        .wizard-input-group input, 
        .wizard-input-group select,
        .wizard-input-group textarea {
            transition: none !important; /* Animasyonu kapat */
            transform: none !important;  /* B√ºy√ºme efektini kapat */
            box-shadow: 0 0 0 1px #cbd5e1 !important; /* Basit √ßer√ßeve */
            background: #fff !important;
        }
        
        /* Tƒ±klayƒ±nca zƒ±plamasƒ±nƒ± engelle */
        .wizard-input-group input:focus, 
        .wizard-input-group select:focus {
            transform: none !important;
            border-color: var(--primary-color) !important;
            box-shadow: 0 0 0 2px var(--primary-color) !important;
        }

        /* Kart se√ßimlerindeki aƒüƒ±rlƒ±ƒüƒ± kaldƒ±r */
        .wizard-option-card {
            transition: none !important;
            transform: none !important;
            animation: none !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
        }
        .wizard-option-card:hover {
            background-color: #f1f5f9 !important;
            border-color: var(--primary-color) !important;
        }
        
        /* Arka plan ikonlarƒ±nƒ±n d√∂nmesini durdur */
        .wizard-option-icon {
            animation: none !important;
        }
    `;
    document.head.appendChild(fastStyle);
    
    console.log("üöÄ Hƒ±zlandƒ±rma yamasƒ± ba≈üarƒ±yla uygulandƒ±.");
})();
</script>

</body>

</html> </div>
    </div>

    <!-- Custom Date/Time Picker -->
    <div id="customPickerOverlay" class="custom-picker-overlay" style="display: none;">
        <div class="custom-picker-panel">
            <h3 class="custom-picker-title" id="customPickerTitle">Se√ßim Yapƒ±n</h3>
            <div class="custom-picker-grid" id="customPickerGrid"></div>
            <button class="custom-picker-close" onclick="closeCustomPicker()">Tamam</button>
        </div>
    </div>

    <!-- Verified Build | Necmettin ERGƒ∞N | Safe Enhancement Update v13.0 + Sound Effects -->
</body>

</html>
